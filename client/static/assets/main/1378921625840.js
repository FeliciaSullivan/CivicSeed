if(!this.JSON){JSON=function(){function f(n){return n<10?'0'+n:n;}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case'string':return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+
(c%16).toString(16);})+'"':'"'+value+'"';case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
if(typeof value.toJSON==='function'){return stringify(value.toJSON());}
a=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||'null');}
return'['+a.join(',')+']';} 
if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}else{for(k in value){if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}
return'{'+a.join(',')+'}';}}
return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object'){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n;}}}}
return filter(k,v);}
if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}
throw new SyntaxError('parseJSON');}};}();}
window.require=function(e,t){var n=require.resolve(e,t||"/"),r=require.modules[n];if(!r)throw new Error("Failed to resolve module "+e+", tried "+n);var i=r._cached?r._cached:r();return i},require.paths=[],require.modules={},require.extensions=[".js",".coffee",".ls"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(e,t){function o(e){if(require.modules[e])return e;for(var t=0;t<require.extensions.length;t++){var n=require.extensions[t];if(require.modules[e+n])return e+n}}function u(e){return e=e.replace(/\/+$/,""),o(e+"/index")}function a(e,t){var n=f(t);for(var r=0;r<n.length;r++){var i=n[r],s=o(i+"/"+e);if(s)return s;var a=u(i+"/"+e);if(a)return a}var s=o(e);if(s)return s}function f(e){var t;e==="/"?t=[""]:t=n.normalize(e).split("/");var r=[];for(var i=t.length-1;i>=0;i--){if(t[i]==="node_modules")continue;var s=t.slice(0,i+1).join("/")+"/node_modules";r.push(s)}return r}t||(t="/");if(require._core[e])return e;var n=require.modules.path();t=n.resolve("/",t);var r=t||"/";if(e.match(/^(?:\.\.?\/|\/)/)){var i=o(n.resolve(r,e))||u(n.resolve(r,e));if(i)return i}var s=a(e,r);if(s)return s;throw new Error("Cannot find module '"+e+"'")}}(),require.alias=function(e,t){var n=require.modules.path(),r=null;try{r=require.resolve(e+"/package.json","/")}catch(i){r=require.resolve(e,"/")}var s=n.dirname(r),o=(Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t})(require.modules);for(var u=0;u<o.length;u++){var a=o[u];if(a.slice(0,s.length+1)===s+"/"){var f=a.slice(s.length);require.modules[t+f]=require.modules[s+f]}else a===s&&(require.modules[t]=require.modules[s])}},require.define=function(e,t){var n=require._core[e]?"":require.modules.path().dirname(e),r=function(e){return require(e,n)};r.resolve=function(e){return require.resolve(e,n)},r.modules=require.modules,r.define=require.define;var i={exports:{}};require.modules[e]=function(){return require.modules[e]._cached=i.exports,t.call(i.exports,r,i,i.exports,n,e),require.modules[e]._cached=i.exports,i.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var e=[],t=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return t&&window.addEventListener("message",function(t){if(t.source===window&&t.data==="browserify-tick"){t.stopPropagation();if(e.length>0){var n=e.shift();n()}}},!0),function(n){t?(e.push(n),window.postMessage("browserify-tick","*")):setTimeout(n,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(e){if(e==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(e,t,n,r,i){function s(e,t){var n=[];for(var r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}function o(e,t){var n=0;for(var r=e.length;r>=0;r--){var i=e[r];i=="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){var e="",t=!1;for(var n=arguments.length;n>=-1&&!t;n--){var r=n>=0?arguments[n]:process.cwd();if(typeof r!="string"||!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},n.normalize=function(e){var t=e.charAt(0)==="/",n=e.slice(-1)==="/";return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(s(e,function(e,t){return e&&typeof e=="string"}).join("/"))},n.dirname=function(e){var t=u.exec(e)[1]||"",n=!1;return t?t.length===1||n&&t.length<=3&&t.charAt(1)===":"?t:t.substring(0,t.length-1):"."},n.basename=function(e,t){var n=u.exec(e)[2]||"";return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return u.exec(e)[3]||""}});
jade=function(e){function t(e){return e!=null}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),e.merge=function(n,r){var i=n["class"],s=r["class"];if(i||s)i=i||[],s=s||[],Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]),i=i.filter(t),s=s.filter(t),n["class"]=i.concat(s).join(" ");for(var o in r)o!="class"&&(n[o]=r[o]);return n},e.attrs=function(n,r){var i=[],s=n.terse;delete n.terse;var o=Object.keys(n),u=o.length;if(u){i.push("");for(var a=0;a<u;++a){var f=o[a],l=n[f];"boolean"==typeof l||null==l?l&&(s?i.push(f):i.push(f+'="'+f+'"')):0==f.indexOf("data")&&"string"!=typeof l?i.push(f+"='"+JSON.stringify(l)+"'"):"class"==f&&Array.isArray(l)?i.push(f+'="'+e.escape(l.join(" "))+'"'):r&&r[f]?i.push(f+'="'+e.escape(l)+'"'):i.push(f+'="'+l+'"')}}return i.join(" ")},e.escape=function(t){return String(t).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(t,n,r){if(!n)throw t;var i=3,s=require("fs").readFileSync(n,"utf8"),o=s.split("\n"),u=Math.max(r-i,0),a=Math.min(o.length,r+i),i=o.slice(u,a).map(function(e,t){var n=t+u+1;return(n==r?"  > ":"    ")+n+"| "+e}).join("\n");throw t.path=n,t.message=(n||"Jade")+":"+r+"\n"+i+"\n\n"+t.message,t},e}({});
(function(){function t(){return t}function n(t,r){var i=n.resolve(t),s=n.modules[i];if(!s)throw new Error('failed to require "'+t+'" from '+r);return s.exports||(s.exports={},s.call(s.exports,s,s.exports,n.relative(i),e)),s.exports}var e=this;n.modules={},n.resolve=function(e){var t=e,r=e+".js",i=e+"/index.js";return n.modules[r]&&r||n.modules[i]&&i||t},n.register=function(e,t){n.modules[e]=t},n.relative=function(e){return function(r){if("debug"==r)return t;if("."!=r.charAt(0))return n(r);var i=e.split("/"),s=r.split("/");i.pop();for(var o=0;o<s.length;o++){var u=s[o];".."==u?i.pop():"."!=u&&i.push(u)}return n(i.join("/"),e)}},n.register("engine.io-client.js",function(e,t,n,r){t.version="0.3.10",t.protocol=1,t.util=n("./util"),t.parser=n("./parser"),t.Socket=n("./socket"),t.EventEmitter=n("./event-emitter"),t.Transport=n("./transport"),t.transports=n("./transports")}),n.register("event-emitter.js",function(e,t,n,r){function i(){}function s(e){return"[object Array]"==Object.prototype.toString.call(e)}e.exports=i,i.prototype.on=function(e,t){return this.$events||(this.$events={}),this.$events[e]?s(this.$events[e])?this.$events[e].push(t):this.$events[e]=[this.$events[e],t]:this.$events[e]=t,this},i.prototype.addListener=i.prototype.on,i.prototype.once=function(e,t){function r(){n.removeListener(e,r),t.apply(this,arguments)}var n=this;return r.listener=t,this.on(e,r),this},i.prototype.removeListener=function(e,t){if(this.$events&&this.$events[e]){var n=this.$events[e];if(s(n)){var r=-1;for(var i=0,o=n.length;i<o;i++)if(n[i]===t||n[i].listener&&n[i].listener===t){r=i;break}if(r<0)return this;n.splice(r,1),n.length||delete this.$events[e]}else(n===t||n.listener&&n.listener===t)&&delete this.$events[e]}return this},i.prototype.removeAllListeners=function(e){return e===undefined?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},i.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),s(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},i.prototype.emit=function(e){if(!this.$events)return!1;var t=this.$events[e];if(!t)return!1;var n=Array.prototype.slice.call(arguments,1);if("function"==typeof t)t.apply(this,n);else{if(!s(t))return!1;var r=t.slice();for(var i=0,o=r.length;i<o;i++)r[i].apply(this,n)}return!0},i.prototype.addEventListener=i.prototype.on,i.prototype.removeEventListener=i.prototype.removeListener,i.prototype.dispatchEvent=i.prototype.emit}),n.register("parser.js",function(e,t,n,r){var i=n("./util"),s=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},o=i.keys(s),u={type:"error",data:"parser error"};t.encodePacket=function(e){var t=s[e.type];return undefined!==e.data&&(t+=String(e.data)),""+t},t.decodePacket=function(e){var t=e.charAt(0);return Number(t)!=t||!o[t]?u:e.length>1?{type:o[t],data:e.substring(1)}:{type:o[t]}},t.encodePayload=function(e){if(!e.length)return"0:";var n="",r;for(var i=0,s=e.length;i<s;i++)r=t.encodePacket(e[i]),n+=r.length+":"+r;return n},t.decodePayload=function(e){if(e=="")return[u];var n=[],r="",i,s,o;for(var a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"!=l)r+=l;else{if(""==r||r!=(i=Number(r)))return[u];s=e.substr(a+1,i);if(r!=s.length)return[u];if(s.length){o=t.decodePacket(s);if(u.type==o.type&&u.data==o.data)return[u];n.push(o)}a+=i,r=""}}return r!=""?[u]:n}}),n.register("socket.js",function(e,t,n,r){function a(e){if("string"==typeof e){var t=i.parseUri(e);e=arguments[1]||{},e.host=t.host,e.secure=t.protocol=="https"||t.protocol=="wss",e.port=t.port}e=e||{},this.secure=null!=e.secure?e.secure:r.location&&"https:"==location.protocol,this.host=e.host||e.hostname||(r.location?location.hostname:"localhost"),this.port=e.port||(r.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},this.query.uid=l(),this.upgrade=!1!==e.upgrade,this.resource=e.resource||"default",this.path=(e.path||"/engine.io").replace(/\/$/,""),this.path+="/"+this.resource+"/",this.forceJSONP=!!e.forceJSONP,this.timestampParam=e.timestampParam||"t",this.timestampRequests=!!e.timestampRequests,this.flashPath=e.flashPath||"",this.transports=e.transports||["polling","websocket","flashsocket"],this.readyState="",this.writeBuffer=[],this.policyPort=e.policyPort||843,this.open(),a.sockets.push(this),a.sockets.evs.emit("add",this)}function f(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function l(){return String(Math.random()).substr(5)+String(Math.random()).substr(5)}var i=n("./util"),s=n("./transports"),o=n("debug")("engine-client:socket"),u=n("./event-emitter");e.exports=a,i.inherits(a,u),a.sockets=[],a.sockets.evs=new u,a.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=f(this.query);t.transport=e,this.id&&(t.sid=this.id);var n=new s[e]({host:this.host,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,flashPath:this.flashPath,policyPort:this.policyPort});return n},a.prototype.open=function(){this.readyState="opening";var e=this.createTransport(this.transports[0]);e.open(),this.setTransport(e)},a.prototype.setTransport=function(e){var t=this;this.transport&&(o("clearing existing transport"),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.flush()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},a.prototype.probe=function(e){function i(i){if(n)return;n=!0;var s=new Error("probe error: "+i);s.transport=t.name,t.close(),t=null,o('probe transport "%s" failed because of error: %s',e,i),r.emit("error",s)}o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;t.once("open",function(){if(n)return;o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(s){if(n)return;if("pong"==s.type&&"probe"==s.data)o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),o('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){if(n)return;if("closed"==r.readyState||"closing"==r.readyState)return;o("changing transport and sending upgrade packet"),t.removeListener("error",i),r.emit("upgrade",t),r.setTransport(t),t.send([{type:"upgrade"}]),t=null,r.upgrading=!1,r.flush()});else{o('probe transport "%s" failed',e);var u=new Error("probe error");u.transport=t.name,r.emit("error",u)}})}),t.once("error",i),t.open(),this.once("close",function(){t&&(o("socket closed prematurely - aborting probe"),n=!0,t.close(),t=null)}),this.once("upgrading",function(e){t&&e.name!=t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),t.close(),t=null)})},a.prototype.onOpen=function(){o("socket open"),this.readyState="open",this.emit("open"),this.onopen&&this.onopen.call(this),this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},a.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(i.parseJSON(e.data));break;case"pong":this.ping();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("message",e.data);var n={data:e.data};n.toString=function(){return e.data},this.onmessage&&this.onmessage.call(this,n)}}else o('packet received with socket readyState "%s"',this.readyState)},a.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=e.upgrades,this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.ping(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat)},a.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},a.prototype.ping=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.sendPacket("ping"),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},a.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.writeBuffer=[])},a.prototype.write=a.prototype.send=function(e){return this.sendPacket("message",e),this},a.prototype.sendPacket=function(e,t){var n={type:e,data:t};this.emit("packetCreate",n),this.writeBuffer.push(n),this.flush()},a.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),o("socket closing - telling transport to close"),this.transport.close(),this.transport.removeAllListeners();return this},a.prototype.onError=function(e){this.emit("error",e),this.onClose("transport error",e)},a.prototype.onClose=function(e,t){"closed"!=this.readyState&&(o('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.readyState="closed",this.emit("close",e,t),this.onclose&&this.onclose.call(this),this.id=null)}}),n.register("transport.js",function(e,t,n,r){function u(e){this.path=e.path,this.host=e.host,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState=""}var i=n("./util"),s=n("./parser"),o=n("./event-emitter");e.exports=u,i.inherits(u,o),u.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},u.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},u.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},u.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},u.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},u.prototype.onData=function(e){this.onPacket(s.decodePacket(e))},u.prototype.onPacket=function(e){this.emit("packet",e)},u.prototype.onClose=function(){this.readyState="closed",this.emit("close")}}),n.register("transports/flashsocket.js",function(e,t,n,r){function u(e){i.call(this,e),this.flashPath=e.flashPath,this.policyPort=e.policyPort}function f(e,t){if(a[e])return t();var n=document.createElement("script"),r=!1;n.onload=n.onreadystatechange=function(){if(r||a[e])return;var i=n.readyState;if(!i||"loaded"==i||"complete"==i)n.onload=n.onreadystatechange=null,r=!0,a[e]=!0,t()},n.async=1,n.src=e;var i=document.getElementsByTagName("head")[0];i.insertBefore(n,i.firstChild)}function l(e,t){function n(r){if(!e[r])return t();f(e[r],function(){n(++r)})}n(0)}var i=n("./websocket"),s=n("../util");e.exports=u;var o=r[["Active"].concat("Object").join("X")];s.inherits(u,i),u.prototype.name="flashsocket",u.prototype.doOpen=function(){function e(e){return function(){var e=Array.prototype.join.call(arguments," ")}}if(!this.check())return;WEB_SOCKET_LOGGER={log:e("debug"),error:e("error")},WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0,WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,"undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=this.flashPath+"WebSocketMainInsecure.swf");var t=[this.flashPath+"web_socket.js"];"undefined"==typeof swfobject&&t.unshift(this.flashPath+"swfobject.js");var n=this;l(t,function(){n.ready(function(){WebSocket.__addTask(function(){i.prototype.doOpen.call(n)})})})},u.prototype.doClose=function(){if(!this.socket)return;var e=this;WebSocket.__addTask(function(){i.prototype.doClose.call(e)})},u.prototype.write=function(){var e=this,t=arguments;WebSocket.__addTask(function(){i.prototype.write.apply(e,t)})},u.prototype.ready=function(e){function t(){u.loaded||(843!=n.policyPort&&WebSocket.loadFlashPolicyFile("xmlsocket://"+n.host+":"+n.policyPort),WebSocket.__initialize(),u.loaded=!0),e.call(n)}if(!(typeof WebSocket!="undefined"&&"__initialize"in WebSocket)||!swfobject)return;if(swfobject.getFlashPlayerVersion().major<10)return;var n=this;if(document.body)return t();s.load(t)},u.prototype.check=function(){if(typeof WebSocket=="undefined"||"__initialize"in WebSocket){if(o){var e=null;try{e=new o("ShockwaveFlash.ShockwaveFlash")}catch(t){}if(e)return!0}else for(var n=0,r=navigator.plugins.length;n<r;n++)for(var i=0,s=navigator.plugins[n].length;i<s;i++)if(navigator.plugins[n][i].description=="Shockwave Flash")return!0;return!1}return!1};var a={}}),n.register("transports/index.js",function(e,t,n,r){function f(e){var t,n=!1,o=!1;if(r.location){var u="https:"==location.protocol,f=location.port;Number(f)!=f&&(f=u?443:80),n=e.host!=location.hostname||f!=e.port,o=e.secure!=u}return t=a.request(n),o&&r.XDomainRequest&&t instanceof r.XDomainRequest?new s(e):t&&!e.forceJSONP?new i(e):new s(e)}var i=n("./polling-xhr"),s=n("./polling-jsonp"),o=n("./websocket"),u=n("./flashsocket"),a=n("../util");t.polling=f,t.websocket=o,t.flashsocket=u}),n.register("transports/polling-jsonp.js",function(e,t,n,r){function f(){}function l(e){i.call(this,e),u||(r.___eio||(r.___eio=[]),u=r.___eio),this.index=u.length;var t=this;u.push(function(e){t.onData(e)}),this.query.j=this.index}var i=n("./polling"),s=n("../util");e.exports=l;var o=/\n/g,u,a=0;s.inherits(l,i),l.prototype.doOpen=function(){var e=this;s.defer(function(){i.prototype.doOpen.call(e)})},l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),i.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri();var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),this.script=e,s.ua.gecko&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},l.prototype.doWrite=function(e,t){function a(){f(),t()}function f(){n.iframe&&n.form.removeChild(n.iframe);try{u=document.createElement('<iframe name="'+n.iframeId+'">')}catch(e){u=document.createElement("iframe"),u.name=n.iframeId}u.id=n.iframeId,n.form.appendChild(u),n.iframe=u}var n=this;if(!this.form){var r=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index,u;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=s,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i}this.form.action=this.uri(),f(),this.area.value=e.replace(o,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&a()}:this.iframe.onload=a}}),n.register("transports/polling-xhr.js",function(e,t,n,r){function a(){}function f(e){i.call(this,e),r.location&&(this.xd=e.host!=r.location.hostname||r.location.port!=e.port)}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.async=!1!==e.async,this.data=undefined!=e.data?e.data:null,this.create()}var i=n("./polling"),s=n("../event-emitter"),o=n("../util");e.exports=f,e.exports.Request=l;var u=r[["Active"].concat("Object").join("X")];o.inherits(f,i),f.prototype.doOpen=function(){var e=this;o.defer(function(){i.prototype.doOpen.call(e)})},f.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,new l(e)},f.prototype.doWrite=function(e,t){var n=this.request({method:"POST",data:e}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=n},f.prototype.doPoll=function(){var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o.inherits(l,s),l.prototype.create=function(){var e=this.xhr=o.request(this.xd),t=this;e.open(this.method,this.uri,this.async);if("POST"==this.method)try{e.setRequestHeader?e.setRequestHeader("Content-type","text/plain;charset=UTF-8"):e.contentType="text/plain"}catch(n){}this.xd&&r.XDomainRequest&&e instanceof XDomainRequest?(e.onerror=function(e){t.onError(e)},e.onload=function(){t.onData(e.responseText)},e.onprogress=a):("withCredentials"in e&&(e.withCredentials=!0),e.onreadystatechange=function(){var n;try{if(4!=e.readyState)return;200==e.status||1223==e.status?n=e.responseText:t.onError(e.status)}catch(r){t.onError(r)}undefined!==n&&t.onData(n)}),e.send(this.data),u&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup()},l.prototype.cleanup=function(){this.xhr.onreadystatechange=a,this.xhr.onload=this.xhr.onerror=a;try{this.xhr.abort()}catch(e){}u&&delete l.requests[this.index],this.xhr=null},l.prototype.abort=function(){this.cleanup()},u&&(l.requestsCount=0,l.requests={},r.attachEvent("onunload",function(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}))}),n.register("transports/polling.js",function(e,t,n,r){function u(e){i.call(this,e)}var i=n("../transport"),s=n("../util"),o=n("../parser");e.exports=u,s.inherits(u,i),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){function r(){n.readyState="paused",e()}var t=0,n=this;this.readyState="pausing";if(this.polling||!this.writable){var i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||r()})),this.writable||(i++,this.once("drain",function(){--i||r()}))}else r()},u.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=o.decodePayload(e);for(var n=0,r=t.length;n<r;n++){"opening"==this.readyState&&this.onOpen();if("close"==t[n].type){this.onClose();return}this.onPacket(t[n])}this.polling=!1,this.emit("pollComplete"),"open"==this.readyState&&this.poll()},u.prototype.doClose=function(){this.send([{type:"close"}])},u.prototype.write=function(e){var t=this;this.writable=!1,this.doWrite(o.encodePayload(e),function(){t.writable=!0,t.emit("drain")})},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";if(r.ActiveXObject||s.ua.android||s.ua.ios6||this.timestampRequests)e[this.timestampParam]=+(new Date);return e=s.qs(e),this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.host+n+this.path+e}}),n.register("transports/websocket.js",function(e,t,n,r){function u(e){i.call(this,e)}function a(){return r.WebSocket||r.MozWebSocket}var i=n("../transport"),s=n("../parser"),o=n("../util");e.exports=u,o.inherits(u,i),u.prototype.name="websocket",u.prototype.doOpen=function(){if(!this.check())return;var e=this;this.socket=new(a())(this.uri()),this.socket.onopen=function(){e.onOpen()},this.socket.onclose=function(){e.onClose()},this.socket.onmessage=function(t){e.onData(t.data)},this.socket.onerror=function(t){e.onError("websocket error",t)}},u.prototype.write=function(e){for(var t=0,n=e.length;t<n;t++)this.socket.send(s.encodePacket(e[t]))},u.prototype.doClose=function(){typeof this.socket!="undefined"&&this.socket.close()},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+(new Date)),e=o.qs(e),e.length&&(e="?"+e),t+"://"+this.host+n+this.path+e},u.prototype.check=function(){var e=a();return!!e&&!("__initialize"in e&&this.name===u.prototype.name)}}),n.register("util.js",function(e,t,n,r){var i=!1;t.inherits=function(t,n){function r(){}r.prototype=n.prototype,t.prototype=new r},t.keys=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},t.on=function(e,t,n,r){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,r)},t.load=function(e){if(r.document&&document.readyState==="complete"||i)return e();t.on(r,"load",e,!1)},"undefined"!=typeof window&&t.load(function(){i=!0}),t.defer=function(e){if(!t.ua.webkit||"undefined"!=typeof importScripts)return e();t.load(function(){setTimeout(e,100)})};var s=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,f=/^\s+/,l=/\s+$/;t.parseJSON=function(e){if("string"!=typeof e||!e)return null;e=e.replace(f,"").replace(l,"");if(r.JSON&&JSON.parse)return JSON.parse(e);if(s.test(e.replace(o,"@").replace(u,"]").replace(a,"")))return(new Function("return "+e))()},t.ua={},t.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return e.withCredentials!=undefined}(),t.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),t.ua.gecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent),t.ua.android="undefined"!=typeof navigator&&/android/i.test(navigator.userAgent),t.ua.ios="undefined"!=typeof navigator&&/^(iPad|iPhone|iPod)$/.test(navigator.platform),t.ua.ios6=t.ua.ios&&/OS 6_/.test(navigator.userAgent),t.request=function(n){if(n&&"undefined"!=typeof XDomainRequest&&!t.ua.hasCORS)return new XDomainRequest;try{if("undefined"!=typeof XMLHttpRequest&&(!n||t.ua.hasCORS))return new XMLHttpRequest}catch(r){}if(!n)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}};var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.parseUri=function(e){var t=c.exec(e||""),n={},r=14;while(r--)n[h[r]]=t[r]||"";return n},t.qs=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]));return t}});var r=n("engine.io-client");"undefined"!=typeof module?module.exports=r:eio=r})();
require.define("eventemitter2.js",function(e,t,n,r,i){!function(e,t){function i(){this._events=new Object}function s(e){e&&(this.wildcard=e.wildcard,this.delimiter=e.delimiter||".",this.wildcard&&(this.listenerTree=new Object))}function o(e){this._events=new Object,s.call(this,e)}function u(e,t,n,r){if(!n)return;var i;if(r===t.length&&n._listeners){if(typeof n._listeners=="function")return e&&e.push(n._listeners),n;for(var s=0,o=n._listeners.length;s<o;s++)e&&e.push(n._listeners[s]);return n}if(t[r]==="*"||n[t[r]]){if(t[r]==="*"){for(var a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(i=u(e,t,n[a],r+1));return i}i=u(e,t,n[t[r]],r+1)}return n["*"]&&u(e,t,n["*"],r+1),i}function a(e,t){e=typeof e=="string"?e.split(this.delimiter):e.slice();var i=this.listenerTree,s=e.shift();while(s){i[s]||(i[s]=new Object),i=i[s];if(e.length===0){if(!i._listeners)i._listeners=t;else if(typeof i._listeners=="function")i._listeners=[i._listeners,t];else if(n(i._listeners)){i._listeners.push(t);if(!i._listeners.warned){var o=r;o>0&&i._listeners.length>o&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}return!0}s=e.shift()}return!0}var n=Array.isArray?Array.isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},r=10;o.prototype.setMaxListeners=function(e){this._events||i.call(this),this._events.maxListeners=e},o.prototype.event="",o.prototype.once=function(e,t){return this.many(e,1,t),this},o.prototype.many=function(e,t,n){function i(){--t===0&&r.off(e,i),n.apply(null,arguments)}var r=this;if(typeof n!="function")throw new Error("many only accepts instances of Function");return i._origin=n,this.on(e,i),r},o.prototype.emit=function(){this._events||i.call(this);var e=arguments[0];if(e==="newListener"&&!this._events.newListener)return!1;if(this._all){var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];for(r=0,t=this._all.length;r<t;r++)this.event=e,this._all[r].apply(this,n)}if(e==="error"&&!this._all&&!this._events.error&&(!this.wildcard||!this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var s;if(this.wildcard){s=[];var o=typeof e=="string"?e.split(this.delimiter):e.slice();u.call(this,s,o,this.listenerTree,0)}else s=this._events[e];if(typeof s=="function"){this.event=e;if(arguments.length===1)s.call(this);else if(arguments.length>1)switch(arguments.length){case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];s.apply(this,n)}return!0}if(s){var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];var a=s.slice();for(var r=0,t=a.length;r<t;r++)this.event=e,a[r].apply(this,n);return!0}},o.prototype.on=function(e,s){this._events||i.call(this),this.emit("newListener",e,s);if(this.wildcard)return a.call(this,e,s),this;if(!this._events[e])this._events[e]=s;else if(typeof this._events[e]=="function")this._events[e]=[this._events[e],s];else if(n(this._events[e])){this._events[e].push(s);if(!this._events[e].warned){var o;this._events.maxListeners!==t?o=this._events.maxListeners:o=r,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}return this},o.prototype.onAny=function(e){this._all||(this._all=[]);if(typeof e!="function")throw new Error("onAny only accepts instances of Function");return this._all.push(e),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(e,t){if(typeof t!="function")throw new Error("removeListener only takes instances of Function");var r;if(this.wildcard){var i=typeof e=="string"?e.split(this.delimiter):e.slice(),s=u.call(this,null,i,this.listenerTree,0);if("undefined"==typeof s)return this;r=s._listeners}else{if(!this._events[e])return this;r=this._events[e]}if(n(r)){var o=-1;for(var a=0,f=r.length;a<f;a++)if(r[a]===t||r[a].listener&&r[a].listener===t||r[a]._origin&&r[a]._origin===t){o=a;break}if(o<0)return this;this.wildcard?s._listeners.splice(o,1):this._events[e].splice(o,1),r.length===0&&(this.wildcard?delete s._listeners:delete this._events[e])}else if(r===t||r.listener&&r.listener===t||r._origin&&r._origin===t)this.wildcard?delete s._listeners:delete this._events[e];return this},o.prototype.offAny=function(e){var t=0,n=0,r;if(e&&this._all&&this._all.length>0){r=this._all;for(t=0,n=r.length;t<n;t++)if(e===r[t])return r.splice(t,1),this}else this._all=[];return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(e){if(arguments.length===0)return!this._events||i.call(this),this;if(this.wildcard){var t=typeof e=="string"?e.split(this.delimiter):e.slice(),n=u.call(this,null,t,this.listenerTree,0);if("undefined"==typeof n)return this;n._listeners=null}else{if(!this._events[e])return this;this._events[e]=null}return this},o.prototype.listeners=function(e){if(this.wildcard){var t=[],r=typeof e=="string"?e.split(this.delimiter):e.slice();return u.call(this,t,r,this.listenerTree,0),t}return this._events||i.call(this),this._events[e]||(this._events[e]=[]),n(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},o.prototype.listenersAny=function(){return this._all?this._all:[]},e.EventEmitter2=o}(typeof n=="undefined"?window:n)});
require.define("socketstream.js",function(e,t,n,r,i){var s,o,u,a,f;s=e("eventemitter2").EventEmitter2,a=n.server=new s,u=n.message=new s,n.tmpl={},f=null,n.assignTransport=function(t){return f=e("socketstream-transport")(a,u,t),f.send=f.connect()},n.registerApi=function(e,t){var r;return r=n[e],r?console.error("SocketStream Error: Unable to register the 'ss."+e+"' responder as this name has already been taken"):n[e]=t},n.send=function(e){return function(t){return f.send(e+"|"+t)}},o={loaded:{},loading:new s},n.load={code:function(e,t){var n,r,i;e&&e.substr(0,1)==="/"&&(e=e.substr(1)),n="SocketStream Error: The ss.load.code() command ";if(!jQuery)return console.error(n+"requires jQuery to be present");if(!e)return console.error(n+"requires a directory to load. Specify it as the first argument. E.g. The ss.load.code('/mail',cb) will load code in /client/code/mail");if(!t)return console.error(n+"requires a callback. Specify it as the last argument");if(o.loaded[e])return t();o.loading.once(e,t);if(o.loading.listeners(e).length===1)return r=function(){return console.error("SocketStream Error: Could not asynchronously load "+e),console.log(arguments)},i=function(){return o.loaded[e]=!0,o.loading.emit(e)},$.ajax({url:"/_serve/code?"+e,type:"GET",cache:!1,dataType:"script",success:i,error:r})},worker:function(e){return new Worker("/_serve/worker?"+e)}},a.on("__ss:reload",function(){return window.location.reload()}),a.on("__ss:updateCSS",function(){var e,t,n,r,i;i=document.getElementsByTagName("link");for(n=0,r=i.length;n<r;n++)t=i[n],t.rel.toLowerCase().indexOf("stylesheet")>=0&&t.href&&(e=t.href.replace(/(&|%5C?)\d+/,""),t.href=e+(e.indexOf("?")>=0?"&":"?")+(new Date).valueOf());return console.log("CSS updated")})});
require.define("events-responder",function(e,t,n,r,i){var s,o;s=e("eventemitter2").EventEmitter2,o=e("socketstream"),t.exports=function(e,t,n){var r;return r=new s,o.registerApi("event",r),o.message.on(e,function(e,t){var n,i,s;return s=JSON.parse(e),n=[s.e],n=n.concat(s.p),t!=null&&n.push(t),i=s.e&&s.e.substr(0,5)==="__ss:"&&o.server||r,i.emit.apply(i,n)})}});
require.define("socketstream-rpc",function(e,t,n,r,i){var s,o,u,a;a=e("socketstream"),u=0,s={},o=function(e){return console.log(e)},t.exports=function(e,t,n){return a.registerApi("rpc",function(){var e,t,r,i,a;return e=Array.prototype.slice.call(arguments),a={},a.m=e[0],a.id=++u,r=e[e.length-1],typeof r=="function"?(a.p=e.slice(1,e.length-1),t=r):(a.p=e.slice(1),t=o),s[a.id]=t,i=JSON.stringify(a),n(i),void 0}),a.message.on(e,function(e){var t,n;n=JSON.parse(e);if(n.id&&(t=s[n.id]))return n.e?console.error("SocketStream RPC server error:",n.e.message):t.apply(t,n.p),delete s[n.id]})}});
require.define("socketstream-transport",function(e,t,n,r,i){var s=!1,o=1e3;t.exports=function(t,n,r){return JSON.stringify(r)==="{}"&&(r={secure:document.location.protocol==="https:",host:document.location.hostname,port:document.location.protocol==="https:"?443:document.location.port}),{connect:function(){var i=new eio.Socket(r);i.onopen=function(){var e=u("connect.sid");e?i.send("X|"+e):console.error("Unable to obtain session ID")},i.onmessage=function(e){var r,i,u=e.data;if((r=u.indexOf("|"))>0){var a=u.substr(0,r),f=u.substr(r+1);switch(a){case"X":s===!1?t.emit("ready"):(o=1e3,t.emit("reconnect"));break;case"0":if((i=f.lastIndexOf("|"))>0){var l=f.substr(0,i),c=f.substr(i+1);n.emit(a,l,c)}else console.error("Invalid event message received:",u);break;default:n.emit(a,f)}}else console.error("Invalid websocket message received:",u)};var a=function(t){setTimeout(function(){var t=e("socketstream");t.assignTransport(r),t.server.event!="reconnect"&&(o*=1.5)},t),clearTimeout()};return i.onclose=function(){s=!0,t.emit("disconnect"),a(o)},function(e){i.send(e)}}}};var u=function(e){var t,n;if(document.cookie.length>0){n=document.cookie.indexOf(e+"=");if(n!==-1)return n=n+e.length+1,t=document.cookie.indexOf(";",n),t===-1&&(t=document.cookie.length),unescape(document.cookie.substring(n,t))}return""}});(function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(q.hasData(e)&&(s=q.access(e),o=q.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=q.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(s[o]=q.access(r,"olddisplay",Rt(r.nodeName)))):s[o]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+jt[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+jt[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+jt[s]+"Width",!0,i))):(o+=x.css(e,"padding"+jt[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+jt[s]+"Width",!0,i)));return o}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=vt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(o?"border":"content"),r,s)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===on;return o(t.dataTypes[0])||!i["*"]&&o("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function pn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function jn(e,t,n){var r,i,s=0,o=kn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(Dn(l,f.opts.specialEasing);o>s;s++)if(r=kn[s].call(f,e,l,f.opts))return r;return x.map(l,Sn,f),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Dn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function An(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&Lt(e),p=q.get(e,"fxshow");n.queue||(u=x._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,x.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||x.style(e,r)}if(!x.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=q.access(e,"fxshow",{}),s&&(p.hidden=!h),h?x(e).show():f.done(function(){x(e).hide()}),f.done(function(){var t;q.remove(e,"fxshow");for(t in l)x.style(e,t,l[t])});for(r in l)o=Sn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return f.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;if((t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,E=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return H.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=S++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=null==x?1:Math.random()||.1;for(S&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return S&&(E=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(w.childNodes),w.childNodes),_[w.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(w,e)?-1:t===n||y(w,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return!u||n&&!a||(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))x.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(w)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,o[r]));q.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=q.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,s=x(this),o=e.match(w)||[];while(t=o[i++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=q.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=q.hasData(e)&&q.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(q.get(u,"events")||{})[t.type]&&q.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(q.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),u.filter?u.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,s,o,u,a,l=0,c=this.length,h=this,p=c-1,d=e[0],v=x.isFunction(d);if(v||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=h.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(mt(r,"script"),ft),o=s.length;c>l;l++)u=r,l!==p&&(u=x.clone(u,!0,!0),o&&x.merge(s,mt(u,"script"))),t.call(this[l],u,l);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,ht),l=0;o>l;l++)u=s[l],at.test(u.type||"")&&!q.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=mt(u),s=mt(e),r=0,i=s.length;i>r;r++)yt(s[r],o[r]);if(t)if(n)for(s=s||mt(e),o=o||mt(u),r=0,i=s.length;i>r;r++)gt(s[r],o[r]);else gt(e,u);return o=mt(u,"script"),o.length>0&&dt(o,!a&&mt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(rt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(nt.exec(i)||["",""])[1].toLowerCase(),u=ct[o]||ct._default,s.innerHTML=u[1]+i.replace(tt,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=mt(h.appendChild(i),"script"),a&&dt(s),n)){f=0;while(i=s[f++])at.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i,s,o,u=x.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(F.accepts(n)&&(s=n[q.expando],s&&(t=q.cache[s]))){if(r=Object.keys(t.events||{}),r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[s]&&delete q.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=At(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=At(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),vt=function(e,t,n){var r,i,s,o=n||qt(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Ct.test(u)&&wt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=s[r]||s[r-2]||s[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=pn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===l.type?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Qt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=tn.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===Xt[1]&&u[2]===Xt[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),ln(rn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Zt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Vt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sn+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=ln(on,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(mn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=vn[s=yn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),s=i&&i[3]||(x.cssNumber[e]?"":"px"),o=(x.cssNumber[e]||"px"!==s&&+r)&&Tn.exec(x.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,x.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}}),x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=jn(this,x.extend({},e),s);(i||q.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=q.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Cn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=Hn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=Hn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);Davis=function(e){var t=new Davis.App;return e&&e.call(t),Davis.$(function(){t.start()}),t},window.jQuery?Davis.$=jQuery:Davis.$=null,Davis.supported=function(){return typeof window.history.pushState=="function"},Davis.noop=function(){},Davis.extend=function(e){e(Davis)},Davis.version="0.9.6",Davis.utils=function(){if(Array.prototype.every)var e=function(e,t){return e.every(t,arguments[2])};else var e=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=arguments[2];for(var s=0;s<r;s++)if(s in n&&!t.call(i,n[s],s,n))return!1;return!0};if(Array.prototype.forEach)var t=function(e,t){return e.forEach(t,arguments[2])};else var t=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=arguments[2];for(var s=0;s<r;s++)s in n&&t.call(i,n[s],s,n)};if(Array.prototype.filter)var n=function(e,t){return e.filter(t,arguments[2])};else var n=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=[],s=arguments[2];for(var o=0;o<r;o++)if(o in n){var u=n[o];t.call(s,u,o,n)&&i.push(u)}return i};if(Array.prototype.map)var r=function(e,t){return e.map(t,arguments[2])};else var r=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=new Array(r),s=arguments[2];for(var o=0;o<r;o++)o in n&&(i[o]=t.call(s,n[o],o,n));return i};var i=function(e,t){return Array.prototype.slice.call(e,t||0)};return{every:e,forEach:t,filter:n,toArray:i,map:r}}(),Davis.listener=function(){var e={A:function(e){return e.host!==window.location.host||e.protocol!==window.location.protocol},FORM:function(e){var t=document.createElement("a");return t.href=e.action,this.A(t)}},t=function(t){return e[t.nodeName.toUpperCase()]?e[t.nodeName.toUpperCase()](t):!0},n=function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},r=function(e){return function(r){if(n(r))return!0;if(t(this))return!0;var i=new Davis.Request(e.call(Davis.$(this)));return Davis.location.assign(i),r.stopPropagation(),r.preventDefault(),!1}},i=r(function(){var e=this;return{method:"get",fullPath:this.prop("href"),title:this.attr("title"),delegateToServer:function(){window.location=e.prop("href")}}}),s=function(e){return decodeURIComponent(e.replace(/\+/g,"%20"))},o=r(function(){var e=this;return{method:this.attr("method"),fullPath:s(this.serialize()?[this.prop("action"),this.serialize()].join("?"):this.prop("action")),title:this.attr("title"),delegateToServer:function(){e.submit()}}});this.listen=function(){Davis.$(document).delegate(this.settings.formSelector,"submit",o),Davis.$(document).delegate(this.settings.linkSelector,"click",i)},this.unlisten=function(){Davis.$(document).undelegate(this.settings.linkSelector,"click",i),Davis.$(document).undelegate(this.settings.formSelector,"submit",o)}},Davis.event=function(){var e={};this.bind=function(t,n){return(e[t]=e[t]||[]).push(n),this},this.trigger=function(t){var n=Davis.utils.toArray(arguments,1),r=e[t];if(!r)return this;for(var i=0,s=r.length;i<s;++i)r[i].apply(this,n);return this}},Davis.logger=function(){function e(){return"["+Date()+"]"}function t(t){var n=Davis.utils.toArray(t);return n.unshift(e()),n.join(" ")}var n=function(e){return function(){window.console&&console[e](t(arguments))}},r=n("error"),i=n("info"),s=n("warn");this.logger={error:r,info:i,warn:s}},Davis.Route=function(){var e=/:([\w\d]+)/g,t="([^/]+)",n=/\*([\w\d]+)/g,r="(.*)",i=/[:|\*]([\w\d]+)/g,s=function(s,o,u){var f=function(){if(o instanceof RegExp)return o;var i=o.replace(e,t).replace(n,r);return o.lastIndex=0,new RegExp("^"+i+"$","gi")},l=function(){return s instanceof RegExp?s:new RegExp("^"+s+"$","i")},h=function(){var e=[],t;while(t=i.exec(o))e.push(t[1]);return e};this.paramNames=h(),this.path=f(),this.method=l(),typeof u=="function"?this.handlers=[u]:this.handlers=u};return s.prototype.match=function(e,t){return this.reset(),this.method.test(e)&&this.path.test(t)},s.prototype.reset=function(){this.method.lastIndex=0,this.path.lastIndex=0},s.prototype.run=function(e){this.reset();var t=this.path.exec(e.path);if(t){t.shift();for(var n=0;n<t.length;n++)e.params[this.paramNames[n]]=t[n]}var r=Davis.utils.map(this.handlers,function(e,t){return function(n){return e.call(n,n,r[t+1])}});return r[0](e)},s.prototype.toString=function(){return[this.method,this.path].join(" ")},s}(),Davis.router=function(){this.route=function(t,r){var i=function(r){var i=Davis.utils.toArray(arguments,1),s=n.join(""),o,u;return typeof r=="string"?o=s+r:o=r,u=new Davis.Route(t,o,i),e.push(u),u};return arguments.length==1?i:i.apply(this,Davis.utils.toArray(arguments,1))},this.get=this.route("get"),this.post=this.route("post"),this.put=this.route("put"),this.del=this.route("delete"),this.state=this.route("state"),this.scope=function(e,t){n.push(e);if(arguments.length==1)return;t.call(this,this),n.pop()},this.trans=function(e,t){if(t)var n=[e,decodeURIComponent(Davis.$.param(t))].join("?");else var n=e;var r=new Davis.Request({method:"state",fullPath:n,title:""});Davis.location.assign(r)},this.filter=function(e){return function(){var r=/.+/;if(arguments.length==1)var i=/.+/,s=arguments[0];else if(arguments.length==2)var i=n.join("")+arguments[0],s=arguments[1];var o=new Davis.Route(r,i,s);return t[e].push(o),o}},this.lookupFilter=function(e){return function(n,r){return Davis.utils.filter(t[e],function(e){return e.match(n,r)})}},this.before=this.filter("before"),this.after=this.filter("after"),this.lookupBeforeFilter=this.lookupFilter("before"),this.lookupAfterFilter=this.lookupFilter("after");var e=[],t={before:[],after:[]},n=[];this.lookupRoute=function(t,n){return Davis.utils.filter(e,function(e){return e.match(t,n)})[0]}},Davis.history=function(){function e(e){u.push(e)}function t(e){window.addEventListener("popstate",e,!0)}function n(e){return function(t){t.state&&t.state._davis?e(new Davis.Request(t.state._davis)):a&&e(Davis.Request.forPageLoad()),a=!0}}function r(e){return{_davis:e}}function i(r){e(r),t(n(r))}function s(e){return function(t,n){a=!0,history[e](r(t.toJSON()),t.title,t.location());if(n&&n.silent)return;Davis.utils.forEach(u,function(e){e(t)})}}function o(){return window.location.pathname+(window.location.search?window.location.search:"")}var u=[],a=!1,f=s("pushState"),l=s("replaceState");return{onChange:i,current:o,assign:f,replace:l}}(),Davis.location=function(){function e(e){i=e}function t(){return i.current()}function n(e){return function(t){typeof t=="string"&&(t=new Davis.Request(t)),i[e](t)}}function r(e){i.onChange(e)}var i=Davis.history,s=n("assign"),o=n("replace");return{setLocationDelegate:e,current:t,assign:s,replace:o,onChange:r}}(),Davis.Request=function(){var e=function(t,n){typeof t=="object"&&(n=t,t=n.fullPath,delete n.fullPath);var r=Davis.$.extend({},{title:"",fullPath:t,method:"get",timestamp:+(new Date)},n),i=this;this.raw=r,this.params={},this.title=r.title,this.queryString=r.fullPath.split("?")[1],this.timestamp=r.timestamp,this._staleCallback=function(){},this.queryString&&Davis.utils.forEach(this.queryString.split("&"),function(e){var t=e.split("=")[0],n=e.split("=")[1],r=/^(\w+)\[(\w+)?\](\[\])?/,s;if(s=r.exec(t)){var o=s[1],t=s[2],u=!!s[3],a=i.params[o]||{};u?(a[t]=a[t]||[],a[t].push(decodeURIComponent(n)),i.params[o]=a):!t&&!u?(a=i.params[o]||[],a.push(decodeURIComponent(n)),i.params[o]=a):(a[t]=decodeURIComponent(n),i.params[o]=a)}else i.params[t]=decodeURIComponent(n)}),r.fullPath=r.fullPath.replace(/^https?:\/\/.+?\//,"/"),this.method=(this.params._method||r.method).toLowerCase(),this.path=r.fullPath.replace(/\?.+$/,"").replace(/^https?:\/\/[^\/]+/,""),this.fullPath=r.fullPath,this.delegateToServer=r.delegateToServer||Davis.noop,this.isForPageLoad=r.forPageLoad||!1,e.prev&&e.prev.makeStale(this),e.prev=this};return e.prototype.redirect=function(t){Davis.location.replace(new e({method:"get",fullPath:t,title:this.title}))},e.prototype.whenStale=function(e){this._staleCallback=e},e.prototype.makeStale=function(e){this._staleCallback.call(e,e)},e.prototype.location=function(){return this.method==="get"?this.fullPath:""},e.prototype.toString=function(){return[this.method.toUpperCase(),this.path].join(" ")},e.prototype.toJSON=function(){return{title:this.raw.title,fullPath:this.raw.fullPath,method:this.raw.method,timestamp:this.raw.timestamp}},e.forPageLoad=function(){return new this({method:"get",fullPath:Davis.location.current(),title:document.title,forPageLoad:!0})},e.prev=null,e}(),Davis.App=function(){function e(){this.running=!1,this.boundToInternalEvents=!1,this.use(Davis.listener),this.use(Davis.event),this.use(Davis.router),this.use(Davis.logger)}return e.prototype.configure=function(e){e.call(this.settings,this.settings)},e.prototype.use=function(e){e.apply(this,Davis.utils.toArray(arguments,1))},e.prototype.helpers=function(e){for(property in e)e.hasOwnProperty(property)&&(Davis.Request.prototype[property]=e[property])},e.prototype.settings={linkSelector:"a",formSelector:"form",throwErrors:!0,handleRouteNotFound:!1,generateRequestOnPageLoad:!1},e.prototype.start=function(){var e=this;if(this.running)return;if(!Davis.supported()){this.trigger("unsupported");return}var t=function(e){return function(t){var n=t.run(e,e);return typeof n=="undefined"||n}},n=function(n){return Davis.utils.every(e.lookupBeforeFilter(n.method,n.path),t(n))},r=function(r){if(n(r)){e.trigger("lookupRoute",r);var i=e.lookupRoute(r.method,r.path);if(i){e.trigger("runRoute",r,i);try{i.run(r),e.trigger("routeComplete",r,i)}catch(s){e.trigger("routeError",r,i,s)}Davis.utils.every(e.lookupAfterFilter(r.method,r.path),t(r))}else e.trigger("routeNotFound",r)}else e.trigger("requestHalted",r)},i=function(){e.bind("runRoute",function(t){e.logger.info("runRoute: "+t.toString())}).bind("routeNotFound",function(t){!e.settings.handleRouteNotFound&&!t.isForPageLoad&&(e.stop(),t.delegateToServer()),e.logger.warn("routeNotFound: "+t.toString())}).bind("start",function(){e.logger.info("application started")}).bind("stop",function(){e.logger.info("application stopped")}).bind("routeError",function(t,n,r){if(e.settings.throwErrors)throw r;e.logger.error(r.message,r.stack)}),Davis.location.onChange(function(e){r(e)}),e.boundToInternalEvents=!0};this.boundToInternalEvents||i(),this.listen(),this.trigger("start"),this.running=!0,this.settings.generateRequestOnPageLoad&&r(Davis.Request.forPageLoad())},e.prototype.stop=function(){this.unlisten(),this.trigger("stop"),this.running=!1},e}();!function(e){e(function(){"use strict",e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){s.trigger("closed").remove()}var r=e(this),i=r.attr("data-target"),s;i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),s=e(i),t&&t.preventDefault(),s.length||(s=r.hasClass("alert")?r:r.parent()),s.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.on(e.support.transition.end,n):n()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(e){return e||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",f=this,l=e.Event("slide");this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(l);if(l.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),f.sliding=!1,setTimeout(function(){f.$element.trigger("slid")},0)})}else{this.$element.trigger(l);if(l.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n);i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):typeof n=="string"||(n=s.slide)?i[n]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();e(i).collapse(s)})})}(window.jQuery),!function(e){function t(){e(n).parent().removeClass("open")}"use strict";var n='[data-toggle="dropdown"]',r=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};r.prototype={constructor:r,toggle:function(n){var r=e(this),i,s,o;if(r.is(".disabled, :disabled"))return;return s=r.attr("data-target"),s||(s=r.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),i=e(s),i.length||(i=r.parent()),o=i.hasClass("open"),t(),o||i.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("dropdown");i||n.data("dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e(function(){e("html").on("click.dropdown.data-api",t),e("body").on("click.dropdown",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",n,r.prototype.toggle)})}(window.jQuery),!function(e){function t(){var t=this,r=setTimeout(function(){t.$element.off(e.support.transition.end),n.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(r),n.call(t)})}function n(e){this.$element.hide().trigger("hidden"),r.call(this)}function r(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),s?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(i,this)):i.call(this)):t&&t()}function i(){this.$backdrop.remove(),this.$backdrop=null}function s(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}"use strict";var o=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};o.prototype={constructor:o,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,s.call(this),r.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(r){r&&r.preventDefault();var i=this;r=e.Event("hide"),this.$element.trigger(r);if(!this.isShown||r.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),s.call(this),this.$element.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?t.call(this):n.call(this)}},e.fn.modal=function(t){return this.each(function(){var n=e(this),r=n.data("modal"),i=e.extend({},e.fn.modal.defaults,n.data(),typeof t=="object"&&t);r||n.data("modal",r=new o(this,i)),typeof t=="string"?r[t]():i.show&&r.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=o,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({},i.data(),n.data());t.preventDefault(),i.modal(s)})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},isHTML:function(e){return typeof e!="string"||e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.isHTML(t)?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){r.off(e.support.transition.end).remove()},500);r.one(e.support.transition.end,function(){clearTimeout(t),r.remove()})}var n=this,r=this.tip();r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():r.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.isHTML(t)?"html":"text"](t),e.find(".popover-content > *")[this.isHTML(n)?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}"use strict",t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&n.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu")&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var s=n.find("> .active"),o=r&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,i):i(),s.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n=this,r,i;return this.query=this.$element.val(),this.query?(r=e.grep(this.source,function(e){return n.matcher(e)}),r=this.sorter(r),r.length?this.render(r.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keypress,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.type!="keydown")break;e.preventDefault(),this.prev();break;case 40:if(e.type!="keydown")break;e.preventDefault(),this.next()}e.stopPropagation()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery);(function(){function e(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function t(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function n(e){return Array.prototype.slice.call(e)}function r(){}function i(e){return e}function s(){return this}function o(){return!0}function u(e){return typeof e=="function"?e:function(){return e}}function a(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function f(e){return e!=null&&!isNaN(e)}function l(e){return e.length}function c(e){return e==null}function h(e){return e.trim().replace(/\s+/g," ")}function p(e){var t=1;while(e*t%1)t*=10;return t}function d(){}function v(e){function t(){var t=n,r=-1,i=t.length,s;while(++r<i)(s=t[r].on)&&s.apply(this,arguments);return e}var n=[],i=new r;return t.on=function(t,r){var s=i.get(t),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),i.remove(t)),r&&n.push(i.set(t,{on:r})),e)},t}function m(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function g(e){return e+""}function y(e){var t=e.lastIndexOf("."),n=t>=0?e.substring(t):(t=e.length,""),r=[];while(t>0)r.push(e.substring(t-=3,t+3));return r.reverse().join(",")+n}function b(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function w(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function E(e){return function(t){return 1-e(1-t)}}function S(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function x(e){return e}function T(e){return function(t){return Math.pow(t,e)}}function N(e){return 1-Math.cos(e*Math.PI/2)}function C(e){return Math.pow(2,10*(e-1))}function k(e){return 1-Math.sqrt(1-e*e)}function L(e,t){var n;return arguments.length<2&&(t=.45),arguments.length<1?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*Math.PI/t)}}function A(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function O(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function M(){d3.event.stopPropagation(),d3.event.preventDefault()}function _(){var e=d3.event,t;while(t=e.sourceEvent)e=t;return e}function D(e){var t=new d,n=0,r=arguments.length;while(++n<r)t[arguments[n]]=v(t);return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(n,r)}finally{d3.event=s}}},t}function P(e){var t=[e.a,e.b],n=[e.c,e.d],r=B(t),i=H(t,n),s=B(j(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*ls,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*ls:0}function H(e,t){return e[0]*t[0]+e[1]*t[1]}function B(e){var t=Math.sqrt(H(e,e));return t&&(e[0]/=t,e[1]/=t),t}function j(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function F(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function I(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function q(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function R(){}function U(e,t,n){return new z(e,t,n)}function z(e,t,n){this.r=e,this.g=t,this.b=n}function W(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function X(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(K(u[0]),K(u[1]),K(u[2]))}}return(a=ds.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function V(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,Q(o,u,a)}function $(e,t,n){e=J(e),t=J(t),n=J(n);var r=ut((.4124564*e+.3575761*t+.1804375*n)/ys),i=ut((.2126729*e+.7151522*t+.072175*n)/bs),s=ut((.0193339*e+.119192*t+.9503041*n)/ws);return nt(116*i-16,500*(r-i),200*(i-s))}function J(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function K(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function Q(e,t,n){return new G(e,t,n)}function G(e,t,n){this.h=e,this.s=t,this.l=n}function Y(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o,U(i(e+120),i(e),i(e-120))}function Z(e,t,n){return new et(e,t,n)}function et(e,t,n){this.h=e,this.c=t,this.l=n}function tt(e,t,n){return nt(n,Math.cos(e*=Math.PI/180)*t,Math.sin(e)*t)}function nt(e,t,n){return new rt(e,t,n)}function rt(e,t,n){this.l=e,this.a=t,this.b=n}function it(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=ot(i)*ys,r=ot(r)*bs,s=ot(s)*ws,U(at(3.2404542*i-1.5371385*r-.4985314*s),at(-0.969266*i+1.8760108*r+.041556*s),at(.0556434*i-.2040259*r+1.0572252*s))}function st(e,t,n){return Z(Math.atan2(n,t)/Math.PI*180,Math.sqrt(t*t+n*n),e)}function ot(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ut(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function at(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function ft(e){return Qi(e,ks),e}function lt(e){return function(){return Ss(e,this)}}function ct(e){return function(){return xs(e,this)}}function ht(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i}function pt(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function dt(e,t){function n(){var n=-1;while(++n<i)e[n](this,t)}function r(){var n=-1,r=t.apply(this,arguments);while(++n<i)e[n](this,r)}e=e.trim().split(/\s+/).map(vt);var i=e.length;return typeof t=="function"?r:n}function vt(e){var t=pt(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=h(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=h(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function mt(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function gt(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function yt(e){return{__data__:e}}function bt(e){return function(){return Cs(this,e)}}function wt(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function Et(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function i(){function i(e){var n=d3.event;d3.event=e,u[0]=o.__data__;try{t.apply(o,u)}finally{d3.event=n}}var o=this,u=arguments;r.call(this),this.addEventListener(e,this[s]=i,i.$=n),i._=t}var s="__on"+e,o=e.indexOf(".");return o>0&&(e=e.substring(0,o)),t?i:r}function St(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function xt(e){return Qi(e,As),e}function Tt(e,t,n){Qi(e,Os);var i=new r,s=d3.dispatch("start","end"),o=Fs;return e.id=t,e.time=n,e.tween=function(t,n){return arguments.length<2?i.get(t):(n==null?i.remove(t):i.set(t,n),e)},e.ease=function(t){return arguments.length?(o=typeof t=="function"?t:d3.ease.apply(d3,arguments),e):o},e.each=function(t,n){return arguments.length<2?Nt.call(e,t):(s.on(t,n),e)},d3.timer(function(r){return St(e,function(e,u,a){function f(r){return v.active>t?c():(v.active=t,i.forEach(function(t,n){(n=n.call(e,m,u))&&h.push(n)}),s.start.call(e,m,u),l(r)||d3.timer(l,0,n),1)}function l(n){if(v.active!==t)return c();var r=(n-p)/d,i=o(r),a=h.length;while(a>0)h[--a].call(e,i);if(r>=1)return c(),_s=t,s.end.call(e,m,u),_s=0,1}function c(){return--v.count||delete e.__transition__,1}var h=[],p=e.delay,d=e.duration,v=(e=e.node).__transition__||(e.__transition__={active:0,count:0}),m=e.__data__;++v.count,p<=r?f(r):d3.timer(f,p,n)})},0,n),e}function Nt(e){var t=_s,n=Fs,r=Bs,i=js;return _s=this.id,Fs=this.ease(),St(this,function(t,n,r){Bs=t.delay,js=t.duration,e.call(t=t.node,t.__data__,n,r)}),_s=t,Fs=n,Bs=r,js=i,this}function Ct(e,t,n){return n!=""&&Is}function kt(e,t){return d3.tween(e,F(t))}function Lt(){var e,t=Date.now(),n=Us;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=At()-t;r>24?(isFinite(r)&&(clearTimeout(Ws),Ws=setTimeout(Lt,r)),zs=0):(zs=1,Xs(Lt))}function At(){var e=null,t=Us,n=Infinity;while(t)t.flush?(delete Rs[t.callback.id],t=e?e.next=t.next:Us=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Ot(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(Vs<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=n[0][0].getScreenCTM();Vs=!i.f&&!i.e,n.remove()}return Vs?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function Mt(){}function _t(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Dt(e){return e.rangeExtent?e.rangeExtent():_t(e.range())}function Pt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function Ht(){return Math}function Bt(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?zt:Ut,a=r?q:I;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return qt(e,t)},s.tickFormat=function(t){return Rt(e,t)},s.nice=function(){return Pt(e,Ft),i()},s.copy=function(){return Bt(e,t,n,r)},i()}function jt(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Ft(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function It(e,t){var n=_t(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function qt(e,t){return d3.range.apply(d3,It(e,t))}function Rt(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(It(e,t)[2])/Math.LN10+.01))+"f")}function Ut(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function zt(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++o<=u)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=d3.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function Wt(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?Vt:Xt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(Pt(e.domain(),Ht)),n},n.ticks=function(){var n=_t(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=r(n[0]),a=r(n[1]);if(t===Vt){i.push(r(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(r(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(r(s)*f);i.push(r(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=$s);if(arguments.length<1)return i;var s=Math.max(.1,e/n.ticks().length),o=t===Vt?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<=s?i(e):""}},n.copy=function(){return Wt(e.copy(),t)},jt(n,e)}function Xt(e){return Math.log(e<0?0:e)/Math.LN10}function Vt(e){return-Math.log(e>0?0:-e)/Math.LN10}function $t(e,t){function n(t){return e(r(t))}var r=Jt(t),i=Jt(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return qt(n.domain(),e)},n.tickFormat=function(e){return Rt(n.domain(),e)},n.nice=function(){return n.domain(Pt(n.domain(),Ft))},n.exponent=function(e){if(!arguments.length)return t;var s=n.domain();return r=Jt(t=e),i=Jt(1/t),n.domain(s)},n.copy=function(){return $t(e.copy(),t)},jt(n,e)}function Jt(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Kt(e,t){function n(t){return o[((s.get(t)||s.set(t,e.push(t)))-1)%o.length]}function i(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var s,o,u;return n.domain=function(i){if(!arguments.length)return e;e=[],s=new r;var o=-1,u=i.length,a;while(++o<u)s.has(a=i[o])||s.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,u=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var a=r[0],f=r[1],l=(f-a)/(Math.max(1,e.length-1)+s);return o=i(e.length<2?(a+f)/2:a+l*s/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=(c-l)/(e.length-s+2*a);return o=i(l+h*a,h),f&&o.reverse(),u=h*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=Math.floor((c-l)/(e.length-s+2*a)),p=c-l-(e.length-s)*h;return o=i(l+Math.round(p/2),h),f&&o.reverse(),u=Math.round(h*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return _t(t.a[0])},n.copy=function(){return Kt(e,t)},n.domain(e)}function Qt(e,t){function n(){var n=0,s=e.length,o=t.length;i=[];while(++n<o)i[n-1]=d3.quantile(e,n/o);return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return Qt(e,t)},n()}function Gt(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return Gt(e,t,n)},i()}function Yt(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Yt(e,t)},n}function Zt(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return qt(e,t)},t.tickFormat=function(t){return Rt(e,t)},t.copy=function(){return Zt(e)},t}function en(e){return e.innerRadius}function tn(e){return e.outerRadius}function nn(e){return e.startAngle}function rn(e){return e.endAngle}function sn(e){function t(t){function o(){a.push("M",s(e(l),f))}var a=[],l=[],c=-1,h=t.length,p,d=u(n),v=u(r);while(++c<h)i.call(this,p=t[c],c)?l.push([+d.call(this,p,c),+v.call(this,p,c)]):l.length&&(o(),l=[]);return l.length&&o(),a.length?a.join(""):null}var n=on,r=un,i=o,s=an,a=s.key,f=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(typeof e=="function"?a=s=e:a=(s=eo.get(e)||an).key,t):a},t.tension=function(e){return arguments.length?(f=e,t):f},t}function on(e){return e[0]}function un(e){return e[1]}function an(e){return e.join("L")}function fn(e){return an(e)+"Z"}function ln(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function cn(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function hn(e,t){return e.length<4?an(e):e[1]+vn(e.slice(1,e.length-1),mn(e,t))}function pn(e,t){return e.length<3?an(e):e[0]+vn((e.push(e[0]),e),mn([e[e.length-2]].concat(e,[e[1]]),t))}function dn(e,t,n){return e.length<3?an(e):e[0]+vn(e,mn(e,t))}function vn(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return an(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function mn(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function gn(e){if(e.length<3)return an(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Sn(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Sn(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Sn(a,o,u);return a.join("")}function yn(e){if(e.length<4)return an(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(En(ro,s)+","+En(ro,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Sn(t,s,o);return t.join("")}function bn(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[En(ro,o),",",En(ro,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Sn(t,o,u);return t.join("")}function wn(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}return gn(e)}function En(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Sn(e,t,n){e.push("C",En(to,t),",",En(to,n),",",En(no,t),",",En(no,n),",",En(ro,t),",",En(ro,n))}function xn(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Tn(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=xn(i,s);while(++t<n)r[t]=(o+(o=xn(i=s,s=e[t+1])))/2;return r[t]=o,r}function Nn(e){var t=[],n,r,i,s,o=Tn(e),u=-1,a=e.length-1;while(++u<a)n=xn(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function Cn(e){return e.length<3?an(e):e[0]+vn(e,Nn(e))}function kn(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+Ys,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function Ln(e){function t(t){function o(){l.push("M",f(e(v),p),h,c(e(d.reverse()),p),"Z")}var l=[],d=[],v=[],m=-1,g=t.length,y,b=u(n),w=u(i),E=n===r?function(){return x}:u(r),S=i===s?function(){return T}:u(s),x,T;while(++m<g)a.call(this,y=t[m],m)?(d.push([x=+b.call(this,y,m),T=+w.call(this,y,m)]),v.push([+E.call(this,y,m),+S.call(this,y,m)])):d.length&&(o(),d=[],v=[]);return d.length&&o(),l.length?l.join(""):null}var n=on,r=on,i=0,s=un,a=o,f=an,l=f.key,c=f,h="L",p=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(typeof e=="function"?l=f=e:l=(f=eo.get(e)||an).key,c=f.reverse||f,h=f.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(p=e,t):p},t}function An(e){return e.source}function On(e){return e.target}function Mn(e){return e.radius}function _n(e){return e.startAngle}function Dn(e){return e.endAngle}function Pn(e){return[e.x,e.y]}function Hn(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Ys;return[n*Math.cos(r),n*Math.sin(r)]}}function Bn(){return 64}function jn(){return"circle"}function Fn(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function In(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function qn(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function Rn(e,t,n){i=[];if(n&&t.length>1){var r=_t(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function Un(){fo||(fo=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e=d3.event,t;try{fo.scrollTop=1e3,fo.dispatchEvent(e),t=1e3-fo.scrollTop}catch(n){t=e.wheelDelta||-e.detail*5}return t}function zn(e){var t=e.source,n=e.target,r=Xn(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function Wn(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function Xn(e,t){if(e===t)return e;var n=Wn(e),r=Wn(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function Vn(e){e.fixed|=2}function $n(e){e.fixed&=1}function Jn(e){e.fixed|=4}function Kn(e){e.fixed&=3}function Qn(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;Qn(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function Gn(e){return 20}function Yn(e){return 1}function Zn(e){return e.x}function er(e){return e.y}function tr(e,t,n){e.y0=t,e.y=n}function nr(e){return d3.range(e.length)}function rr(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function ir(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function sr(e){return e.reduce(or,0)}function or(e,t){return e+t[1]}function ur(e,t){return ar(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ar(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function fr(e){return[d3.min(e),d3.max(e)]}function lr(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=dr,e.nodes=function(t){return vo=!0,(e.nodes=e)(t)},e}function cr(e){return e.children}function hr(e){return e.value}function pr(e,t){return t.value-e.value}function dr(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function vr(e,t){return e.value-t.value}function mr(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function gr(e,t){e._pack_next=t,t._pack_prev=e}function yr(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function br(e){function t(e){r=Math.min(e.x-e.r,r),i=Math.max(e.x+e.r,i),s=Math.min(e.y-e.r,s),o=Math.max(e.y+e.r,o)}if(!(n=e.children)||!(p=n.length))return;var n,r=Infinity,i=-Infinity,s=Infinity,o=-Infinity,u,a,f,l,c,h,p;n.forEach(wr),u=n[0],u.x=-u.r,u.y=0,t(u);if(p>1){a=n[1],a.x=a.r,a.y=0,t(a);if(p>2){f=n[2],xr(u,a,f),t(f),mr(u,f),u._pack_prev=f,mr(f,a),a=u._pack_next;for(l=3;l<p;l++){xr(u,a,f=n[l]);var d=0,v=1,m=1;for(c=a._pack_next;c!==a;c=c._pack_next,v++)if(yr(c,f)){d=1;break}if(d==1)for(h=u._pack_prev;h!==c._pack_prev;h=h._pack_prev,m++)if(yr(h,f))break;d?(v<m||v==m&&a.r<u.r?gr(u,a=c):gr(u=h,a),l--):(mr(u,f),a=f,t(f))}}}var g=(r+i)/2,y=(s+o)/2,b=0;for(l=0;l<p;l++)f=n[l],f.x-=g,f.y-=y,b=Math.max(b,f.r+Math.sqrt(f.x*f.x+f.y*f.y));e.r=b,n.forEach(Er)}function wr(e){e._pack_next=e._pack_prev=e}function Er(e){delete e._pack_next,delete e._pack_prev}function Sr(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)Sr(i[s],t,n,r)}}function xr(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function Tr(e){return 1+d3.max(e,function(e){return e.y})}function Nr(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Cr(e){var t=e.children;return t&&t.length?Cr(t[0]):e}function kr(e){var t=e.children,n;return t&&(n=t.length)?kr(t[n-1]):e}function Lr(e,t){return e.parent==t.parent?1:2}function Ar(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Or(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Mr(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=Mr(n[s],t),e)>0&&(e=r)}return e}function _r(e,t){return e.x-t.x}function Dr(e,t){return t.x-e.x}function Pr(e,t){return e.depth-t.depth}function Hr(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function Br(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function jr(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function Fr(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function Ir(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function qr(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function Rr(e,t){function n(e,r){d3.text(e,t,function(e){r(e&&n.parse(e))})}function r(t){return t.map(i).join(e)}function i(e){return o.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp("\r\n|["+e+"\r\n]","g"),o=new RegExp('["'+e+"\n]"),u=e.charCodeAt(0);return n.parse=function(e){var t;return n.parseRows(e,function(e,n){if(n){var r={},i=-1,s=t.length;while(++i<s)r[t[i]]=e[i];return r}return t=e,null})},n.parseRows=function(e,t){function n(){if(s.lastIndex>=e.length)return i;if(l)return l=!1,r;var t=s.lastIndex;if(e.charCodeAt(t)===34){var n=t;while(n++<e.length)if(e.charCodeAt(n)===34){if(e.charCodeAt(n+1)!==34)break;n++}s.lastIndex=n+2;var o=e.charCodeAt(n+1);return o===13?(l=!0,e.charCodeAt(n+2)===10&&s.lastIndex++):o===10&&(l=!0),e.substring(t+1,n).replace(/""/g,'"')}var a=s.exec(e);return a?(l=a[0].charCodeAt(0)!==u,e.substring(t,a.index)):(s.lastIndex=e.length,e.substring(t))}var r={},i={},o=[],a=0,f,l;s.lastIndex=0;while((f=n())!==i){var c=[];while(f!==r&&f!==i)c.push(f),f=n();if(t&&!(c=t(c,a++)))continue;o.push(c)}return o},n.format=function(e){return e.map(r).join("\n")},n}function Ur(e,t){return function(n){return n&&e.hasOwnProperty(n.type)?e[n.type](n):t}}function zr(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Wr(e,t){go.hasOwnProperty(e.type)&&go[e.type](e,t)}function Xr(e,t){Wr(e.geometry,t)}function Vr(e,t){for(var n=e.features,r=0,i=n.length;r<i;r++)Wr(n[r].geometry,t)}function $r(e,t){for(var n=e.geometries,r=0,i=n.length;r<i;r++)Wr(n[r],t)}function Jr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)t.apply(null,n[r])}function Kr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)for(var s=n[r],o=0,u=s.length;o<u;o++)t.apply(null,s[o])}function Qr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)for(var s=n[r][0],o=0,u=s.length;o<u;o++)t.apply(null,s[o])}function Gr(e,t){t.apply(null,e.coordinates)}function Yr(e,t){for(var n=e.coordinates[0],r=0,i=n.length;r<i;r++)t.apply(null,n[r])}function Zr(e){return e.source}function ei(e){return e.target}function ti(){function e(e){var t=Math.sin(e*=p)*d,n=Math.sin(p-e)*d,r=n*s+t*c,u=n*o+t*h,a=n*i+t*l;return[Math.atan2(u,r)/mo,Math.atan2(a,Math.sqrt(r*r+u*u))/mo]}var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return e.distance=function(){return p==null&&(d=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,i*l+r*f*Math.cos(u-t)))))),p},e.source=function(u){var a=Math.cos(t=u[0]*mo),f=Math.sin(t);return r=Math.cos(n=u[1]*mo),i=Math.sin(n),s=r*a,o=r*f,p=null,e},e.target=function(t){var n=Math.cos(u=t[0]*mo),r=Math.sin(u);return f=Math.cos(a=t[1]*mo),l=Math.sin(a),c=f*n,h=f*r,p=null,e},e}function ni(e,t){var n=ti().source(e).target(t);return n.distance(),n}function ri(e){var t=0,n=0;for(;;){if(e(t,n))return[t,n];t===0?(t=n+1,n=0):(t-=1,n+=1)}}function ii(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function si(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function oi(e,t,n,r){var i=e[0],s=t[0],o=n[0],u=r[0],a=e[1],f=t[1],l=n[1],c=r[1],h=i-o,p=s-i,d=u-o,v=a-l,m=f-a,g=c-l,y=(d*v-g*h)/(g*p-d*m);return[i+y*p,a+y*m]}function ui(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[wo[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[wo[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,wo[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function ai(){return{leaf:!0,nodes:[],point:null}}function fi(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&fi(e,a[0],n,r,o,u),a[1]&&fi(e,a[1],o,r,i,u),a[2]&&fi(e,a[2],n,u,o,s),a[3]&&fi(e,a[3],o,u,i,s)}}function li(e){return{x:e[0],y:e[1]}}function ci(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function hi(e){return e.substring(0,3)}function pi(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a)return-1;i=t.charCodeAt(o++);if(i==37){s=Uo[t.charAt(o++)];if(!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function di(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")}function vi(e){var t=new r,n=-1,i=e.length;while(++n<i)t.set(e[n].toLowerCase(),n);return t}function mi(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n));return r?n+=r[0].length:-1}function gi(e,t,n){Ho.lastIndex=0;var r=Ho.exec(t.substring(n));return r?n+=r[0].length:-1}function yi(e,t,n){Io.lastIndex=0;var r=Io.exec(t.substring(n));return r?(e.m=qo.get(r[0].toLowerCase()),n+=r[0].length):-1}function bi(e,t,n){jo.lastIndex=0;var r=jo.exec(t.substring(n));return r?(e.m=Fo.get(r[0].toLowerCase()),n+=r[0].length):-1}function wi(e,t,n){return pi(e,Ro.c.toString(),t,n)}function Ei(e,t,n){return pi(e,Ro.x.toString(),t,n)}function Si(e,t,n){return pi(e,Ro.X.toString(),t,n)}function xi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function Ti(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.y=Ni(+r[0]),n+=r[0].length):-1}function Ni(e){return e+(e>68?1900:2e3)}function Ci(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function ki(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function Li(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function Ai(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function Oi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function Mi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function _i(e,t,n){var r=Wo.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function Di(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+Mo(r)+Mo(i)}function Pi(e){return e.toISOString()}function Hi(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new Eo(n-1)),1),n}function s(e,n){return t(e=new Eo(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)while(o<r)n(o)%s||u.push(new Date(+o)),t(o,1);else while(o<r)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{Eo=ci;var r=new ci;return r._=e,o(r,t,n)}finally{Eo=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Bi(e);return a.floor=a,a.round=Bi(r),a.ceil=Bi(i),a.offset=Bi(s),a.range=u,e}function Bi(e){return function(t,n){try{Eo=ci;var r=new ci;return r._=t,e(r,n)._}finally{Eo=Date}}}function ji(e,t,n){function r(t){return e(t)}return r.invert=function(t){return Ii(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(Ii)},r.nice=function(e){return r.domain(Pt(r.domain(),function(){return e}))},r.ticks=function(n,i){var s=Fi(r.domain());if(typeof n!="function"){var o=s[1]-s[0],u=o/n,a=d3.bisect(Vo,u);if(a==Vo.length)return t.year(s,n);if(!a)return e.ticks(n).map(Ii);Math.log(u/Vo[a-1])<Math.log(Vo[a]/u)&&--a,n=t[a],i=n[1],n=n[0].range}return n(s[0],new Date(+s[1]+1),i)},r.tickFormat=function(){return n},r.copy=function(){return ji(e.copy(),t,n)},d3.rebind(r,e,"range","rangeRound","interpolate","clamp")}function Fi(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Ii(e){return new Date(e)}function qi(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t))r=e[--n];return r[0](t)}}function Ri(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Ui(e){var t=e.getFullYear(),n=Ri(t),r=Ri(t+1);return t+(e-n)/(r-n)}function zi(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function Wi(e){var t=e.getUTCFullYear(),n=zi(t),r=zi(t+1);return t+(e-n)/(r-n)}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Xi){var Vi=CSSStyleDeclaration.prototype,$i=Vi.setProperty;Vi.setProperty=function(e,t,n){$i.call(this,e,t+"",n)}}d3={version:"2.10.3"};var Ji=n;try{Ji(document.documentElement.childNodes)[0].nodeType}catch(Ki){Ji=t}var Qi=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.map=function(e){var t=new r;for(var n in e)t.set(n,e[n]);return t},e(r,{has:function(e){return Gi+e in this},get:function(e){return this[Gi+e]},set:function(e,t){return this[Gi+e]=t},remove:function(e){return e=Gi+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===Yi&&e.call(this,t.substring(1),this[t])}});var Gi="\0",Yi=Gi.charCodeAt(0);d3.functor=u,d3.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=a(e,t,t[i]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1)while(++s<n)f(r=e[s])&&(i+=(r-i)/++o);else while(++s<n)f(r=t.call(e,e[s],s))&&(i+=(r-i)/++o);return o?i:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(f),e.length?d3.quantile(e.sort(d3.ascending),.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var r=d3.random.normal();return function(){return Math.exp(e+t*r())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=d3.min(arguments,l),n=new Array(t);++e<t;)for(var r=-1,i,s=n[e]=new Array(i);++r<i;)s[r]=arguments[r][e];return n},d3.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var Zi=d3.bisector(function(e){return e});d3.bisectLeft=Zi.left,d3.bisect=d3.bisectRight=Zi.right,d3.first=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])>0&&(i=s);return i},d3.last=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])<=0&&(i=s);return i},d3.nest=function(){function e(t,s){if(s>=i.length)return u?u.call(n,t):o?t.sort(o):t;var a=-1,f=t.length,l=i[s++],c,h,p=new r,d,v={};while(++a<f)(d=p.get(c=l(h=t[a])))?d.push(h):p.set(c,[h]);return p.forEach(function(t,n){v[t]=e(n,s)}),v}function t(e,n){if(n>=i.length)return e;var r=[],o=s[n++],u;for(u in e)r.push({key:u,values:t(e[u],n)});return o&&r.sort(function(e,t){return o(e.key,t.key)}),r}var n={},i=[],s=[],o,u;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return i.push(e),n},n.sortKeys=function(e){return s[i.length-1]=e,n},n.sortValues=function(e){return o=e,n},n.rollup=function(e){return u=e,n},n},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var n=[],r=[],i,s=-1,o=e.length;arguments.length<2&&(t=c);while(++s<o)t.call(r,i=e[s],s)?r=[]:(r.length||n.push(r),r.push(i));return n},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=p(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},d3.requote=function(e){return e.replace(es,"\\$&")};var es=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){var r=new XMLHttpRequest;arguments.length<3?(n=t,t=null):t&&r.overrideMimeType&&r.overrideMimeType(t),r.open("GET",e,!0),t&&r.setRequestHeader("Accept",t),r.onreadystatechange=function(){if(r.readyState===4){var e=r.status;n(!e&&r.response||e>=200&&e<300||e===304?r:null)}},r.send(null)},d3.text=function(e,t,n){function r(e){n(e&&e.responseText)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)},d3.json=function(e,t){d3.text(e,"application/json",function(e){t(e?JSON.parse(e):null)})},d3.html=function(e,t){d3.text(e,"text/html",function(e){if(e!=null){var n=document.createRange();n.selectNode(document.body),e=n.createContextualFragment(e)}t(e)})},d3.xml=function(e,t,n){function r(e){n(e&&e.responseXML)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)};var ts={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:ts,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),ts.hasOwnProperty(n)?{space:ts[n],local:e}:e}},d3.dispatch=function(){var e=new d,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=v(e);return e},d.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},d3.format=function(e){var t=ns.exec(e),n=t[1]||" ",r=t[3]||"",i=t[5],s=+t[6],o=t[7],u=t[8],a=t[9],f=1,l="",c=!1;u&&(u=+u.substring(1)),i&&(n="0",o&&(s-=Math.floor((s-1)/4)));switch(a){case"n":o=!0,a="g";break;case"%":f=100,l="%",a="f";break;case"p":f=100,l="%",a="r";break;case"d":c=!0,u=0;break;case"s":f=-1,a="r"}return a=="r"&&!u&&(a="g"),a=rs.get(a)||g,function(e){if(c&&e%1)return"";var t=e<0&&(e=-e)?"-":r;if(f<0){var h=d3.formatPrefix(e,u);e=h.scale(e),l=h.symbol}else e*=f;e=a(e,u);if(i){var p=e.length+t.length;p<s&&(e=(new Array(s-p+1)).join(n)+e),o&&(e=y(e)),e=t+e}else{o&&(e=y(e)),e=t+e;var p=e.length;p<s&&(e=(new Array(s-p+1)).join(n)+e)}return e+l}};var ns=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,rs=d3.map({g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=m(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),is=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(b);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,m(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),is[8+n/3]};var ss=T(2),os=T(3),us=function(){return x},as=d3.map({linear:us,poly:T,quad:function(){return ss},cubic:function(){return os},sin:function(){return N},exp:function(){return C},circle:function(){return k},elastic:L,back:A,bounce:function(){return O}}),fs=d3.map({"in":x,out:E,"in-out":S,"out-in":function(e){return S(E(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=as.get(n)||us,r=fs.get(r)||x,w(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new P(n?n.matrix:cs)})(e)},P.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ls=180/Math.PI,cs={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t)));return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;hs.lastIndex=0;for(r=0;n=hs.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=hs.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=hs.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){var n=[],r=[],i,s=d3.transform(e),o=d3.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(u[0],a[0])},{i:3,x:d3.interpolateNumber(u[1],a[1])})):a[0]||a[1]?n.push("translate("+a+")"):n.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(f,l)})):l&&n.push(n.pop()+"rotate("+l+")"),c!=h?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(c,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:d3.interpolateNumber(p[0],d[0])},{i:i-2,x:d3.interpolateNumber(p[1],d[1])})):(d[0]!=1||d[1]!=1)&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){var t=-1,s;while(++t<i)n[(s=r[t]).i]=s.x(e);return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+W(Math.round(n+s*e))+W(Math.round(r+o*e))+W(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return Y(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return it(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return tt(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(d3.interpolate(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=F(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var hs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&d3.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?ds.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof R)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],R.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(e,t,n){return arguments.length===1?e instanceof z?U(e.r,e.g,e.b):X(""+e,U,Y):U(~~e,~~t,~~n)};var ps=z.prototype=new R;ps.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?U(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),U(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},ps.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),U(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},ps.hsl=function(){return V(this.r,this.g,this.b)},ps.toString=function(){return"#"+W(this.r)+W(this.g)+W(this.b)};var ds=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});ds.forEach(function(e,t){ds.set(e,X(t,U,Y))}),d3.hsl=function(e,t,n){return arguments.length===1?e instanceof G?Q(e.h,e.s,e.l):X(""+e,V,Q):Q(+e,+t,+n)};var vs=G.prototype=new R;vs.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),Q(this.h,this.s,this.l/e)},vs.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),Q(this.h,this.s,e*this.l)},vs.rgb=function(){return Y(this.h,this.s,this.l)},d3.hcl=function(e,t,n){return arguments.length===1?e instanceof et?Z(e.h,e.c,e.l):e instanceof rt?st(e.l,e.a,e.b):st((e=$((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):Z(+e,+t,+n)};var ms=et.prototype=new R;ms.brighter=function(e){return Z(this.h,this.c,Math.min(100,this.l+gs*(arguments.length?e:1)))},ms.darker=function(e){return Z(this.h,this.c,Math.max(0,this.l-gs*(arguments.length?e:1)))},ms.rgb=function(){return tt(this.h,this.c,this.l).rgb()},d3.lab=function(e,t,n){return arguments.length===1?e instanceof rt?nt(e.l,e.a,e.b):e instanceof et?tt(e.l,e.c,e.h):$((e=d3.rgb(e)).r,e.g,e.b):nt(+e,+t,+n)};var gs=18,ys=.95047,bs=1,ws=1.08883,Es=rt.prototype=new R;Es.brighter=function(e){return nt(Math.min(100,this.l+gs*(arguments.length?e:1)),this.a,this.b)},Es.darker=function(e){return nt(Math.max(0,this.l-gs*(arguments.length?e:1)),this.a,this.b)},Es.rgb=function(){return it(this.l,this.a,this.b)};var Ss=function(e,t){return t.querySelector(e)},xs=function(e,t){return t.querySelectorAll(e)},Ts=document.documentElement,Ns=Ts.matchesSelector||Ts.webkitMatchesSelector||Ts.mozMatchesSelector||Ts.msMatchesSelector||Ts.oMatchesSelector,Cs=function(e,t){return Ns.call(e,t)};typeof Sizzle=="function"&&(Ss=function(e,t){return Sizzle(e,t)[0]||null},xs=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Cs=Sizzle.matchesSelector);var ks=[];d3.selection=function(){return Ls},d3.selection.prototype=ks,ks.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=lt(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return ft(t)},ks.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=ct(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=Ji(e.call(r,r.__data__,u))),n.parentNode=r;return ft(t)},ks.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(ht(t,e[t]));return this}return this.each(ht(e,t))},ks.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r)if(!pt(e[i]).test(t))return!1}return!0}for(t in e)this.each(dt(t,e[t]));return this}return this.each(dt(e,t))},ks.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.each(mt(n,e[n],t));return this}if(r<2)return window.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(mt(e,t,n))},ks.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each(gt(t,e[t]));return this}return this.each(gt(e,t))},ks.text=function(e){return arguments.length<1?this.node().textContent:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e})},ks.html=function(e){return arguments.length<1?this.node().innerHTML:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e})},ks.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},ks.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),Ss(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),Ss(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},ks.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},ks.data=function(e,t){function n(e,n){var i,s=e.length,o=n.length,u=Math.min(s,o),c=Math.max(s,o),h=[],p=[],d=[],v,m;if(t){var g=new r,y=[],b,w=n.length;for(i=-1;++i<s;)b=t.call(v=e[i],v.__data__,i),g.has(b)?d[w++]=v:g.set(b,v),y.push(b);for(i=-1;++i<o;)b=t.call(n,m=n[i],i),g.has(b)?(h[i]=v=g.get(b),v.__data__=m,p[i]=d[i]=null):(p[i]=yt(m),h[i]=d[i]=null),g.remove(b);for(i=-1;++i<s;)g.has(y[i])&&(d[i]=e[i])}else{for(i=-1;++i<u;)v=e[i],m=n[i],v?(v.__data__=m,h[i]=v,p[i]=d[i]=null):(p[i]=yt(m),h[i]=d[i]=null);for(;i<o;++i)p[i]=yt(n[i]),h[i]=d[i]=null;for(;i<c;++i)d[i]=e[i],p[i]=h[i]=null}p.update=h,p.parentNode=h.parentNode=d.parentNode=e.parentNode,a.push(p),f.push(h),l.push(d)}var i=-1,s=this.length,o,u;if(!arguments.length){e=new Array(s=(o=this[0]).length);while(++i<s)if(u=o[i])e[i]=u.__data__;return e}var a=xt([]),f=ft([]),l=ft([]);if(typeof e=="function")while(++i<s)n(o=this[i],e.call(o,o.parentNode.__data__,i));else while(++i<s)n(o=this[i],e);return f.enter=function(){return a},f.exit=function(){return l},f},ks.datum=ks.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)},ks.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=bt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return ft(t)},ks.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},ks.sort=function(e){e=wt.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},ks.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(Et(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(Et(e,t,n))},ks.each=function(e){return St(this,function(t,n,r){e.call(t,t.__data__,n,r)})},ks.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},ks.empty=function(){return!this.node()},ks.node=function(e){for(var t=0,n=this.length;t<n;t++)for(var r=this[t],i=0,s=r.length;i<s;i++){var o=r[i];if(o)return o}return null},ks.transition=function(){var e=[],t,n;for(var r=-1,i=this.length;++r<i;){e.push(t=[]);for(var s=this[r],o=-1,u=s.length;++o<u;)t.push((n=s[o])?{node:n,delay:Bs,duration:js}:null)}return Tt(e,_s||++Ms,Date.now())};var Ls=ft([[document]]);Ls[0].parentNode=Ts,d3.select=function(e){return typeof e=="string"?Ls.select(e):ft([[e]])},d3.selectAll=function(e){return typeof e=="string"?Ls.selectAll(e):ft([Ji(e)])};var As=[];d3.selection.enter=xt,d3.selection.enter.prototype=As,As.append=ks.append,As.insert=ks.insert,As.empty=ks.empty,As.node=ks.node,As.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return ft(t)};var Os=[],Ms=0,_s=0,Ds=0,Ps=250,Hs=d3.ease("cubic-in-out"),Bs=Ds,js=Ps,Fs=Hs;Os.call=ks.call,d3.transition=function(e){return arguments.length?_s?e.transition():e:Ls.transition()},d3.transition.prototype=Os,Os.select=function(e){var t=[],n,r,i;typeof e!="function"&&(e=lt(e));for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(i=u[a])&&(r=e.call(i.node,i.node.__data__,a))?("__data__"in i.node&&(r.__data__=i.node.__data__),n.push({node:r,delay:i.delay,duration:i.duration})):n.push(null)}return Tt(t,this.id,this.time).ease(this.ease())},Os.selectAll=function(e){var t=[],n,r,i;typeof e!="function"&&(e=ct(e));for(var s=-1,o=this.length;++s<o;)for(var u=this[s],a=-1,f=u.length;++a<f;)if(i=u[a]){r=e.call(i.node,i.node.__data__,a),t.push(n=[]);for(var l=-1,c=r.length;++l<c;)n.push({node:r[l],delay:i.delay,duration:i.duration})}return Tt(t,this.id,this.time).ease(this.ease())},Os.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=bt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i.node,i.node.__data__,u)&&n.push(i)}return Tt(t,this.id,this.time).ease(this.ease())},Os.attr=function(e,t){if(arguments.length<2){for(t in e)this.attrTween(t,kt(e[t],t));return this}return this.attrTween(e,kt(t,e))},Os.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r===Is?(this.removeAttribute(i),null):r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r===Is?(this.removeAttributeNS(i.space,i.local),null):r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Os.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.styleTween(n,kt(e[n],n),t);return this}n=""}return this.styleTween(e,kt(t,e),n)},Os.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,window.getComputedStyle(this,null).getPropertyValue(e));return s===Is?(this.style.removeProperty(e),null):s&&function(t){this.style.setProperty(e,s(t),n)}})},Os.text=function(e){return this.tween("text",function(t,n){this.textContent=typeof e=="function"?e.call(this,t,n):e})},Os.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Os.delay=function(e){return St(this,typeof e=="function"?function(t,n,r){t.delay=e.call(t=t.node,t.__data__,n,r)|0}:(e|=0,function(t){t.delay=e}))},Os.duration=function(e){return St(this,typeof e=="function"?function(t,n,r){t.duration=Math.max(1,e.call(t=t.node,t.__data__,n,r)|0)}:(e=Math.max(1,e|0),function(t){t.duration=e}))},Os.transition=function(){return this.select(s)},d3.tween=function(e,t){function n(n,r,i){var s=e.call(this,n,r);return s==null?i!=""&&Is:i!=s&&t(i,s+"")}function r(n,r,i){return i!=e&&t(i,e)}return typeof e=="function"?n:e==null?Ct:(e+="",r)};var Is={},qs=0,Rs={},Us=null,zs,Ws;d3.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=Rs[e.id];r&&r.callback===e?(r.then=n,r.delay=t):Rs[e.id=++qs]=Us={callback:e,then:n,delay:t,next:Us},zs||(Ws=clearTimeout(Ws),zs=1,Xs(Lt))},d3.timer.flush=function(){var e,t=Date.now(),n=Us;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;At()};var Xs=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return Ot(e,_())};var Vs=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=_().touches),t?Ji(t).map(function(t){var n=Ot(e,t);return n.identifier=t.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return Bt([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Wt(d3.scale.linear(),Xt)};var $s=d3.format(".0e");Xt.pow=function(e){return Math.pow(10,e)},Vt.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return $t(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return Kt([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(Js)},d3.scale.category20=function(){return d3.scale.ordinal().range(Ks)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Qs)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Gs)};var Js=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Ks=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Qs=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Gs=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Qt([],[])},d3.scale.quantize=function(){return Gt(0,1,[0,1])},d3.scale.threshold=function(){return Yt([.5],[0,1])},d3.scale.identity=function(){return Zt([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+Ys,u=i.apply(this,arguments)+Ys,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<Math.PI?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=Zs?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var t=en,n=tn,r=nn,i=rn;return e.innerRadius=function(n){return arguments.length?(t=u(n),e):t},e.outerRadius=function(t){return arguments.length?(n=u(t),e):n},e.startAngle=function(t){return arguments.length?(r=u(t),e):r},e.endAngle=function(t){return arguments.length?(i=u(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+Ys;return[Math.cos(s)*e,Math.sin(s)*e]},e};var Ys=-Math.PI/2,Zs=2*Math.PI-1e-6;d3.svg.line=function(){return sn(i)};var eo=d3.map({linear:an,"linear-closed":fn,"step-before":ln,"step-after":cn,basis:gn,"basis-open":yn,"basis-closed":bn,bundle:wn,cardinal:dn,"cardinal-open":hn,"cardinal-closed":pn,monotone:Cn});eo.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var to=[0,2/3,1/3,0],no=[0,1/3,2/3,0],ro=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=sn(kn);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},ln.reverse=cn,cn.reverse=ln,d3.svg.area=function(){return Ln(i)},d3.svg.area.radial=function(){var e=Ln(kn);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,u){var a=t(this,s,e,u),f=t(this,o,e,u);return"M"+a.p0+r(a.r,a.p1,a.a1-a.a0)+(n(a,f)?i(a.r,a.p1,a.r,a.p0):i(a.r,a.p1,f.r,f.p0)+r(f.r,f.p1,f.a1-f.a0)+i(f.r,f.p1,a.r,a.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),s=a.call(e,i,r),o=f.call(e,i,r)+Ys,u=l.call(e,i,r)+Ys;return{r:s,a0:o,a1:u,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(u),s*Math.sin(u)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Math.PI)+",1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var s=An,o=On,a=Mn,f=nn,l=rn;return e.radius=function(t){return arguments.length?(a=u(t),e):a},e.source=function(t){return arguments.length?(s=u(t),e):s},e.target=function(t){return arguments.length?(o=u(t),e):o},e.startAngle=function(t){return arguments.length?(f=u(t),e):f},e.endAngle=function(t){return arguments.length?(l=u(t),e):l},e},d3.svg.diagonal=function(){function e(e,i){var s=t.call(this,e,i),o=n.call(this,e,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(r),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var t=An,n=On,r=Pn;return e.source=function(n){return arguments.length?(t=u(n),e):t},e.target=function(t){return arguments.length?(n=u(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Pn,n=e.projection;return e.projection=function(e){return arguments.length?n(Hn(t=e)):t},e},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function e(e,r){return(io.get(t.call(this,e,r))||Fn)(n.call(this,e,r))}var t=jn,n=Bn;return e.type=function(n){return arguments.length?(t=u(n),e):t},e.size=function(t){return arguments.length?(n=u(t),e):n},e};var io=d3.map({circle:Fn,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*oo)),n=t*oo;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/so),n=t*so/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/so),n=t*so/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});d3.svg.symbolTypes=io.keys();var so=Math.sqrt(3),oo=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each(function(){var e=d3.select(this),c=a==null?t.ticks?t.ticks.apply(t,u):t.domain():a,h=f==null?t.tickFormat?t.tickFormat.apply(t,u):String:f,p=Rn(t,c,l),d=e.selectAll(".minor").data(p,String),v=d.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),m=d3.transition(d.exit()).style("opacity",1e-6).remove(),g=d3.transition(d).style("opacity",1),y=e.selectAll("g").data(c,String),b=y.enter().insert("g","path").style("opacity",1e-6),w=d3.transition(y.exit()).style("opacity",1e-6).remove(),E=d3.transition(y).style("opacity",1),S,x=Dt(t),T=e.selectAll(".domain").data([0]),N=T.enter().append("path").attr("class","domain"),C=d3.transition(T),k=t.copy(),L=this.__chart__||k;this.__chart__=k,b.append("line").attr("class","tick"),b.append("text");var A=b.select("line"),O=E.select("line"),M=y.select("text").text(h),_=b.select("text"),D=E.select("text");switch(n){case"bottom":S=In,v.attr("y2",i),g.attr("x2",0).attr("y2",i),A.attr("y2",r),_.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),D.attr("x",0).attr("y",Math.max(r,0)+o),M.attr("dy",".71em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+s+"V0H"+x[1]+"V"+s);break;case"top":S=In,v.attr("y2",-i),g.attr("x2",0).attr("y2",-i),A.attr("y2",-r),_.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),D.attr("x",0).attr("y",-(Math.max(r,0)+o)),M.attr("dy","0em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+ -s+"V0H"+x[1]+"V"+ -s);break;case"left":S=qn,v.attr("x2",-i),g.attr("x2",-i).attr("y2",0),A.attr("x2",-r),_.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),D.attr("x",-(Math.max(r,0)+o)).attr("y",0),M.attr("dy",".32em").attr("text-anchor","end"),C.attr("d","M"+ -s+","+x[0]+"H0V"+x[1]+"H"+ -s);break;case"right":S=qn,v.attr("x2",i),g.attr("x2",i).attr("y2",0),A.attr("x2",r),_.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),D.attr("x",Math.max(r,0)+o).attr("y",0),M.attr("dy",".32em").attr("text-anchor","start"),C.attr("d","M"+s+","+x[0]+"H0V"+x[1]+"H"+s)}if(t.ticks)b.call(S,L),E.call(S,k),w.call(S,k),v.call(S,L),g.call(S,k),m.call(S,k);else{var P=k.rangeBand()/2,H=function(e){return k(e)+P};b.call(S,H),E.call(S,H)}})}var t=d3.scale.linear(),n="bottom",r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickValues=function(t){return arguments.length?(a=t,e):a},e.tickFormat=function(t){return arguments.length?(f=t,e):f},e.tickSize=function(t,n,o){if(!arguments.length)return r;var u=arguments.length-1;return r=+t,i=u>1?+n:r,s=u>0?+arguments[u]:r,e},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(t){return arguments.length?(l=+t,e):l},e},d3.svg.brush=function(){function e(s){s.each(function(){var s=d3.select(this),f=s.selectAll(".background").data([0]),l=s.selectAll(".extent").data([0]),c=s.selectAll(".resize").data(a,String),h;s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),f.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),l.enter().append("rect").attr("class","extent").style("cursor","move"),c.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return uo[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",e.empty()?"none":null),c.exit().remove(),o&&(h=Dt(o),f.attr("x",h[0]).attr("width",h[1]-h[0]),n(s)),u&&(h=Dt(u),f.attr("y",h[0]).attr("height",h[1]-h[0]),r(s)),t(s)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+f[+/e$/.test(e)][0]+","+f[+/^s/.test(e)][1]+")"})}function n(e){e.select(".extent").attr("x",f[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1][0]-f[0][0])}function r(e){e.select(".extent").attr("y",f[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1][1]-f[0][1])}function i(){function i(){var e=d3.event.changedTouches;return e?d3.touches(v,e)[0]:d3.mouse(v)}function a(){d3.event.keyCode==32&&(S||(x=null,T[0]-=f[1][0],T[1]-=f[1][1],S=2),M())}function c(){d3.event.keyCode==32&&S==2&&(T[0]+=f[1][0],T[1]+=f[1][1],S=0,M())}function h(){var e=i(),s=!1;N&&(e[0]+=N[0],e[1]+=N[1]),S||(d3.event.altKey?(x||(x=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]),T[0]=f[+(e[0]<x[0])][0],T[1]=f[+(e[1]<x[1])][1]):x=null),w&&p(e,o,0)&&(n(y),s=!0),E&&p(e,u,1)&&(r(y),s=!0),s&&(t(y),g({type:"brush",mode:S?"move":"resize"}))}function p(e,t,n){var r=Dt(t),i=r[0],s=r[1],o=T[n],u=f[1][n]-f[0][n],a,c;S&&(i-=o,s-=u+o),a=Math.max(i,Math.min(s,e[n])),S?c=(a+=o)+u:(x&&(o=Math.max(i,Math.min(s,2*x[n]-a))),o<a?(c=a,a=o):c=o);if(f[0][n]!==a||f[1][n]!==c)return l=null,f[0][n]=a,f[1][n]=c,!0}function d(){h(),y.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),g({type:"brushend"}),M()}var v=this,m=d3.select(d3.event.target),g=s.of(v,arguments),y=d3.select(v),b=m.datum(),w=!/^(n|s)$/.test(b)&&o,E=!/^(e|w)$/.test(b)&&u,S=m.classed("extent"),x,T=i(),N,C=d3.select(window).on("mousemove.brush",h).on("mouseup.brush",d).on("touchmove.brush",h).on("touchend.brush",d).on("keydown.brush",a).on("keyup.brush",c);if(S)T[0]=f[0][0]-T[0],T[1]=f[0][1]-T[1];else if(b){var k=+/w$/.test(b),L=+/^n/.test(b);N=[f[1-k][0]-T[0],f[1-L][1]-T[1]],T[0]=f[k][0],T[1]=f[L][1]}else d3.event.altKey&&(x=T.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",m.style("cursor")),g({type:"brushstart"}),h(),M()}var s=D(e,"brushstart","brush","brushend"),o=null,u=null,a=ao[0],f=[[0,0],[0,0]],l;return e.x=function(t){return arguments.length?(o=t,a=ao[!o<<1|!u],e):o},e.y=function(t){return arguments.length?(u=t,a=ao[!o<<1|!u],e):u},e.extent=function(t){var n,r,i,s,a;return arguments.length?(l=[[0,0],[0,0]],o&&(n=t[0],r=t[1],u&&(n=n[0],r=r[0]),l[0][0]=n,l[1][0]=r,o.invert&&(n=o(n),r=o(r)),r<n&&(a=n,n=r,r=a),f[0][0]=n|0,f[1][0]=r|0),u&&(i=t[0],s=t[1],o&&(i=i[1],s=s[1]),l[0][1]=i,l[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(a=i,i=s,s=a),f[0][1]=i|0,f[1][1]=s|0),e):(t=l||f,o&&(n=t[0][0],r=t[1][0],l||(n=f[0][0],r=f[1][0],o.invert&&(n=o.invert(n),r=o.invert(r)),r<n&&(a=n,n=r,r=a))),u&&(i=t[0][1],s=t[1][1],l||(i=f[0][1],s=f[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(a=i,i=s,s=a))),o&&u?[[n,i],[r,s]]:o?[n,r]:u&&[i,s])},e.clear=function(){return l=null,f[0][0]=f[0][1]=f[1][0]=f[1][1]=0,e},e.empty=function(){return o&&f[0][0]===f[1][0]||u&&f[0][1]===f[1][1]},d3.rebind(e,s,"on")};var uo={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ao=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=o.parentNode;return f?d3.touches(e).filter(function(e){return e.identifier===f})[0]:d3.mouse(e)}function t(){if(!o.parentNode)return i();var t=e(),n=t[0]-c[0],r=t[1]-c[1];h|=n|r,c=t,M(),u({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:r})}function i(){u({type:"dragend"}),h&&(M(),d3.event.target===a&&p.on("click.drag",s,!0)),p.on(f?"touchmove.drag-"+f:"mousemove.drag",null).on(f?"touchend.drag-"+f:"mouseup.drag",null)}function s(){M(),p.on("click.drag",null)}var o=this,u=n.of(o,arguments),a=d3.event.target,f=d3.event.touches&&d3.event.changedTouches[0].identifier,l,c=e(),h=0,p=d3.select(window).on(f?"touchmove.drag-"+f:"mousemove.drag",t).on(f?"touchend.drag-"+f:"mouseup.drag",i,!0);r?(l=r.apply(o,arguments),l=[l.x-c[0],l.y-c[1]]):l=[0,0],f||M(),u({type:"dragstart"})}var n=D(e,"drag","dragstart","dragend"),r=null;return e.origin=function(t){return arguments.length?(r=t,e):r},d3.rebind(e,n,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",o).on("mousewheel.zoom",u).on("mousemove.zoom",a).on("DOMMouseScroll.zoom",u).on("dblclick.zoom",f).on("touchstart.zoom",l).on("touchmove.zoom",c).on("touchend.zoom",l)}function t(e){return[(e[0]-h[0])/d,(e[1]-h[1])/d]}function n(e){return[e[0]*d+h[0],e[1]*d+h[1]]}function r(e){d=Math.max(m[0],Math.min(m[1],e))}function i(e,t){t=n(t),h[0]+=e[0]-t[0],h[1]+=e[1]-t[1]}function s(e){b&&b.domain(y.range().map(function(e){return(e-h[0])/d}).map(y.invert)),E&&E.domain(w.range().map(function(e){return(e-h[1])/d}).map(w.invert)),d3.event.preventDefault(),e({type:"zoom",scale:d,translate:h})}function o(){function e(){f=1,i(d3.mouse(o),c),s(u)}function n(){f&&M(),l.on("mousemove.zoom",null).on("mouseup.zoom",null),f&&d3.event.target===a&&l.on("click.zoom",r,!0)}function r(){M(),l.on("click.zoom",null)}var o=this,u=g.of(o,arguments),a=d3.event.target,f=0,l=d3.select(window).on("mousemove.zoom",e).on("mouseup.zoom",n),c=t(d3.mouse(o));window.focus(),M()}function u(){p||(p=t(d3.mouse(this))),r(Math.pow(2,Un()*.002)*d),i(d3.mouse(this),p),s(g.of(this,arguments))}function a(){p=null}function f(){var e=d3.mouse(this),n=t(e);r(d3.event.shiftKey?d/2:d*2),i(e,n),s(g.of(this,arguments))}function l(){var e=d3.touches(this),n=Date.now();v=d,p={},e.forEach(function(e){p[e.identifier]=t(e)}),M();if(e.length===1){if(n-S<500){var o=e[0],u=t(e[0]);r(d*2),i(o,u),s(g.of(this,arguments))}S=n}}function c(){var e=d3.touches(this),t=e[0],n=p[t.identifier];if(o=e[1]){var o,u=p[o.identifier];t=[(t[0]+o[0])/2,(t[1]+o[1])/2],n=[(n[0]+u[0])/2,(n[1]+u[1])/2],r(d3.event.scale*v)}i(t,n),S=null,s(g.of(this,arguments))}var h=[0,0],p,d=1,v,m=lo,g=D(e,"zoom"),y,b,w,E,S;return e.translate=function(t){return arguments.length?(h=t.map(Number),e):h},e.scale=function(t){return arguments.length?(d=+t,e):d},e.scaleExtent=function(t){return arguments.length?(m=t==null?lo:t.map(Number),e):m},e.x=function(t){return arguments.length?(b=t,y=t.copy(),e):b},e.y=function(t){return arguments.length?(E=t,w=t.copy(),e):E},d3.rebind(e,g,"on")};var fo,lo=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(zn(e[n]));return t}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,d,v,m,g;r=[],i=[],p=0,m=-1;while(++m<o){d=0,g=-1;while(++g<o)d+=s[m][g];n.push(d),h.push(d3.range(o)),p+=d}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*Math.PI-u*o)/p,d=0,m=-1;while(++m<o){v=d,g=-1;while(++g<o){var y=c[m],b=h[y][g],w=s[y][b],E=d,S=d+=w*p;e[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}i[y]={index:y,startAngle:v,endAngle:d,value:(d-v)/p},d+=u}m=-1;while(++m<o){g=m-1;while(++g<o){var x=e[m+"-"+g],T=e[g+"-"+m];(x.value||T.value)&&r.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i,s){if(t.point!==e){var o=t.cx-e.x,u=t.cy-e.y,a=1/Math.sqrt(o*o+u*u);if((i-n)*a<d){var f=t.charge*a*a;return e.px-=o*f,e.py-=u*f,!0}if(t.point&&isFinite(a)){var f=t.pointCharge*a*a;e.px-=o*f,e.py-=u*f}}return!t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,n.resume()}var n={},r=d3.dispatch("start","tick","end"),s=[1,1],o,a,f=.9,l=Gn,c=Yn,h=-30,p=.1,d=.8,v,m=[],g=[],y,b,w;return n.tick=function(){if((a*=.99)<.005)return r.end({type:"end",alpha:a=0}),!0;var t=m.length,n=g.length,i,o,u,l,c,d,v,E,S;for(o=0;o<n;++o){u=g[o],l=u.source,c=u.target,E=c.x-l.x,S=c.y-l.y;if(d=E*E+S*S)d=a*b[o]*((d=Math.sqrt(d))-y[o])/d,E*=d,S*=d,c.x-=E*(v=l.weight/(c.weight+l.weight)),c.y-=S*v,l.x+=E*(v=1-v),l.y+=S*v}if(v=a*p){E=s[0]/2,S=s[1]/2,o=-1;if(v)while(++o<t)u=m[o],u.x+=(E-u.x)*v,u.y+=(S-u.y)*v}if(h){Qn(i=d3.geom.quadtree(m),a,w),o=-1;while(++o<t)(u=m[o]).fixed||i.visit(e(u))}o=-1;while(++o<t)u=m[o],u.fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*f,u.y-=(u.py-(u.py=u.y))*f);r.tick({type:"tick",alpha:a})},n.nodes=function(e){return arguments.length?(m=e,n):m},n.links=function(e){return arguments.length?(g=e,n):g},n.size=function(e){return arguments.length?(s=e,n):s},n.linkDistance=function(e){return arguments.length?(l=u(e),n):l},n.distance=n.linkDistance,n.linkStrength=function(e){return arguments.length?(c=u(e),n):c},n.friction=function(e){return arguments.length?(f=e,n):f},n.charge=function(e){return arguments.length?(h=typeof e=="function"?e:+e,n):h},n.gravity=function(e){return arguments.length?(p=e,n):p},n.theta=function(e){return arguments.length?(d=e,n):d},n.alpha=function(e){return arguments.length?(a?e>0?a=e:a=0:e>0&&(r.start({type:"start",alpha:a=e}),d3.timer(n.tick)),n):a},n.start=function(){function e(e,n){var i=t(r),s=-1,o=i.length,u;while(++s<o)if(!isNaN(u=i[s][e]))return u;return Math.random()*n}function t(){if(!p){p=[];for(i=0;i<o;++i)p[i]=[];for(i=0;i<u;++i){var e=g[i];p[e.source.index].push(e.target),p[e.target.index].push(e.source)}}return p[r]}var r,i,o=m.length,u=g.length,a=s[0],f=s[1],p,d;for(r=0;r<o;++r)(d=m[r]).index=r,d.weight=0;y=[],b=[];for(r=0;r<u;++r)d=g[r],typeof d.source=="number"&&(d.source=m[d.source]),typeof d.target=="number"&&(d.target=m[d.target]),y[r]=l.call(this,d,r),b[r]=c.call(this,d,r),++d.source.weight,++d.target.weight;for(r=0;r<o;++r)d=m[r],isNaN(d.x)&&(d.x=e("x",a)),isNaN(d.y)&&(d.y=e("y",f)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);w=[];if(typeof h=="function")for(r=0;r<o;++r)w[r]=+h.call(this,m[r],r);else for(r=0;r<o;++r)w[r]=h;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){o||(o=d3.behavior.drag().origin(i).on("dragstart",Vn).on("drag",t).on("dragend",$n)),this.on("mouseover.force",Jn).on("mouseout.force",Kn).call(o)},d3.rebind(n,r,"on")},d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u)e(a=s[o],n,f=a.value*r,i),n+=f}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s)r=Math.max(r,t(n[i]))}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},lr(n,r)},d3.layout.pie=function(){function e(s,o){var u=s.map(function(n,r){return+t.call(e,n,r)}),a=+(typeof r=="function"?r.apply(this,arguments):r),f=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(u),l=d3.range(s.length);n!=null&&l.sort(n===co?function(e,t){return u[t]-u[e]}:function(e,t){return n(s[e],s[t])});var c=[];return l.forEach(function(e){var t;c[e]={data:s[e],value:t=u[e],startAngle:a,endAngle:a+=t*f}}),c}var t=Number,n=co,r=0,i=2*Math.PI;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var co={};d3.layout.stack=function(){function e(i,a){var f=i.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t,n){return t.map(function(t,n){return[o.call(e,t,n),u.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,d=f[0].length,v,m,g;for(m=0;m<d;++m){s.call(e,f[0][m],g=h[m],l[0][m][1]);for(v=1;v<p;++v)s.call(e,f[v][m],g+=l[v-1][m][1],l[v][m][1])}return i}var t=i,n=nr,r=rr,s=tr,o=Zn,u=er;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:ho.get(t)||nr,e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:po.get(t)||rr,e):r},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(u=t,e):u},e.out=function(t){return arguments.length?(s=t,e):s},e};var ho=d3.map({"inside-out":function(e){var t=e.length,n,r,i=e.map(ir),s=e.map(sr),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n)r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r));return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":nr}),po=d3.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i=0,s,o,u,a,f,l,c,h,p,d=[];d[0]=h=p=0;for(o=1;o<r;++o){for(s=0,a=0;s<t;++s)a+=e[s][o][1];for(s=0,f=0,c=n[o][0]-n[o-1][0];s<t;++s){for(u=0,l=(e[s][o][1]-e[s][o-1][1])/(2*c);u<s;++u)l+=(e[u][o][1]-e[u][o-1][1])/c;f+=l*e[s][o][1]}d[o]=h-=a?f/a*c:0,h<p&&(p=h)}for(o=0;o<r;++o)d[o]-=p;return d},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:rr});d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,d;while(++s<h)l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0;if(h>0){s=-1;while(++s<c)d=u[s],d>=a[0]&&d<=a[1]&&(l=o[d3.bisect(f,d,1,h)-1],l.y+=p,l.push(e[s]))}return o}var t=!0,n=Number,r=fr,i=ur;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=u(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return ar(e,t)}:u(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o),f=vo?t:{data:t};f.depth=o,u.push(f);if(a&&(c=a.length)){var l=-1,c,h=f.children=[],p=0,d=o+1,v;while(++l<c)v=e(a[l],d,u),v.parent=f,h.push(v),p+=v.value;r&&h.sort(r),s&&(f.value=p)}else s&&(f.value=+s.call(n,t,o)||0);return f}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a)o+=t(i[u],f)}else s&&(o=+s.call(n,vo?e:e.data,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=pr,i=cr,s=hr;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n};var vo=!1;d3.layout.pack=function(){function e(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,Hr(o,function(e){e.r=Math.sqrt(e.value)}),Hr(o,br);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;Hr(o,function(e){e.r+=l}),Hr(o,br),Hr(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return Sr(o,u/2,a/2,1/f),s}var t=d3.layout.hierarchy().sort(vr),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.padding=function(t){return arguments.length?(n=+t,e):n},lr(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0,f,l;Hr(o,function(e){var t=e.children;t&&t.length?(e.x=Nr(t),e.y=Tr(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var c=Cr(o),h=kr(o),p=c.x-n(c,h)/2,d=h.x+n(h,c)/2;return Hr(o,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=Lr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},lr(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o)c=r[h],s(c,f),l=u(c,f,l),f=c;Br(e);var p=.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)o(n[r],t)}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=Or(o),i=Ar(i),o&&i)u=Ar(u),s=Or(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(jr(Fr(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!Or(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!Ar(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];Hr(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=Mr(f,Dr),c=Mr(f,_r),h=Mr(f,Pr),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return Hr(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=Lr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},lr(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,p=Math.min(o.dx,o.dy),d;e(a,o.dx*o.dy/n.value),u.area=0;while((d=a.length)>0)u.push(f=a[d-1]),u.area+=f.area,(h=r(u,p))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,p,o,!1),p=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity);u.length&&(i(u,p,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop())a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*p/n,n/(t*s*p)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy)f=n.dy;while(++i<s)l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=Math.min(n.x+n.dx-o,f?u(l.area/f):0);l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx)f=n.dx;while(++i<s)l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=Math.min(n.y+n.dy-a,f?u(l.area/f):0);l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=Ir,c=!1,h,p=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?Ir(t):qr(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return qr(t,e)}if(!arguments.length)return f;var r;return l=(f=e)==null?Ir:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(p=e,s):p},lr(s,o)},d3.csv=Rr(",","text/csv"),d3.tsv=Rr("	","text/tab-separated-values"),d3.geo={};var mo=Math.PI/180;d3.geo.azimuthal=function(){function e(e){var n=e[0]*mo-s,o=e[1]*mo,f=Math.cos(n),l=Math.sin(n),c=Math.cos(o),h=Math.sin(o),p=t!=="orthographic"?a*h+u*c*f:null,d,v=t==="stereographic"?1/(1+p):t==="gnomonic"?1/p:t==="equidistant"?(d=Math.acos(p),d?d/Math.sin(d):0):t==="equalarea"?Math.sqrt(2/(1+p)):1,m=v*c*l,g=v*(a*c*f-u*h);return[r*m+i[0],r*g+i[1]]}var t="orthographic",n,r=200,i=[480,250],s,o,u,a;return e.invert=function(e){var n=(e[0]-i[0])/r,o=(e[1]-i[1])/r,f=Math.sqrt(n*n+o*o),l=t==="stereographic"?2*Math.atan(f):t==="gnomonic"?Math.atan(f):t==="equidistant"?f:t==="equalarea"?2*Math.asin(.5*f):Math.asin(f),c=Math.sin(l),h=Math.cos(l);return[(s+Math.atan2(n*c,f*u*h+o*a*c))/mo,Math.asin(h*a-(f?o*c*u/f:0))/mo]},e.mode=function(n){return arguments.length?(t=n+"",e):t},e.origin=function(t){return arguments.length?(n=t,s=n[0]*mo,o=n[1]*mo,u=Math.cos(o),a=Math.sin(o),e):n},e.scale=function(t){return arguments.length?(r=+t,e):r},e.translate=function(t){return arguments.length?(i=[+t[0],+t[1]],e):i},e.origin([0,0])},d3.geo.albers=function(){function e(e){var t=u*(mo*e[0]-o),n=Math.sqrt(a-2*u*Math.sin(mo*e[1]))/u;return[i*n*Math.sin(t)+s[0],i*(n*Math.cos(t)-f)+s[1]]}function t(){var t=mo*r[0],i=mo*r[1],s=mo*n[1],l=Math.sin(t),c=Math.cos(t);return o=mo*n[0],u=.5*(l+Math.sin(i)),a=c*c+2*u*l,f=Math.sqrt(a-2*u*Math.sin(s))/u,e}var n=[-98,38],r=[29.5,45.5],i=1e3,s=[480,250],o,u,a,f;return e.invert=function(e){var t=(e[0]-s[0])/i,n=(e[1]-s[1])/i,r=f+n,l=Math.atan2(t,r),c=Math.sqrt(t*t+r*r);return[(o+l/u)/mo,Math.asin((a-c*c*u*u)/(2*u))/mo]},e.origin=function(e){return arguments.length?(n=[+e[0],+e[1]],t()):n},e.parallels=function(e){return arguments.length?(r=[+e[0],+e[1]],t()):r},e.scale=function(t){return arguments.length?(i=+t,e):i},e.translate=function(t){return arguments.length?(s=[+t[0],+t[1]],e):s},t()},d3.geo.albersUsa=function(){function e(e){var s=e[0],o=e[1];return(o>50?n:s<-140?r:o<21?i:t)(e)}var t=d3.geo.albers(),n=d3.geo.albers().origin([-160,60]).parallels([55,65]),r=d3.geo.albers().origin([-160,20]).parallels([8,18]),i=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(s){return arguments.length?(t.scale(s),n.scale(s*.6),r.scale(s),i.scale(s*1.5),e.translate(t.translate())):t.scale()},e.translate=function(s){if(!arguments.length)return t.translate();var o=t.scale()/1e3,u=s[0],a=s[1];return t.translate(s),n.translate([u-400*o,a+170*o]),r.translate([u-190*o,a+200*o]),i.translate([u+580*o,a+430*o]),e},e.scale(t.scale())},d3.geo.bonne=function(){function e(e){var u=e[0]*mo-r,a=e[1]*mo-i;if(s){var f=o+s-a,l=u*Math.cos(a)/f;u=f*Math.sin(l),a=f*Math.cos(l)-o}else u*=Math.cos(a),a*=-1;return[t*u+n[0],t*a+n[1]]}var t=200,n=[480,250],r,i,s,o;return e.invert=function(e){var i=(e[0]-n[0])/t,u=(e[1]-n[1])/t;if(s){var a=o+u,f=Math.sqrt(i*i+a*a);u=o+s-f,i=r+f*Math.atan2(i,a)/Math.cos(u)}else u*=-1,i/=Math.cos(u);return[i/mo,u/mo]},e.parallel=function(t){return arguments.length?(o=1/Math.tan(s=t*mo),e):s/mo},e.origin=function(t){return arguments.length?(r=t[0]*mo,i=t[1]*mo,e):[r/mo,i/mo]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function e(e){var r=e[0]/360,i=-e[1]/360;return[t*r+n[0],t*i+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,-360*i]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.mercator=function(){function e(e){var r=e[0]/360,i=-(Math.log(Math.tan(Math.PI/4+e[1]*mo/2))/mo)/360;return[t*r+n[0],t*Math.max(-0.5,Math.min(.5,i))+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,2*Math.atan(Math.exp(-360*i*mo))/mo-90]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.path=function(){function e(e,t){typeof s=="function"&&(o=zr(s.apply(this,arguments))),f(e);var n=a.length?a.join(""):null;return a=[],n}function t(e){return u(e).join(",")}function n(e){var t=i(e[0]),n=0,r=e.length;while(++n<r)t-=i(e[n]);return t}function r(e){var t=d3.geom.polygon(e[0].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i=r[0],s=r[1],o=n,a=0,f=e.length;while(++a<f)t=d3.geom.polygon(e[a].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i-=r[0],s-=r[1],o-=n;return[i,s,6*o]}function i(e){return Math.abs(d3.geom.polygon(e.map(u)).area())}var s=4.5,o=zr(s),u=d3.geo.albersUsa(),a=[],f=Ur({FeatureCollection:function(e){var t=e.features,n=-1,r=t.length;while(++n<r)a.push(f(t[n].geometry))},Feature:function(e){f(e.geometry)},Point:function(e){a.push("M",t(e.coordinates),o)},MultiPoint:function(e){var n=e.coordinates,r=-1,i=n.length;while(++r<i)a.push("M",t(n[r]),o)},LineString:function(e){var n=e.coordinates,r=-1,i=n.length;a.push("M");while(++r<i)a.push(t(n[r]),"L");a.pop()},MultiLineString:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1,u=s.length,a.push("M");while(++o<u)a.push(t(s[o]),"L");a.pop()}},Polygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1;if((u=s.length-1)>0){a.push("M");while(++o<u)a.push(t(s[o]),"L");a[a.length-1]="Z"}}},MultiPolygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u,f,l,c;while(++r<i){s=n[r],o=-1,u=s.length;while(++o<u){f=s[o],l=-1;if((c=f.length-1)>0){a.push("M");while(++l<c)a.push(t(f[l]),"L");a[a.length-1]="Z"}}}},GeometryCollection:function(e){var t=e.geometries,n=-1,r=t.length;while(++n<r)a.push(f(t[n]))}}),l=e.area=Ur({FeatureCollection:function(e){var t=0,n=e.features,r=-1,i=n.length;while(++r<i)t+=l(n[r]);return t},Feature:function(e){return l(e.geometry)},Polygon:function(e){return n(e.coordinates)},MultiPolygon:function(e){var t=0,r=e.coordinates,i=-1,s=r.length;while(++i<s)t+=n(r[i]);return t},GeometryCollection:function(e){var t=0,n=e.geometries,r=-1,i=n.length;while(++r<i)t+=l(n[r]);return t}},0),c=e.centroid=Ur({Feature:function(e){return c(e.geometry)},Polygon:function(e){var t=r(e.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(e){var t=0,n=e.coordinates,i,s=0,o=0,u=0,a=-1,f=n.length;while(++a<f)i=r(n[a]),s+=i[0],o+=i[1],u+=i[2];return[s/u,o/u]}});return e.projection=function(t){return u=t,e},e.pointRadius=function(t){return typeof t=="function"?s=t:(s=+t,o=zr(s)),e},e},d3.geo.bounds=function(e){var t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;return Wr(e,function(e,s){e<t&&(t=e),e>r&&(r=e),s<n&&(n=s),s>i&&(i=s)}),[[t,n],[r,i]]};var go={Feature:Xr,FeatureCollection:Vr,GeometryCollection:$r,LineString:Jr,MultiLineString:Kr,MultiPoint:Jr,MultiPolygon:Qr,Point:Gr,Polygon:Yr};d3.geo.circle=function(){function e(){}function t(e){return a.distance(e)<u}function n(e){var t=-1,n=e.length,i=[],s,o,f,l,c;while(++t<n)c=a.distance(f=e[t]),c<u?(o&&i.push(ni(o,f)((l-u)/(l-c))),i.push(f),s=o=null):(o=f,!s&&i.length&&(i.push(ni(i[i.length-1],o)((u-l)/(c-l))),s=o)),l=c;return s=e[0],o=i[0],o&&f[0]===s[0]&&f[1]===s[1]&&(f[0]!==o[0]||f[1]!==o[1])&&i.push(o),r(i)}function r(e){var t=0,n=e.length,r,i,s=n?[e[0]]:e,o,u=a.source();while(++t<n){o=a.source(e[t-1])(e[t]).coordinates;for(r=0,i=o.length;++r<i;)s.push(o[r])}return a.source(u),s}var s=[0,0],o=89.99,u=o*mo,a=d3.geo.greatArc().source(s).target(i);e.clip=function(e){return typeof s=="function"&&a.source(s.apply(this,arguments)),f(e)||null};var f=Ur({FeatureCollection:function(e){var t=e.features.map(f).filter(i);return t&&(e=Object.create(e),e.features=t,e)},Feature:function(e){var t=f(e.geometry);return t&&(e=Object.create(e),e.geometry=t,e)},Point:function(e){return t(e.coordinates)&&e},MultiPoint:function(e){var n=e.coordinates.filter(t);return n.length&&{type:e.type,coordinates:n}},LineString:function(e){var t=n(e.coordinates);return t.length&&(e=Object.create(e),e.coordinates=t,e)},MultiLineString:function(e){var t=e.coordinates.map(n).filter(function(e){return e.length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},Polygon:function(e){var t=e.coordinates.map(n);return t[0].length&&(e=Object.create(e),e.coordinates=t,e)},MultiPolygon:function(e){var t=e.coordinates.map(function(e){return e.map(n)}).filter(function(e){return e[0].length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},GeometryCollection:function(e){var t=e.geometries.map(f).filter(i);return t.length&&(e=Object.create(e),e.geometries=t,e)}});return e.origin=function(t){return arguments.length?(s=t,typeof s!="function"&&a.source(s),e):s},e.angle=function(t){return arguments.length?(u=(o=+t)*mo,e):o},d3.rebind(e,a,"precision")},d3.geo.greatArc=function(){function e(){var t=e.distance.apply(this,arguments),r=0,u=s/t,a=[n];while((r+=u)<1)a.push(o(r));return a.push(i),{type:"LineString",coordinates:a}}var t=Zr,n,r=ei,i,s=6*mo,o=ti();return e.distance=function(){return typeof t=="function"&&o.source(n=t.apply(this,arguments)),typeof r=="function"&&o.target(i=r.apply(this,arguments)),o.distance()},e.source=function(r){return arguments.length?(t=r,typeof t!="function"&&o.source(n=t),e):t},e.target=function(t){return arguments.length?(r=t,typeof r!="function"&&o.target(i=r),e):r},e.precision=function(t){return arguments.length?(s=t*mo,e):s/mo},e},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(e,t){var n=t||ri(e),r=[],i=n[0],s=n[1],o=0,u=0,a=NaN,f=NaN,l=0;do l=0,e(i-1,s-1)&&(l+=1),e(i,s-1)&&(l+=2),e(i-1,s)&&(l+=4),e(i,s)&&(l+=8),l===6?(o=f===-1?-1:1,u=0):l===9?(o=0,u=a===1?-1:1):(o=yo[l],u=bo[l]),o!=a&&u!=f&&(r.push([i,s]),a=o,f=u),i+=o,s+=u;while(n[0]!=i||n[1]!=s);return r};var yo=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],bo=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var t=e.length,n=t-1,r=[],i=[],s,o,u=0,a,f,l,c,h,p,d,v;for(s=1;s<t;++s)e[s][1]<e[u][1]?u=s:e[s][1]==e[u][1]&&(u=e[s][0]<e[u][0]?s:u);for(s=0;s<t;++s){if(s===u)continue;f=e[s][1]-e[u][1],a=e[s][0]-e[u][0],r.push({angle:Math.atan2(f,a),index:s})}r.sort(function(e,t){return e.angle-t.angle}),d=r[0].angle,p=r[0].index,h=0;for(s=1;s<n;++s)o=r[s].index,d==r[s].angle?(a=e[p][0]-e[u][0],f=e[p][1]-e[u][1],l=e[o][0]-e[u][0],c=e[o][1]-e[u][1],a*a+f*f>=l*l+c*c?r[s].index=-1:(r[h].index=-1,d=r[s].angle,h=s,p=o)):(d=r[s].angle,h=s,p=o);i.push(u);for(s=0,o=0;s<2;++o)r[o].index!==-1&&(i.push(r[o].index),s++);v=i.length;for(;o<n;++o){if(r[o].index===-1)continue;while(!ii(i[v-2],i[v-1],r[o].index,e))--v;i[v++]=r[o].index}var m=[];for(s=0;s<v;++s)m.push(e[i[s]]);return m},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n)r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return(i-r)*.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o)l=n[s],si(l,u,a)?(si(f,u,a)||t.push(oi(f,l,u,a)),t.push(l)):si(f,u,a)&&t.push(oi(f,l,u,a)),f=l;u=a}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return ui(e,function(e){var n,r,i,s,o,u;e.a===1&&e.b>=0?(n=e.ep.r,r=e.ep.l):(n=e.ep.l,r=e.ep.r),e.a===1?(o=n?n.y:-1e6,i=e.c-e.b*o,u=r?r.y:1e6,s=e.c-e.b*u):(i=n?n.x:-1e6,o=e.c-e.a*i,s=r?r.x:1e6,u=e.c-e.a*s);var a=[i,o],f=[s,u];t[e.region.l.index].push(a,f),t[e.region.r.index].push(a,f)}),t.map(function(t,n){var r=e[n][0],i=e[n][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-r,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,n){return!n||e.angle-t[n-1].angle>1e-10})})};var wo={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return ui(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},d3.geom.quadtree=function(e,t,n,r,i){function s(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var u=e.point;u?Math.abs(u.x-t.x)+Math.abs(u.y-t.y)<.01?o(e,t,n,r,i,s):(e.point=null,o(e,u,n,r,i,s),o(e,t,n,r,i,s)):e.point=t}else o(e,t,n,r,i,s)}function o(e,t,n,r,i,o){var u=(n+i)*.5,a=(r+o)*.5,f=t.x>=u,l=t.y>=a,c=(l<<1)+f;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=ai()),f?n=u:i=u,l?r=a:o=a,s(e,t,n,r,i,o)}var u,a=-1,f=e.length;f&&isNaN(e[0].x)&&(e=e.map(li));if(arguments.length<5)if(arguments.length===3)i=r=n,n=t;else{t=n=Infinity,r=i=-Infinity;while(++a<f)u=e[a],u.x<t&&(t=u.x),u.y<n&&(n=u.y),u.x>r&&(r=u.x),u.y>i&&(i=u.y);var l=r-t,c=i-n;l>c?i=n+l:r=t+c}var h=ai();return h.add=function(e){s(h,e,t,n,r,i)},h.visit=function(e){fi(e,h,t,n,r,i)},e.forEach(h.add),h},d3.time={};var Eo=Date,So=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];ci.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){xo.setUTCDate.apply(this._,arguments)},setDay:function(){xo.setUTCDay.apply(this._,arguments)},setFullYear:function(){xo.setUTCFullYear.apply(this._,arguments)},setHours:function(){xo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){xo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){xo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){xo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){xo.setUTCSeconds.apply(this._,arguments)},setTime:function(){xo.setTime.apply(this._,arguments)}};var xo=Date.prototype,To="%a %b %e %H:%M:%S %Y",No="%m/%d/%y",Co="%H:%M:%S",ko=So,Lo=ko.map(hi),Ao=["January","February","March","April","May","June","July","August","September","October","November","December"],Oo=Ao.map(hi);d3.time.format=function(e){function t(t){var r=[],i=-1,s=0,o,u;while(++i<n)e.charCodeAt(i)==37&&(r.push(e.substring(s,i),(u=Ro[o=e.charAt(++i)])?u(t):o),s=i+1);return r.push(e.substring(s,i)),r.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=pi(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+n.p*12);var i=new Eo;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},t.toString=function(){return e},t};var Mo=d3.format("02d"),_o=d3.format("03d"),Do=d3.format("04d"),Po=d3.format("2d"),Ho=di(ko),Bo=di(Lo),jo=di(Ao),Fo=vi(Ao),Io=di(Oo),qo=vi(Oo),Ro={a:function(e){return Lo[e.getDay()]},A:function(e){return ko[e.getDay()]},b:function(e){return Oo[e.getMonth()]},B:function(e){return Ao[e.getMonth()]},c:d3.time.format(To),d:function(e){return Mo(e.getDate())},e:function(e){return Po(e.getDate())},H:function(e){return Mo(e.getHours())},I:function(e){return Mo(e.getHours()%12||12)},j:function(e){return _o(1+d3.time.dayOfYear(e))},L:function(e){return _o(e.getMilliseconds())},m:function(e){return Mo(e.getMonth()+1)},M:function(e){return Mo(e.getMinutes())},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e){return Mo(e.getSeconds())},U:function(e){return Mo(d3.time.sundayOfYear(e))},w:function(e){return e.getDay()},W:function(e){return Mo(d3.time.mondayOfYear(e))},x:d3.time.format(No),X:d3.time.format(Co),y:function(e){return Mo(e.getFullYear()%100)},Y:function(e){return Do(e.getFullYear()%1e4)},Z:Di,"%":function(e){return"%"}},Uo={a:mi,A:gi,b:yi,B:bi,c:wi,d:ki,e:ki,H:Li,I:Li,L:Mi,m:Ci,M:Ai,p:_i,S:Oi,x:Ei,X:Si,y:Ti,Y:xi},zo=/^\s*\d+/,Wo=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{Eo=ci;var t=new Eo;return t._=e,n(t)}finally{Eo=Date}}var n=d3.time.format(e);return t.parse=function(e){try{Eo=ci;var t=n.parse(e);return t&&t._}finally{Eo=Date}},t.toString=n.toString,t};var Xo=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Pi:Xo,Pi.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Pi.toString=Xo.toString,d3.time.second=Hi(function(e){return new Eo(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Hi(function(e){return new Eo(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Hi(function(e){var t=e.getTimezoneOffset()/60;return new Eo((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Hi(function(e){var t=new Eo(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)},So.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var n=d3.time[e]=Hi(function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});d3.time[e+"s"]=n.range,d3.time[e+"s"].utc=n.utc.range,d3.time[e+"OfYear"]=function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Hi(function(e){return e=d3.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Hi(function(e){return e=d3.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var Vo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$o=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Jo=[[d3.time.format("%Y"),function(e){return!0}],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return e.getDate()!=1}],[d3.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],Ko=d3.scale.linear(),Qo=qi(Jo);$o.year=function(e,t){return Ko.domain(e.map(Ui)).ticks(t).map(Ri)},d3.time.scale=function(){return ji(d3.scale.linear(),$o,Qo)};var Go=$o.map(function(e){return[e[0].utc,e[1]]}),Yo=[[d3.time.format.utc("%Y"),function(e){return!0}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],Zo=qi(Yo);Go.year=function(e,t){return Ko.domain(e.map(Wi)).ticks(t).map(zi)},d3.time.scale.utc=function(){return ji(d3.scale.linear(),Go,Zo)}})();(function(){var e={},t=null,n=!0;typeof AudioContext!="undefined"?t=new AudioContext:typeof webkitAudioContext!="undefined"?t=new webkitAudioContext:n=!1;if(n){var r=typeof t.createGain=="undefined"?t.createGainNode():t.createGain();r.gain.value=1,r.connect(t.destination)}var i=function(){this._volume=1,this._muted=!1,this.usingWebAudio=n};i.prototype={volume:function(t){var i=this;t=parseFloat(t,10);if(t&&t>=0&&t<=1){i._volume=t,n&&(r.gain.value=t);for(var s in e)if(e.hasOwnProperty(s)&&e[s]._webAudio===!1)for(var o=0;o<e[s]._audioNode.length;o++)e[s]._audioNode[o].volume=e[s]._volume*i._volume;return i}return n?r.gain.value:i._volume},mute:function(){var t=this;t._muted=!0,n&&(r.gain.value=0);for(var i in e)if(e.hasOwnProperty(i)&&e[i]._webAudio===!1)for(var s=0;s<e[i]._audioNode.length;s++)e[i]._audioNode[s].volume=0;return t},unmute:function(){var t=this;t._muted=!1,n&&(r.gain.value=t._volume);for(var i in e)if(e.hasOwnProperty(i)&&e[i]._webAudio===!1)for(var s=0;s<e[i]._audioNode.length;s++)e[i]._audioNode[s].volume=e[i]._volume*t._volume;return t}},window.Howler=new i;var s=new Audio,o={mp3:!!s.canPlayType("audio/mpeg;").replace(/^no$/,""),ogg:!!s.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!s.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(s.canPlayType("audio/x-m4a;")||s.canPlayType("audio/aac;")).replace(/^no$/,""),webm:!!s.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")};s=null;var u=window.Howl=function(e){var i=this;i._autoplay=e.autoplay||!1,i._buffer=e.buffer||!1,i._duration=e.duration||0,i._loop=e.loop||!1,i._loaded=!1,i._sprite=e.sprite||{},i._src=e.src||"",i._pos=e.pos||0,i._volume=e.volume||1,i._urls=e.urls||[],i._onload=[e.onload||function(){}],i._onend=[e.onend||function(){}],i._onpause=[e.onpause||function(){}],i._onplay=[e.onplay||function(){}],i._onendTimer=[],i._webAudio=n&&!i._buffer,i._webAudio?(i._gainNode=typeof t.createGain=="undefined"?t.createGainNode():t.createGain(),i._gainNode.gain.value=i._volume,i._gainNode.connect(r)):i._audioNode=[],i.load()};u.prototype={load:function(){var t=this,n=null;for(var r=0;r<t._urls.length;r++){var i=t._urls[r].toLowerCase().match(/.+\.([^?]+)(\?|$)/),s=!1;i=i&&i.length>=2?i[1]:t._urls[r].toLowerCase().match(/data\:audio\/([^?]+);/)[1];switch(i){case"mp3":s=o.mp3;break;case"ogg":s=o.ogg;break;case"wav":s=o.wav;break;case"m4a":s=o.m4a;break;case"weba":s=o.webm}if(s===!0){n=t._urls[r];break}}if(!n)return;t._src=n;if(t._webAudio)a(t,n);else{var u=new Audio;t._audioNode.push(u),u.src=n,u.preload="auto",u.volume=Howler._muted?0:t._volume*Howler.volume(),e[n]=t;var f=function(){t._duration=u.duration,t._loaded=!0,t.on("load"),t._autoplay&&t.play(),u.removeEventListener("canplaythrough",f,!1)};u.addEventListener("canplaythrough",f,!1),u.load()}return t},urls:function(e){var t=this;return e?(t._urls=e,t.stop(),t.load(),t):t._urls},play:function(e){var n=this;if(!n._loaded)return n.on("load",function(){n.play(e)}),n;if(e&&!n._sprite[e])return n;var r=e?n._sprite[e][0]/1e3:n._pos,i=e?n._sprite[e][1]/1e3:n._duration-r,s=Math.round(Date.now()*Math.random())+"",o;return function(){var t={id:s,sprite:e};o=setTimeout(function(){n._loop&&n.stop().play(e),!n._webAudio&&e&&n.pause(t.id,t.timer),n.on("end")},i*1e3),n._onendTimer.push(o),t.timer=n._onendTimer[n._onendTimer.length-1]}(),n._webAudio?(l(n),n._playStart=t.currentTime,typeof n.bufferSource.start=="undefined"?n.bufferSource.noteGrainOn(0,r,i):n.bufferSource.start(0,r,i)):n._inactiveNode(function(t){if(t.readyState!==4)return n._clearEndTimer(o),function(){var r=n,i=e,s=t,o=function(){r.play(i),s.removeEventListener("canplaythrough",o,!1)};s.addEventListener("canplaythrough",o,!1)}(),n;t.id=s,t.currentTime=r,t.play()}),n.on("play"),n},pause:function(e,n){var r=this;if(!r._loaded)return r.on("load",function(){r.pause(e)}),r;r._clearEndTimer(n);if(r._webAudio){if(!r.bufferSource)return r;r._pos+=t.currentTime-r._playStart,r.bufferSource.noteOff(0)}else{var i=e?r._nodeById(e):r._activeNode();i&&(r._pos=i.currentTime,i.pause())}return r.on("pause"),r},stop:function(){var e=this;e._pos=0;if(!e._loaded)return e.on("load",function(){e.stop()}),e;e._clearEndTimer(0);if(e._webAudio){if(!e.bufferSource)return e;typeof e.bufferSource.stop=="undefined"?e.bufferSource.noteOff(0):e.bufferSource.stop(0)}else{var t=e._activeNode();t&&(t.pause(),t.currentTime=0)}return e},mute:function(){var e=this;if(!e._loaded)return e.on("load",function(){e.mute()}),e;if(e._webAudio)e._gainNode.gain.value=0;else{var t=e._activeNode();t&&(t.volume=0)}return e},unmute:function(){var e=this;if(!e._loaded)return e.on("load",function(){e.unmute()}),e;if(e._webAudio)e._gainNode.gain.value=e._volume;else{var t=e._activeNode();t&&(t.volume=e._volume)}return e},volume:function(e){var t=this;e=parseFloat(e,10);if(!t._loaded)return t.on("load",function(){t.volume(e)}),t;if(e>=0&&e<=1){t._volume=e;if(t._webAudio)t._gainNode.gain.value=e;else{var n=t._activeNode();n&&(n.volume=e*Howler.volume())}return t}return t._volume},loop:function(e){var t=this;return typeof e=="boolean"?(t._loop=e,t):t._loop},sprite:function(e){var t=this;return typeof e=="object"?(t._sprite=e,t):t._sprite},pos:function(e){var n=this;if(!n._loaded)return n.on("load",function(){n.pos(e)}),n;if(n._webAudio)return e>=0?(n._pos=e,n.pause().play(),n):n._pos+(t.currentTime-n._playStart);var r=n._activeNode();return r?e>=0?(r.currentTime=e,n):r.currentTime:n},fadeIn:function(e,t,n){var r=this,i=e,s=i/.01,o=t/s;if(!r._loaded)return r.on("load",function(){r.fadeIn(e,t,n)}),r;r.play().volume(0);for(var u=1;u<=s;u++)(function(){var t=Math.round(1e3*(r._volume+.01*u))/1e3,i=e;setTimeout(function(){r.volume(t),t===i&&n&&n()},o*u)})();return r},fadeOut:function(e,t,n){var r=this,i=r._volume-e,s=i/.01,o=t/s;if(!r._loaded)return r.on("load",function(){r.fadeOut(e,t,n)}),r;for(var u=1;u<=s;u++)(function(){var t=Math.round(1e3*(r._volume-.01*u))/1e3,i=e;setTimeout(function(){r.volume(t),t===i&&(n&&n(),r.pause())},o*u)})();return r},_nodeById:function(e){var t=this,n=null;for(var r=0;r<t._audioNode.length;r++)if(t._audioNode[r].id===e){n=t._audioNode[r];break}return n},_activeNode:function(){var e=this,t=null;for(var n=0;n<e._audioNode.length;n++)if(!e._audioNode[n].paused){t=e._audioNode[n];break}return e._drainPool(),t},_inactiveNode:function(e){var t=this,n=null;for(var r=0;r<t._audioNode.length;r++)if(t._audioNode[r].paused&&t._audioNode[r].readyState===4){e(t._audioNode[r]),n=!0;break}t._drainPool();if(n)return;t.load();var i=t._audioNode[t._audioNode.length-1];i.addEventListener("loadedmetadata",function(){e(i)})},_drainPool:function(){var e=this,t=0,n;for(n=0;n<e._audioNode.length;n++)e._audioNode[n].paused&&t++;for(n=0;n<e._audioNode.length;n++){if(t<=5)break;e._audioNode[n].paused&&(t--,e._audioNode.splice(n,1))}},_clearEndTimer:function(e){var t=this,n=t._onendTimer.indexOf(e);n=n>=0?n:0,t._onendTimer[n]&&(clearTimeout(t._onendTimer[n]),t._onendTimer.splice(n,1))},on:function(e,t){var n=this,r=n["_on"+e];if(t)r.push(t);else for(var i=0;i<r.length;i++)r[i].call();return n},off:function(e,t){var n=this,r=n["_on"+e],i=t.toString();for(var s=0;s<r.length;s++)if(i===r[s].toString()){r.splice(s,1);break}return n}};if(n)var a=function(n,r){if(r in e)n._duration=e[r].duration,f(n);else{var i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){t.decodeAudioData(i.response,function(t){t&&(e[r]=t,f(n,t))})},i.onerror=function(){n._webAudio&&(n._buffer=!0,n._webAudio=!1,n._audioNode=[],delete n._gainNode,n.load())},i.send()}},f=function(e,t){e._duration=t?t.duration:e._duration,e._loaded=!0,e.on("load"),e._autoplay&&e.play()},l=function(n){n.bufferSource=t.createBufferSource(),n.bufferSource.buffer=e[n._src],n.bufferSource.connect(n._gainNode),n.bufferSource.loop=n._loop};typeof define=="function"&&define.amd&&(define("Howler",function(){return Howler}),define("Howl",function(){return u}))})();function apprise(e,t,n){var r,i=function(){r=document.activeElement,t&&t.input?$(".aTextbox").focus():h.find("button").first().focus()},s={confirm:!1,verify:!1,input:!1,animate:!1,textOk:"Ok",textCancel:"Cancel",textYes:"Yes",textNo:"No",position:"center"};if(t)for(var o in s)typeof t[o]=="undefined"&&(t[o]=s[o]);var u=$(window).height(),a=$(window).width(),f=$('<div class="appriseOuter"></div>'),l=$('<div class="appriseOverlay" id="aOverlay"></div>'),c=$('<div class="appriseInner"></div>'),h=$('<div class="aButtons"></div>'),p=100;l.css({height:u,width:a}).appendTo("body").fadeIn(100,function(){$(this).css("filter","alpha(opacity=70)")}),f.appendTo("body"),c.append(e).appendTo(f),t&&t.input&&(typeof t["input"]=="string"&&c.append('<div class="aInput"><input type="text" class="aTextbox" t="aTextbox" value="'+t.input+'" /></div>'),typeof t["input"]=="object"?c.append($('<div class="aInput"></div>').append(t.input)):c.append('<div class="aInput"><input type="text" class="aTextbox" t="aTextbox" /></div>')),c.append(h),t?t.confirm||t.input?(h.append('<button value="ok">'+t.textOk+"</button>"),h.append('<button value="cancel">'+t.textCancel+"</button>")):t.verify?(h.append('<button value="ok">'+t.textYes+"</button>"),h.append('<button value="cancel">'+t.textNo+"</button>")):h.append('<button value="ok">'+t.textOk+"</button>"):h.append('<button value="ok">Ok</button>'),f.css("left",($(window).width()-$(".appriseOuter").width())/2+$(window).scrollLeft()+"px");if(t){t.position&&t.position==="center"&&(p=(u-f.height())/2);if(t.animate){var d=t.animate;isNaN(d)&&(d=400),f.css("top","-200px").show().animate({top:p},d,function(){i()})}else f.css("top",p).fadeIn(200,function(){i()})}else f.css("top",p).fadeIn(200,function(){i()});$(document).keydown(function(e){l.is(":visible")&&(e.keyCode==13&&$('.aButtons > button[value="ok"]').click(),e.keyCode==27&&$('.aButtons > button[value="cancel"]').click())});var v=$(".aTextbox").val();v||(v=!1),$(".aTextbox").keyup(function(){v=$(this).val()}),$(".aButtons > button").click(function(){l.remove(),f.remove(),$(r).focus();if(n){$(this).text("");var e=$(this).attr("value");e=="ok"?t?t.input?n(v):n(!0):n(!0):e=="cancel"&&n(!1)}})};require.define("/routes-account.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/remind-me",function(e){$CONTAINER.append(JT["pages-remindme"]())}),e.get("/change-info",function(e){$CONTAINER.append(JT["pages-changeinfo"]())})}}});require.define("/routes-admin.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(t){e("/admin").init();var n=e("/npcs");n.init(),t.get("/admin",function(e){$CONTAINER.append(JT["admin-panel"]({message:"User admin panel."})),$("title").text("{ ::: Civic Seed - Admin Panel ::: }"),$BODY.attr("class","adminPage")}),t.get("/admin/startup",function(e){$CONTAINER.append(JT["admin-startup"]({title:"Startup",bodyClass:"admin startup",nodeEnv:"nodeEnv",message:"Startup admin panel."})),$("title").text("{ ::: Civic Seed - Admin Panel - Startup ::: }"),$BODY.attr("class","adminPage startupPage")}),t.get("/admin/monitor",function(e){ss.rpc("admin.monitor.getInstanceNames",sessionStorage.userId,function(e,t){$CONTAINER.append(JT["admin-monitor"]({instances:t})),$("title").text("{ ::: Civic Seed - Admin Panel - Monitor ::: }"),$BODY.attr("class","adminPage")})}),t.get("/admin/npcs",function(e){ss.rpc("admin.npcs.init",sessionStorage.userId,function(e){if(e){for(var t=0;t<e.length;t++){var r=e[t].index%142,i=Math.floor(e[t].index/142);e[t].x=r,e[t].y=i}console.log(e),$CONTAINER.append(JT["admin-npcs"]({npcs:e})),$("title").text("{ ::: Civic Seed - NPC Panel - Monitor ::: }"),$BODY.attr("class","npcsPage"),n.addSprites()}else console.log("error")})}),t.get("/admin/invitecodes",function(e){$CONTAINER.append(JT["admin-invitecodes"]({title:"Startup",bodyClass:"admin startup",nodeEnv:"nodeEnv",message:"Startup admin panel."}))})}}});require.define("/routes-errors.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/404",function(e){$CONTAINER.append(JT["pages-404"]())}),e.bind("routeNotFound",function(e){e.redirect("/404")})}}});require.define("/routes-main.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/",function(e){$CONTAINER.append(JT["pages-home"]())}),e.get("/about",function(e){$CONTAINER.append(JT["pages-about"]())}),e.get("/contact",function(e){$CONTAINER.append(JT["pages-contactus"]())}),e.get("/game",function(e){$game.enterGame()}),e.get("/introduction",function(e){$CONTAINER.append(JT["pages-introduction"]())})}}});require.define("/routes-middleware.js",function(e,t,n,r,i){var s=["/game"],o=["/admin","/admin/invitecodes","/admin/monitor"],u=["/admin/startup","/admin/npcs"],a=t.exports={loadMiddleware:function(e){e.before(function(e){var t=e.fullPath,n=sessionStorage.getItem("userRole");Davis.previousPath&&Davis.previousPath==="/game"&&sessionStorage.getItem("isPlaying")&&$game.exitGame(),Davis.previousPath=e.fullPath,typeof n!="string"&&(n="non-user"),$CONTAINER.empty().append(JT["partials-navigation"]({fullPath:t}));if(s.indexOf(t)>-1){if(n!=="actor")return e.redirect("/"),!1}else if(o.indexOf(t)>-1){if(n!=="superadmin"&&n!=="admin")return e.redirect("/"),!1}else if(u.indexOf(t)>-1&&n!=="superadmin")return e.redirect("/"),!1})}}});require.define("/routes-profile.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(t){var n=e("/profile");n.init(),t.get("/profiles",function(e){ss.rpc("shared.profiles.getAllProfiles",function(e){$CONTAINER.append(JT["profiles-allprofiles"]({users:e}))})}),t.get("/profiles/:random",function(e){ss.rpc("shared.profiles.getProfileInformation",e.params.random,function(e){e?!e.profileSetup&&sessionStorage.userEmail===e.email?Davis.location.assign("change-info"):$CONTAINER.append(JT["profiles-singleprofile"](e)):console.log("error!")})})}}});require.define("/admin.js",function(e,t,n,r,i){var s,o=t.exports={gameInstances:null,allQuestions:null,allAnswers:null,players:null,init:function(){s=$(document.body),o.setupLoaders(),o.setupInviteCodes(),o.setupMonitor()},setupLoaders:function(){s.on("click","#dataLoaders .btn",function(e){var t=$(this),n=t.data().type;t.removeClass("btn-success"),ss.rpc("admin.startup.loadData",n,function(e){t.addClass("btn-success")})})},setupInviteCodes:function(){s.on("click","#inviteCodesBtn",function(e){var t=$(this);t.removeClass("btn-success");var n=$("#emailList").val().match(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi),r=$("#instanceName").val().trim();if(r&&n){n=n.slice(0,20),emailListLength=n.length;var i=sessionStorage.getItem("userId");ss.rpc("admin.invitecodes.newGameInstance",{instanceName:r,numPlayers:emailListLength,id:i},function(e,i){e?console.log("error with db",e):i?apprise("game name already exists"):ss.rpc("admin.invitecodes.sendInvites",n,r,function(e){console.log(e),t.addClass("btn-success")})})}})},setupMonitor:function(){o.getQuestions(),s.on("click","#players",function(){var e=$(this).attr("data-instance");ss.rpc("admin.monitor.getPlayers",e,function(e,t){t&&(o.players=t,o.showPlayersInfo())})}),s.on("click","#questions",function(){var e=$(this).attr("data-instance");o.showQuestions(e)}),s.on("click","#chat",function(){var e=$(this).attr("data-instance");ss.rpc("admin.monitor.getRecentChat",e,function(e,t){t&&o.showChat(t)})}),s.on("click","#addPlayer",function(){var e=$(this).attr("data-instance");o.showAddPlayerForm(e)}),s.on("click","#startStop",function(){var e=$(this).attr("data-instance");o.addStartStopButton(e)}),s.on("click",".viewAnswers",function(){var e=$(this).attr("data-index");o.showPlayerAnswers(e)}),s.on("click",".stopGameButton",function(){var e=$(this).attr("data-instance");o.toggleGame(e,!1)}),s.on("click",".startGameButton",function(){var e=$(this).attr("data-instance");o.toggleGame(e,!0)}),s.on("click",".deletePlayer",function(){var e=$(this).attr("data-id"),t=$(".input"+e).val();t.indexOf("delete")>-1?o.deletePlayer(e,this):apprise("you must type delete to delete user")}),s.on("click",".allQuestion",function(){var e=$(this).attr("data-npc"),t=$(this).attr("data-instance");o.showQuestionAnswers(e,t,this)}),s.on("click",".addPlayerButton",function(e){e.preventDefault();var t=$("#addPlayerEmail").val().match(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi),n=$(this).attr("data-instance");return t?ss.rpc("admin.invitecodes.getCount",n,function(e){e?ss.rpc("admin.invitecodes.sendInvites",t,n,e,function(e){e?apprise("added successfully"):apprise("error")}):apprise("the game is full")}):apprise("invalid email."),!1})},showPlayersInfo:function(){var e="";for(var t=0;t<o.players.length;t++)e+='<div class="player'+o.players[t]._id+'"><h2>'+o.players[t].firstName+" "+o.players[t].lastName+"</h2>",e+="<p>Profile unlocked: "+o.players[t].profileUnlocked+"</p>",e+="<p>Is playing now: "+o.players[t].isPlaying+"</p>",e+="<p>Time played: "+Math.floor(o.players[t].game.playingTime/60)+" min.</p>",e+="<p>Resources collected: "+o.players[t].game.resourcesDiscovered+" / 42  <button data-index="+t+' class="viewAnswers btn btn-success" type="button">View Answers</button></p>',e+='<p>Enter "delete" to remove user permanently: <input class="input'+o.players[t]._id+'"></input><button data-id='+o.players[t]._id+' class="btn btn-danger deletePlayer" type="button">Delete User</button></p></div>';$(".output").empty().append(e)},showChat:function(e){var t='<h2>Recent Chat History</h2><div class="allChat">';if(e.length===0)t+="<p>No one has spoken yet.</p>";else for(var n=0;n<e.length;n++){var r=e[n].when.substring(0,10),i=e[n].when.substring(11,20);t+='<p><span class="time">['+r+" || "+i+']</span><span class="who"> '+e[n].who+' </span><span class="what">'+e[n].what+"</span></p>"}t+="</div>",$(".output").empty().append(t)},showAddPlayerForm:function(e){var t='<h2>Add Player</h2><form id="addPlayerForm"><input placeholder="email address" id="addPlayerEmail"></input></form><p><button data-instance="'+e+'"class="btn btn-success addPlayerButton" type="button">Add Player</button></p>';$(".output").empty().append(t)},addStartStopButton:function(e){var t='<h2>Make the game active or inactive:</h2><p><button data-instance="'+e+'"class="btn btn-success startGameButton" type="button">Start Game</button></p><p><button data-instance="'+e+'"class="btn btn-warning stopGameButton" type="button">Stop Game</button></p>';$(".output").empty().append(t)},getQuestions:function(){ss.rpc("admin.monitor.init",function(e,t){t&&(o.allQuestions=t)})},showPlayerAnswers:function(e){var t=o.players[e].game.resources,n=o.allQuestions.length,r="<h2>"+o.players[e].firstName+" "+o.players[e].lastName+"</h2>";for(var i in t){var s=parseInt(i,10),u=0,a=!1,f=!1;while(!a)o.allQuestions[u].index===s&&(a=!0,o.allQuestions[u].resource.questionType==="open"&&(f=!0,r+='<p class="question level'+o.allQuestions[u].level+'">Q: '+o.allQuestions[u].resource.question+"</p>")),u++,u>=n&&(a=!0);f&&(r+='<div class="answer"><p>A: '+t[i].answers[0]+'</p><div class="extras">',t[i].madePublic&&(r+='<i class="icon-unlock icon-large"></i>'),t[i].seeded&&(r+='<i class="icon-thumbs-up icon-large"></i> '+t[i].seeded.length),r+="</div></div>")}$(".output").empty().append(r)},deletePlayer:function(e){ss.rpc("admin.monitor.deletePlayer",e,function(t){if(t)console.log(t);else{var n=".player"+e;$(n).remove()}})},toggleGame:function(e,t){ss.rpc("admin.monitor.toggleGame",e,t,function(e){e?apprise("error switching game"):t?apprise("the game is now active"):apprise("the game is now inactive")})},showQuestions:function(e){console.log(o.allQuestions);var t="<h2>All Open-Ended Questions</h2>";for(var n=0;n<o.allQuestions.length;n++)o.allQuestions[n].resource.questionType==="open"&&(t+='<div class="allQuestion" data-instance="'+e+'" data-npc="'+o.allQuestions[n].index+'">',t+='<p data-npc="'+o.allQuestions[n].index+'" class="mainQ level'+o.allQuestions[n].level+'">'+o.allQuestions[n].resource.question+"</p></div>");o.getAllAnswers(e),$(".output").empty().append(t)},getAllAnswers:function(e){ss.rpc("admin.monitor.getInstanceAnswers",e,function(e,t){t?o.allAnswers=t.resourceResponses:o.allAnswers=[]})},showQuestionAnswers:function(e,t,n){$(".allQuestion .allPlayerAnswers").remove();var r="",i=!1,s=parseInt(e,10);for(var u=0;u<o.allAnswers.length;u++)o.allAnswers[u].npc===s&&(i=!0,r+='<p class="allPlayerAnswers"><span class="subWho">'+o.allAnswers[u].name+": </span>",r+='<span class="subAnswer">'+o.allAnswers[u].answer+"</span></p>");i||(r+='<p class="allPlayerAnswers">There are no answers for this question yet.</p>'),$(n).append(r)}}});require.define("/npcs.js",function(e,t,n,r,i){var s,o=null,u=t.exports={init:function(){s=$(document.body),u.setup(),u.loadSprites()},setup:function(){s.on("click",".levelFilter p",function(){var e=parseInt($(this).text(),10);$(this).toggleClass("current");var t=$(this).hasClass("current"),n=".level"+(e-1);t?$(n).show():$(n).hide()}),s.on("click",".saveChanges",function(){var e=parseInt($(this).attr("data-id"),10);u.saveChanges(e)}),s.on("click",".deleteNpc",function(){var e=parseInt($(this).attr("data-id"),10);u.deleteNpc(e)}),s.on("click",".spriteUp",function(){var e=$(this).parentsUntil(".npcs"),t=$(e[e.length-1]),n=t.attr("data-sprite"),r=$(e[1]);if(n>0){n--;var i=n*-64,s="0 "+i+"px";r.css({"background-position":s}),t.attr("data-sprite",n)}}),s.on("click",".spriteDown",function(){var e=$(this).parentsUntil(".npcs"),t=$(e[e.length-1]),n=t.attr("data-sprite"),r=$(e[1]);if(n<51){n++;var i=n*-64,s="0 "+i+"px";r.css({"background-position":s}),t.attr("data-sprite",n)}}),s.on("click",".viewResource",function(){var e=$(this).parentsUntil(".npc"),t=e.find(".url"),n="/articles/"+$(t).val()+".html";$(".article").empty().load(n,function(){$(".buffer").show(),$(this).show()})}),s.on("click",".addNpc",function(){var e=$(".npcTemplate .npc").clone();$(e).insertBefore(".addDiv")}),s.on("click",".article, .buffer",function(){$(".article, .buffer").hide()}),s.on("change",'input[type="checkbox"]',function(){var e=this.checked?!0:!1;parents=$(this).parentsUntil(".npcs"),npcParent=$(parents[parents.length-1]),e?($(npcParent).find(".resource").show(),$(npcParent).find(".prompts").show(),$(npcParent).find(".smalltalk").hide()):($(npcParent).find(".resource").hide(),$(npcParent).find(".prompts").hide(),$(npcParent).find(".smalltalk").show())}),s.on("change",'input[type="radio"]',function(){var e=$(this).val(),t=$(this).parentsUntil(".npcs"),n=$(t[t.length-1]);$(n).find(".questionOptions").hide(),e==="open"?$(n).find(".requiredDiv").show():(e==="multiple"&&$(n).find(".possibleDiv").show(),$(n).find(".answerDiv").show())})},loadSprites:function(){o=new Image,o.src=CivicSeed.CLOUD_PATH+"/img/game/npcs.png",o.onload=function(){}},addSprites:function(){var e=$(".npc");url="url("+CivicSeed.CLOUD_PATH+"/img/admin/npcs.png"+")",e.each(function(e){var t=$(this).attr("data-sprite"),n=t*-64,r="0 "+n+"px",i=$(this).find(".bg");i.css({"background-image":url,"background-repeat":"no-repeat","background-position":r})})},saveChanges:function(e){var t=$(".npcs").find(".npc"+e);informationAreas=t.find(".information textarea"),resourceAreas=t.find(".resource textarea"),promptAreas=t.find(".prompts textarea"),smalltalkAreas=t.find(".smalltalk textarea"),holding=t.find(".information input")[0].checked,questionType=t.find(".resource input:checked").val(),sprite=parseInt(t.attr("data-sprite"),10),updates={id:e,isHolding:holding,resource:{url:null,shape:null,questionType:questionType,answer:null,question:null,possibleAnswers:[],feedbackRight:null,feedbackWrong:null},dependsOn:[],dialog:{prompts:[],smalltalk:[]},level:null,sprite:sprite,index:null,name:null};var n,r;informationAreas.each(function(e){var t=$(this).attr("data-area"),i=this.value;t==="name"?updates.name=i:t==="level"?updates.level=parseInt(i,10)-1:t==="x"?n=parseInt(i,10):t==="y"&&(r=parseInt(i,10))}),updates.index=r*142+n,resourceAreas.each(function(e){var t=$(this).attr("data-area"),n=this.value;t==="url"?updates.resource.url=n:t==="shape"?updates.resource.shape=n:t==="question"?updates.resource.question=n:t==="possibleAnswers"?updates.resource.possibleAnswers.push(n):t==="answer"?updates.resource.answer=n:t==="requiredLength"?updates.resource.requiredlength=parseInt(n,10):t==="dependsOn"?n.length<1&&(updates.dependsOn[0]=parseInt(n,10)):t==="feedbackRight"?updates.resource.feedbackRight=n:t==="feedbackWrong"&&(updates.resource.feedbackWrong=n)}),promptAreas.each(function(e){var t=$(this).attr("data-area"),n=this.value;t==="prompt"&&updates.dialog.prompts.push(n)}),smalltalkAreas.each(function(e){var t=$(this).attr("data-area"),n=this.value;t==="smalltalk"&&updates.dialog.smalltalk.push(n)});if(e<0){var i=0;$(".saveChanges").each(function(e){var t=parseInt($(this).data("id"),10);t>i&&(i=t)}),i++,updates.id=i;var s="level"+updates.level,o="npc"+updates.id;t.removeClass().addClass("npc").addClass(s).addClass(o);var u=t.find(".saveChanges"),a=t.find(".deleteNpc");$(u).attr("data-id",updates.id),$(a).attr("data-id",updates.id),ss.rpc("admin.npcs.addNpc",updates,function(e){if(e)console.log(e);else{var n=t.find(".saveChanges");$(n).addClass("justSaved"),setTimeout(function(){$(n).removeClass("justSaved")},1e3)}})}else ss.rpc("admin.npcs.updateInformation",updates,function(e){if(e)apprise(e);else{var n=t.find(".saveChanges"),r="level"+updates.level,i="npc"+updates.id;t.removeClass().addClass("npc").addClass(r).addClass(i),$(n).addClass("justSaved"),setTimeout(function(){$(n).removeClass("justSaved")},1e3)}})},deleteNpc:function(e){var t=prompt('please type "delete" to permanently remove the npc.');if(t==="delete"){var n=$(".npc"+e);e<0?n.fadeOut(function(){this.remove()}):ss.rpc("admin.npcs.deleteNpc",e,function(e,t){e?console.log(e):n.fadeOut(function(){this.remove()})})}}}});require.define("/profile.js",function(e,t,n,r,i){var s,o=t.exports={init:function(){s=$(document.body),s.on("click",".saveProfileChanges",function(){var e=[],t=$(".resumeText");$.each(t,function(t,n){var r=$(n).text();e.push(r)});var n={id:sessionStorage.getItem("userId"),resume:e};ss.rpc("shared.profiles.updateResume",n,function(e){e&&apprise("changes saved")})}),s.on("click",".profileToggle",function(){var e=$(this).attr("data-public"),t,n,r;e==="false"||!e?(e="true",t=!0,n="your profile is public",r="icon-unlock icon-4x"):(e="false",t=!1,n="your profile is private",r="icon-lock icon-4x"),$(this).attr("data-public",e);var i=$(this).find("p");$(i).text(n);var s=$(this).find("i");$(s).removeClass().addClass(r);var o={id:sessionStorage.getItem("userId"),changeTo:t};ss.rpc("shared.profiles.setPublic",o,function(e){})}),s.on("click",".feedback",function(){var e=$(this).find(".row");$(e).toggleClass("hideth")})}}});require.define("/account.js",function(e,t,n,r,i){var s,o=function(e,t){e>0?($(".appriseOuter .countdown").html(e),e-=1,s=setTimeout(function(){o(e,t)},1e3)):(clearTimeout(s),$(".appriseOuter .countdown").html(e),t())},u=function(e){$(".appriseOverlay").remove(),$(".appriseOuter").remove(),console.log("Booting THIS user and allowing OTHER USER.",e),$game.exitGame(function(){a.deAuthenticate(function(t){ss.rpc("shared.account.approveNewSession",e)})})},a=t.exports={accountHandlers:function(){var e=$(document.body);e.on("submit","#loginForm",function(){var e=document.getElementById("username").value,t=document.getElementById("password").value;return a.authenticate(e,t),!1}),e.on("click",".signOut",function(){return sessionStorage.isPlaying==="true"?$game.exitGame(function(){a.deAuthenticate()}):a.deAuthenticate(),!1}),e.on("submit","#remindMeForm",function(){var e=document.getElementById("username").value;return ss.rpc("shared.account.remindMeMyPassword",e,function(e){e?$("#message").removeClass("error").text("A reminder email was successfully sent to you! ✔"):$("#message").addClass("error").text("There was an error. Please enter the correct email.")}),!1}),e.on("submit","#contactUs",function(){var e=document.getElementById("username").value,t=document.getElementById("problem").value;return ss.rpc("shared.account.sendProblem",e,t,function(e){e?$("#message").removeClass("error").text("Thanks! We'll get on it right away."):$("#message").addClass("error").text("There was an error. Email civicseed@gmail.com directly please.")}),!1}),e.on("submit","#changeInfoForm",function(){var e=document.getElementById("firstname").value.trim(),t=document.getElementById("lastname").value.trim(),n=document.getElementById("school").value.trim(),r=/^[a-zA-Z]*$/.test(e),i=/^[a-zA-Z]*$/.test(t),s={first:e,last:t,school:n};return r&&i?ss.rpc("shared.account.changeInfo",s,function(e){e?(sessionStorage.setItem("userFirstName",e.firstName),sessionStorage.setItem("userLastName",e.lastName),Davis.location.assign("/introduction")):$("#message").addClass("error").text("There was an error. Please panic.")}):apprise("only letters and no spaces please."),!1}),e.on("click","#startGame",function(){ss.rpc("shared.account.startGame")}),ss.event.on("verifyGameStatus",function(e){var t;sessionStorage.getItem("isPlaying")?(t='Are you still there? Signing out in <strong class="countdown">'+e.countdown+"</strong> seconds.",apprise(t,{verify:!0,textNo:"Sign Out"},function(t){clearTimeout(s),t?(console.log("Okay! Stay active!",e.userId),ss.rpc("shared.account.denyNewSession",{userId:e.userId,profileLink:e.profileLink})):u(e.userId)}),o(e.countdown,function(){u(e.userId)})):(t='There is another active game session matching your credentials. 					Please wait while we check the session. 					This may take a few seconds (<strong class="countdown">'+e.countdown+'</strong>).					<br><br><span style="display:block;font-size:11px;text-align:center;">(If you think there is a problem, 					please contact the website administrator.)</span>',apprise(t),o(e.countdown+5,function(){$(".appriseOverlay").remove(),$(".appriseOuter").remove(),ss.rpc("shared.account.setActiveSessionId",e.userId),sessionStorage.setItem("isPlaying",!0),$game.kickOffGame()}))}),ss.event.on("inactiveGameRedirect",function(e){Davis.location.assign("/profiles/"+e.profileLink)}),ss.event.on("denyNewSession",function(e){Davis.location.current()==="/game"&&(clearTimeout(s),sessionStorage.getItem("isPlaying")||(Davis.location.assign("/profiles/"+e.profileLink),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("Game access denied. 						There is another session currently accessing your account.<br>						Reasons for this may be that you have given your username and password 						to someone else or you have left another computer open running the game.						Please contact the administrator of this site if you 						think something is wrong.")))}),ss.event.on("approveNewSession",function(e){clearTimeout(s),Davis.location.current()==="/game"&&(ss.rpc("shared.account.setActiveSessionId",e),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),sessionStorage.setItem("isPlaying",!0),$game.kickOffGame())})},authenticate:function(e,t){ss.rpc("shared.account.authenticate",e,t,function(e){var t;e.status?(t=e.session,sessionStorage.setItem("userId",t.id),sessionStorage.setItem("userFirstName",t.firstName),sessionStorage.setItem("userLastName",t.lastName),sessionStorage.setItem("userEmail",t.email),sessionStorage.setItem("userRole",t.role),sessionStorage.setItem("profileLink",t.profileLink),t.role==="superadmin"||t.role==="admin"?Davis.location.assign("/admin"):t.profileSetup?t.gameStarted?Davis.location.assign("/profiles/"+t.profileLink):Davis.location.assign("/introduction"):Davis.location.assign("/change-info")):apprise(e.reason)})},deAuthenticate:function(e){ss.rpc("shared.account.deAuthenticate",function(t){sessionStorage.clear(),Davis.location.assign("/"),typeof e=="function"&&e(t)})},getUserSession:function(e){ss.rpc("shared.account.getUserSession",function(t){t&&e(t)})}}});require.define("/audio.js",function(e,t,n,r,i){var s=[],o=null,u=null,a=null,f=-1,l=-1,c=8,h=null,p="welcome...",d=0,v=CivicSeed.CLOUD_PATH+"/audio/music/",m=CivicSeed.CLOUD_PATH+"/audio/fx/",g=!1,y=null,b=[{sound:"stream",locations:[{x:30,y:10},{x:30,y:50},{x:30,y:90},{x:30,y:130},{x:30,y:170}],prox:{x:10,y:10}},{sound:"wind",locations:[{x:15,y:8},{x:60,y:50}],prox:{x:20,y:15}},{sound:"chatter",locations:[{x:100,y:30}],prox:{x:20,y:20}},{sound:"waves",locations:[{x:10,y:80}],prox:{x:20,y:20}}],w=[{location:{x:35,y:30},sounds:["forest1","forest2","forest3","bird1","bird2","bird3"],prox:{x:35,y:30},chance:.2},{location:{x:105,y:30},sounds:["churchBells","townBells","chatter","bird2","bird3"],prox:{x:20,y:20},chance:.1},{location:{x:105,y:90},sounds:["chickens","sheep1","sheep2","horse","bird3"],prox:{x:35,y:30},chance:.15},{location:{x:35,y:90},sounds:["portBells","foghorn","bird2"],prox:{x:25,y:20},chance:.1}],E=null,S=null,x=function(e){return e&&"_webAudio"in e},T=$game.$audio={ready:!1,isMuted:!1,init:function(e){CivicSeed.ENVIRONMENT!=="development"&&(y=CivicSeed.version);var t=$game.$player.getPosition(),n=T.whichTrack(t.x,t.y);n===-1&&(n=4),T.loadTrack(n);var r=function(){T.ready?e():setTimeout(r,30)};r()},resetInit:function(){s=[],o=null,u=null,a=null,f=-1,l=-1,h=null,p="welcome...",d=0,g=!1,y=null,E=null,S=null,$game.$audio.ready=!1,$game.$audio.isMuted=!1},loadTrack:function(e){var t=v+e+".mp3?VERSION=",n=v+e+".ogg?VERSION=";y?(t+=y,n+=y):(t+=Math.round(Math.random(1)*1e9),n+=Math.round(Math.random(1)*1e9));var r=!0;$game.$player.currentLevel>3&&$game.bossModeUnlocked&&(r=!1),s[e]=new Howl({urls:[t,n],autoplay:r,loop:!0,volume:.2,buffer:!0}),T.loadOtherTrack(0,e),T.loadTriggerFx(),f=e},loadOtherTrack:function(e,t){if(e!==t){var n=v+e+".mp3?VERSION=",r=v+e+".ogg?VERSION=";y?(n+=y,r+=y):(n+=Math.round(Math.random(1)*1e9),r+=Math.round(Math.random(1)*1e9)),s[e]=new Howl({urls:[n,r],autoplay:!1,loop:!0,volume:0,buffer:!0}),e++,e!==c&&T.loadOtherTrack(e,t)}else e++,e!==c&&T.loadOtherTrack(e,t)},loadTriggerFx:function(){var e=v+"triggers.mp3?VERSION=",t=v+"triggers.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),o=new Howl({urls:[e,t],sprite:{chatSend:[0,500],chatReceive:[1e3,1300],npcBubble:[3e3,300],windowShow:[4e3,400],seedDrop:[5e3,500],riddleDrop1:[6e3,700],riddleDrop2:[7e3,700],riddleDrop3:[8e3,700],riddleDrop4:[9e3,700],resourceRight:[1e4,500],resourceWrong:[11e3,700],puzzleRight:[12e3,1200],puzzleWrong:[14e3,700],pieceSelect:[15e3,300],pieceDrop:[16e3,200]},volume:.4,onload:function(){T.loadEnvironmentLoopFx()}})},loadEnvironmentLoopFx:function(){var e=v+"environmentloop.mp3?VERSION=",t=v+"environmentloop.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),u=new Howl({urls:[e,t],sprite:{stream:[0,5010],chatter:[6e3,12025],wave:[19e3,16500],wind:[36e3,14350]},loop:!0,onend:function(){T.checkLoopExit()},volume:.1,onload:function(){T.loadEnvironmentOnceFx()}})},loadEnvironmentOnceFx:function(){var e=v+"environmentonce.mp3?VERSION=",t=v+"environmentonce.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),a=new Howl({urls:[e,t],sprite:{neo:[0,1520],bigger:[2e3,5300],horse:[8e3,11e3],sheep1:[11e3,1600],sheep2:[13e3,1500],chickens:[15e3,4400],forest1:[2e4,1e3],forest2:[21e3,1600],portBells:[23e3,4400],churhBells:[28e3,3150],townBells:[32e3,2400],bird1:[35e3,700],bird2:[36e3,500],bird3:[37e3,900],foghorn:[38e3,4300],chatter:[43e3,5500],forest3:[49e3,2700]},volume:.3,onend:function(){},onload:function(){T.ready=!0}})},playTriggerFx:function(e){o.play(e)},playEnvironmentLoopFx:function(e){u.play(e)},playEnvironmentOnceFx:function(e){var t=Math.random()*2e3;setTimeout(function(){a.play(e)},t)},update:function(e,t){S={x:e,y:t};var n=T.whichTrack(e,t);s[n]._loaded&&n!==f&&!g&&(T.switchTrack(n),$game.statusUpdate({message:p,input:"status",screen:!0,log:!1})),E||T.checkEnvironmentLoopFx(n),T.checkEnvironmentOnceFx(n)},checkEnvironmentLoopFx:function(){var e=b.length,t=0;while(t<e){var n=b[t],r=n.locations.length,i=0;while(i<r){var s=T.getProximity(n.locations[i],n.prox);s&&(E=n,T.playEnvironmentLoopFx(n.sound),i=r,t=e),i++}t++}},checkEnvironmentOnceFx:function(){var e=w.length,t=0;while(t<e){var n=w[t],r=T.getProximity(n.location,n.prox);if(r){var i=Math.random();if(i<n.chance){var s=Math.floor(i/n.chance*n.sounds.length);T.playEnvironmentOnceFx(n.sounds[s]),t=e}}t++}},getProximity:function(e,t){var n=Math.abs(S.x-e.x),r=Math.abs(S.y-e.y);return n<t.x&&r<t.y?!0:!1},checkLoopExit:function(){var e=E.locations.length,t=0,n=!1;while(t<e){var r=T.getProximity(E.locations[t],E.prox);r&&(n=!0,t=e),t++}n||(u.pause(E.sound),E=null)},switchTrack:function(e){g=!0,l=f,f=e;if(l!==f){s[l].fadeOut(0,1e3,function(){s[l].pause()});var t=T.isMute?0:.2;s[f].fadeIn(t,3e3,function(e){g=!1})}},whichTrack:function(e,t){var n=e-($game.TOTAL_WIDTH-4)/2,r=t-($game.TOTAL_HEIGHT+8)/2,i=null,s=Math.abs(n),o=Math.abs(r);return e>=57&&e<=84&&t>=66&&t<=78?(i=5,p="entering the botanist's garden"):n>0&&r>0?(i=2,p="entering the ranch"):n>0&&r<0?(i=1,p="entering the town"):n<0&&r<0?(i=0,p="entering the forest"):n<0&&r>0?(i=3,p="entering the port"):(i=f,p="you are on the equator"),i},toggleMute:function(){return T.isMute=T.isMute?!1:!0,T.isMute?(s[f].volume(0),u.volume(0),a.volume(0),o.volume(0)):(s[f].volume(.2),u.volume(.1),a.volume(.3),o.volume(.4)),T.isMute},fadeLow:function(){T.isMute||(s[f].volume(.05),u.volume(.03))},fadeHi:function(){T.isMute||(s[f].volume(.2),u.volume(.2))},stopAll:function(){x(s[f])&&s[f].stop(),x(u)&&u.stop()}}});require.define("/boss.js",function(e,t,n,r,s){function B(){l=$("body"),c=$(".bossArea"),h=$(".bossArea .content"),p=$(".bossArea .buttons"),d=$(".bossHud .seedButton"),v=$(".bossHud .seedButton .hudCount"),m=$(".bossHud .clock"),g=$(".bossHud .score span")}function j(){$game.$boss.isShowing=!0,h.empty();var e="";if(o===0)e='<div class="videoFrame"><iframe src="//player.vimeo.com/video/74144898" width="600" height="337" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>',h.append(e);else if(o===1)ss.rpc("game.player.getRandomResumes",{instanceName:$game.$player.instanceName},function(t){if(t.length>0){u=F(t),e="<p class=\"dialog\"><span>Botanist:</span>  To find the charging modules, you will need to use my SPECIAL SEEDS. But... the seeds aren't finished yet. You'll need to add the last ingredient. Please read what your fellow players have said and provide feedback. This will help them improve their civic resumes. Review all four to receive your SPECIAL SEEDS!</p>";for(var n=0;n<u.length;n++){var r=$game.$botanist.getLevelQuestion(n);e+='<p class="resumeQuestion">Q: '+r+"</p>",e+='<p class="resumeAnswer"><span>A random peer said: </span> '+u[n].answer+"</p>",e+="<p>Do you have any feedback for his or her response? Enter it below.</p><textarea></textarea>"}h.append(e)}else console.log("error")});else if(o===2){var t=CivicSeed.CLOUD_PATH+"/img/game/mini_lab.jpg",n=CivicSeed.CLOUD_PATH+"/img/game/charger.png",r=CivicSeed.CLOUD_PATH+"/img/game/thing1.png",i=CivicSeed.CLOUD_PATH+"/img/game/thing2.png",s=CivicSeed.CLOUD_PATH+"/img/game/thing3.png",a=CivicSeed.CLOUD_PATH+"/img/game/thing4.png";e='<p class="dialog"><span>Botanist:</span> Thanks! You got 20 special seeds.</p>',e+='<p class="detailedInstructions"><img class="minilab" src="'+t+'"> This is the basement of my lab. The CHARGING MODULES <img src="'+n+"\"> are hidden somwhere here.  To find the charging modules, you'll need to use the SPECIAL SEEDS  you earned.  These special seeds can detect and reveal the charging modules. Whenver you plant one, the color bursts will be DARKER the CLOSER it is to a charging module. It will help guide the way!</p>",e+='<p class="detailedInstructions">Once you reveal a charging module, you have to WALK OVER TO IT, and disable it by hand. Find all four to shut down the robot!  You might also find some of my other inventions down here. These can give you more seeds <img src="'+r+'"> , or more time <img src="'+i+'"> . Watch out for the red potion <img src="'+s+'">  which can erase your progress, or the watch <img src="'+a+"\">  that speeds up the timer. If you run out seeds, or run out of time, you'll have to try again.</p>",$(".bossArea .bossButton").text("Ready?"),h.append(e)}else o===3?(e='<p class="dialog"><span>Botanist:</span> You failed to defeat the robot. Why don\'t you try again?</p>',$(".bossArea .bossButton").text("Play Again").css("margin-top","50px"),h.append(e)):o===4&&ss.rpc("game.player.unlockProfile",$game.$player.id,function(t){t?console.log("error"):(e='<p class="dialog"><span>Botanist:</span> Congratulations, you defeated the robot!</p>',e+='<p class="hoorayVideo"><iframe src="//player.vimeo.com/video/74131828" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></p>',$(".bossArea .bossButton").html('<a href="/profiles/'+sessionStorage.profileLink+'">Unlock Profile</a>'),h.append(e))})}function F(e){var t=4,n=0,r=e.length,i=[],s=function(t){var n=!1,i;while(!n){var s=Math.floor(Math.random()*r);i=e[s],i._id!==$game.$player.id&&(n=!0,i.game.resume[t]||(n=!1))}return i};while(n<t){var o=s(n),u={id:o._id,answer:o.game.resume[n]};i.push(u),n++}return i}function I(){var e=[];$(".bossArea textarea").each(function(t){var n=this.value;e.push({comment:n,id:u[t].id})}),ss.rpc("game.player.resumeFeedback",e)}function q(){var e=Math.floor(Math.random()*$game.VIEWPORT_WIDTH),t=Math.floor(Math.random()*$game.VIEWPORT_HEIGHT);a.x=e,a.y=t,a.revealed=!1,b++,z(),f[e][t].charger=0,f[e][t].item=-1}function R(){f=[$game.VIEWPORT_WIDTH];var e=$game.VIEWPORT_WIDTH;while(--e>=0){f[e]=[$game.VIEWPORT_HEIGHT];var t=$game.VIEWPORT_HEIGHT;while(--t>=0){var n=Z();f[e][t]={item:n,itemRevealed:!1}}}}function U(){var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0)f[e][t].itemRevealed=!1}}function z(){var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0){var n=W({x:e,y:t});f[e][t].distance=n,f[e][t].charger=-1}}}function W(e){var t=Math.abs(e.x-a.x)+Math.abs(e.y-a.y);return t}function X(){$game.$renderer.clearBossLevel(),H=$game.$player.getTilesColored(),g.text(H),T=(new Date).getTime(),N=0,C="0.0",L=!1,A=0,k=90,O=1,E=20,b=0,S=0,q(),$(".bossHud .regularSeedButton .hudCount").text(E),setTimeout(V,100),$game.$audio.switchTrack(7)}function V(){N+=100,A+=100*O,C=k-Math.floor(A/1e3);var e=(new Date).getTime()-T-N;m.text(C),C<=0?Q():L||setTimeout(V,100-e)}function J(){(!a.revealed||b<y)&&Q()}function K(){H+=50,g.text(H),U();var e='<div class="cutSceneBg"></div>';$(".gameboard").append(e);var t=P[b-1];$(".cutSceneBg").append(t),$(".cutSceneBg").fadeIn("fast"),$(".cutScene")[0].play(),O=0,$(".cutScene")[0].addEventListener("ended",function(){$(".cutSceneBg").fadeOut("fast",function(){var e="only "+(y-b+1)+" chargers left!";$game.statusUpdate({message:e,input:"status",screen:!0,log:!1}),O=1,$(".cutSceneBg").remove()}),b===4?(L=!0,o=4,j(),c.show()):q()})}function Q(){$(".bossHud .regularSeedButton").removeClass("currentButton"),$game.$player.seedMode=!1,$game.$player.resetRenderColor(),L=!0,o=3,j(),c.show()}function G(){l.on("click",".bossHud .regularSeedButton",function(){S===0&&E>0?($(this).addClass("currentButton"),S=1,$game.$player.seedMode=!0):S===1?($(this).removeClass("currentButton"),S=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor()):S===2?E>0?($(this).addClass("currentButton"),$(".bossHud .drawSeedButton").removeClass("currentButton"),S=1):$game.statusUpdate({message:"you have no more seeds!",input:"status",screen:!0,log:!1}):$game.statusUpdate({message:"you have no more seeds!",input:"status",screen:!0,log:!1})}),l.on("click",".bossHud .drawSeedButton",function(){S===0?($(this).addClass("currentButton"),S=2,$game.$player.seedMode=!0):S===1?($(this).addClass("currentButton"),$(".bossHud .regularSeedButton").removeClass("currentButton"),S=2,$game.$player.seedMode=!1,$game.$player.resetRenderColor()):($(this).removeClass("currentButton"),S=0)})}function Y(e){var t=e.x-1,n=e.y-1,r=[],i=100;for(var s=0;s<3;s++)for(var o=0;o<3;o++){var u=t+s,a=n+o;if(u>=0&&u<$game.VIEWPORT_WIDTH&&a>=0&&a<$game.VIEWPORT_HEIGHT){var l=f[u][a].distance,c=f[u][a].item,h=f[u][a].charger;l<i&&(i=l),r.push({val:l,x:u,y:a,item:c,charger:h}),h===0&&et(u,a),c>-1&&(f[u][a].itemRevealed=!0,c<2&&tt({x:u,y:a,item:c}))}}for(var p=0;p<r.length;p++){var d=.8-(r[p].val-i)*.2+.1;r[p].color=x+d+")"}$game.$renderer.renderBossTiles(r)}function Z(){var e=Math.floor(Math.random()*200);return e<4?e:-1}function et(e,t){f[e][t].charger=1,$game.statusUpdate({message:"you found a charger! Go to it to disable it.",input:"status",screen:!0,log:!1}),a.revealed=!0}function tt(e){f[e.x][e.y].itemRevealed&&(f[e.x][e.y].item=-1,e.item===0?($game.statusUpdate({message:"uh oh...time warp!",input:"status",screen:!0,log:!1}),O=4,M=setTimeout(function(){O=1},5e3),setTimeout(function(){$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)},2e3)):e.item===1?($game.statusUpdate({message:"wipeout!",input:"status",screen:!0,log:!1}),setTimeout(function(){U(),$game.$renderer.clearBossLevel()},1e3),f[a.x][a.y].charger=0):e.item===2?($game.statusUpdate({message:"time freeze, nice!",input:"status",screen:!0,log:!1}),O=0,clearTimeout(M),M=setTimeout(function(){O=1},5e3),$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)):e.item===3&&($game.statusUpdate({message:"bonus seeds!",input:"status",screen:!0,log:!1}),E+=3,$(".bossHud .regularSeedButton .hudCount").text(E),$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)))}function nt(e){vid=document.createElement("video"),CivicSeed.ENVIRONMENT==="development"?vid.src=Modernizr.video.h264?_+e+".mp4":_+i+".webm?VERSION="+Math.round(Math.random(1)*1e9):vid.src=Modernizr.video.h264?_+e+".mp4?VERSION="+CivicSeed.VERSION:_+i+".webm?VERSION="+CivicSeed.VERSION,vid.load(),vid.className="cutScene",vid.addEventListener("canplaythrough",function(t){this.removeEventListener("canplaythrough",arguments.callee,!1),P.push(vid),e+=1,e<D&&nt(e)},!1),vid.addEventListener("error",function(e){console.log("vid error")},!1)}var o,u,a={},f,l,c,h,p,d,v,m,g,y=4,b,w,E,S=0,x,T,N,C,k,L,A,O,M,_=CivicSeed.CLOUD_PATH+"/audio/cutScenes/",D=4,P=[],H;$game.$boss={isShowing:!1,init:function(e){B(),R(),$(".regularGameHud").fadeOut("fast"),G(),c.show(),x=$game.$player.getColorString(),o=0,j(),nt(0),$("#background").addClass("labBackground"),e()},resetInit:function(){o=null,u=null,a={},f=null,b=null,w=null,E=null,S=0,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,P=[],H=null,$game.$boss.isShowing=!1},nextSlide:function(){o!==4&&(o++,o===2?$(".bossHud").show():o>2&&(_numSeeds=7,c.fadeOut("fast",function(){$game.$boss.isShowing=!1,X()})),j())},dropSeed:function(e){L||(S===1?(E--,$game.$audio.playTriggerFx("seedDrop"),$(".bossHud .regularSeedButton .hudCount").text(E),Y(e),E<=0&&(S=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor(),$(".bossHud .regularSeedButton").removeClass("currentButton"),J())):S===2&&(w--,$(".bossHud .drawSeedButton .hudCount").text(w),w<=0&&(S=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor())))},endMove:function(e,t){L||(f[e][t].charger===1?(K(),$game.$renderer.clearBossLevel()):f[e][t].item>-1&&tt({x:e,y:t,item:f[e][t].item}))}}});require.define("/botanist.js",function(e,t,n,r,i){function U(){T=$(".speechBubble .speakerName"),N=$(".speechBubble .message"),C=$(".speechBubble"),k=$(".speechBubble p"),L=$(".speechBubble button"),A=$(".buttonCorner .nextChatButton"),O=$(".buttonCorner .closeChatButton"),M=$(".puzzleSvg"),_=$(".botanistArea"),D=$(".feedback"),P=$(".inventoryItem"),H=$(".tangramArea"),B=$(".botanistContent textarea"),j=$(".inventory"),F=$(".inventory button"),I=$(".inventoryPuzzle"),q=$(".botanistContent"),R=$(".botanistArea .message")}function z(){var e={id:$game.$player.id,botanistState:$game.$player.botanistState};ss.rpc("game.player.updateGameInfo",e)}var s=null,o=null,u=!1,a=null,f=0,l=0,c=0,h={},p=null,d=null,v=null,m=0,g=0,y=0,b=null,w={orange:"rgb(236,113,41)",lightOrange:"rgb(237,173,135)",blue:"rgb(14,152,212)",lightBlue:"rgb(109,195,233)",green:"rgb(76,212,206)",lightGreen:"rgb(164,238,235)"},E=5,S=["What motivates you to civically engage? Your answer will become a permanent part of your Civic Resume, so think carefully!","Please describe your past experience and skills in civic engagement. Your answer will become a permanent part of your Civic Resume, so think carefully!","What What aspect of civic engagement interests you the most? What type of projects do you want to work on? Your answer will become a permanent part of your Civic Resume, so think carefully!","What outcomes do you hope to achieve for yourself through civic engagement? What are you hoping to learn, and where do you want your civic engagement to lead? Your answer will become a permanent part of your Civic Resume, so think carefully!"],x=!1,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R=null;$game.$botanist={index:0,numSteps:64,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,dialog:null,tangram:null,name:null,isChat:!1,isShowing:!1,isSolving:!1,ready:!1,init:function(e){ss.rpc("game.npc.loadBotanist",function(t){$game.$botanist.index=t.id,$game.$botanist.dialog=t.dialog,$game.$botanist.name=t.name,$game.$botanist.tangram=t.tangram,s={x:t.x,y:t.y},o={kind:"botanist",srcX:0,srcY:0,curX:t.x,curY:t.y,prevX:t.x,prevY:t.y},U(),$game.$botanist.setupTangram(),$game.$botanist.getMaster(),$game.$botanist.setBotanistState($game.$player.botanistState),$game.$botanist.ready=!0,e()})},resetInit:function(){s=null,o=null,u=!1,a=null,f=0,l=0,c=0,h={},p=null,d=null,v=null,m=0,g=0,y=0,b=null,x=!1,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R=null,$game.$botanist.index=0,$game.$botanist.counter=Math.floor(Math.random()*64),$game.$botanist.curFrame=0,$game.$botanist.dialog=null,$game.$botanist.tangram=null,$game.$botanist.name=null,$game.$botanist.isChat=!1,$game.$botanist.isShowing=!1,$game.$botanist.isSolving=!1,$game.$botanist.ready=!1},clear:function(){$game.$renderer.clearBotanist(o)},getRenderInfo:function(){return u?o:!1},update:function(){$game.inTransit?$game.inTransit&&$game.$botanist.getMaster():u&&$game.$botanist.idle()},setBotanistState:function(e){e===2?o.srcY=160:o.srcY=0},getMaster:function(){var e=$game.$map.masterToLocal(s.x,s.y);if(e){var t=e.x*$game.TILE_SIZE,n=e.y*$game.TILE_SIZE,r=e.x*$game.TILE_SIZE,i=e.y*$game.TILE_SIZE;o.prevX=t,o.prevY=n,o.curX=r,o.curY=i,u=!0}else u=!1},idle:function(){m+=1,o.srcY===0?m>=24?(m=0,o.srcX=0):m==18?o.srcX=192:m==12?o.srcX=384:m==6&&(o.srcX=576):o.srcX=0},show:function(){if($game.$player.currentLevel<5)if($game.$player.botanistState===0)a=$game.$botanist.dialog[$game.$player.currentLevel].instructions,f=0,$game.$botanist.showChat();else if($game.$player.botanistState===1){var e=$game.$player.getSeedsDropped();$game.$player.currentLevel===0&&e<1?(_speak="To plant a seed, click the leaf icon at the bottom of the screen, and then click the area where you wish to plant. Oh, look at that, you have a seed already! Try and plant it, then talk to me again.",T.text($game.$botanist.name+": "),N.text(_speak),C.fadeIn(function(){setTimeout(function(){$game.$botanist.hideChat()},3e3)})):!x&&$game.$player.currentLevel===0?(a=$game.$botanist.dialog[$game.$player.currentLevel].instructions2,f=0,x=!0,$game.$botanist.showChat()):$game.$botanist.showPrompt(0)}else if($game.$player.botanistState===2){var t=0,n=$game.$player.getInventoryLength();n>0&&(t=1),a=[],a.push($game.$botanist.dialog[$game.$player.currentLevel].hint[t]),f=0,$game.$botanist.showChat()}else $game.$player.botanistState===3?$game.$botanist.showPrompt(1):$game.$player.botanistState===4&&$game.$botanist.showRiddle(2)},showTangram:function(){var e=CivicSeed.CLOUD_PATH+"/img/game/tangram/puzzle"+$game.$player.currentLevel+".png"},showChat:function(){k.removeClass("fitBubble"),$game.$audio.playTriggerFx("npcBubble"),$game.$botanist.isChat=!0,$game.$botanist.nextChatContent()},hideChat:function(){C.fadeOut(function(){L.addClass("hideButton"),O.unbind("click"),$game.$botanist.isChat=!1,$game.$player.botanistState===0&&$game.$player.currentLevel<4&&($game.$player.botanistState=1,z(),$game.$player.currentLevel===0&&$game.$player.updateSeeds("regular",1))})},addChatContent:function(){L.addClass("hideButton"),A.removeClass("hideButton"),T.text($game.$botanist.name+": "),N.text(a[f]),f===0&&C.fadeIn(function(){A.bind("click",function(){$game.$botanist.nextChatContent()})}),f===a.length-1&&(A.unbind("click").addClass("hideButton"),O.removeClass("hideButton").bind("click",function(){$game.$botanist.hideChat()}))},nextChatContent:function(){f<a.length&&($game.$botanist.addChatContent(),f+=1)},showPrompt:function(e){k.removeClass("fitBubble"),$game.$audio.playTriggerFx("npcBubble"),$game.$botanist.isChat=!0,_speak=$game.$botanist.dialog[$game.$player.currentLevel].riddle.prompts[e],T.text($game.$botanist.name+": "),N.text(_speak),$(".speechBubble .buttonCorner .yesButton").removeClass("hideButton"),$(".speechBubble .buttonCorner .noButton").removeClass("hideButton"),C.fadeIn(function(){$(".speechBubble .yesButton").bind("click",function(){e===1&&($game.$botanist.isSolving=!0,$(".displayBoxText").text("drag a piece to the board to use it"),_.css("height","380px")),$game.$botanist.showRiddle(e)}),$(".speechBubble .noButton").bind("click",function(){$game.$botanist.hideChat()})})},inventoryShowRiddle:function(){$game.$botanist.isShowing||(j.slideUp(),$game.$botanist.isChat=!0,$game.$botanist.showRiddle(0))},showRiddle:function(e){c=e,l=0,e===1?$game.$botanist.isChat=!0:e===2&&(l=2),$game.$botanist.addContent(),$game.$botanist.addButtons(),C.fadeOut(function(){L.addClass("hideButton"),$(".speechBubble .yesButton").unbind("click"),$(".speechBubble .noButton").unbind("click"),_.addClass("patternBg3").fadeIn(function(){$game.$botanist.isShowing=!0,l===0&&!$game.$player.firstTime&&H.show()})})},addButtons:function(){$(".botanistArea button").addClass("hideButton"),c===0?l===0?$game.$player.firstTime?$(".botanistArea .nextButton").removeClass("hideButton"):$(".botanistArea .closeButton").removeClass("hideButton"):$(".botanistArea .closeButton").removeClass("hideButton"):l===0?($(".botanistArea .answerButton").removeClass("hideButton"),$(".botanistArea .clearBoardButton").removeClass("hideButton")):l===1?$(".botanistArea .nextButton").removeClass("hideButton"):$(".botanistArea .answerButton").removeClass("hideButton")},nextSlide:function(){l+=1,$game.$botanist.addContent(),$game.$botanist.addButtons()},previousSlide:function(){l-=1,$game.$botanist.addContent(),$game.$botanist.addButtons()},addContent:function(){$(".botanistArea .speakerName").text($game.$botanist.name+": ");if(c===0){if(l===0){$game.$player.botanistState>1?R.text("Here is the notebook page to view again."):(R.text("Here is the page. You will be able to view it at anytime in your inventory."),$game.$player.currentLevel>0&&($game.$player.tangramToInventory(),$game.$player.botanistState=2,z(),$game.$player.checkBotanistState(),$game.$botanist.setBotanistState(2)));var e=CivicSeed.CLOUD_PATH+"/img/game/tangram/puzzle"+$game.$player.currentLevel+".png";q.html('<img src="'+e+'" class="tangramOutline">')}else if($game.$player.currentLevel===0){$game.$player.tangramToInventory(),$game.$player.firstTime=!1,$game.$player.botanistState=2;var t={id:$game.$player.id,firstTime:$game.$player.firstTime};ss.rpc("game.player.updateGameInfo",t),z(),$game.$player.checkBotanistState(),$game.$botanist.setBotanistState(2),R.text("There are four seed recipes in my notebook. You can view the current recipe and all the research pieces you have collected by opening your inventory. That's the toolbox icon at the bottom of the display."),q.html('<p>To collect the pieces for the recipe, you must go out into the world and talk to its citizens by clicking on them. They will ask you questions.  Answer the questions to gain more <b>seeds</b> and, more importantly, <b>research</b> that will enable to you create paintbrush seeds..  When you think you have enough pieces to complete the recipe come see me again.</p><img class="miniExample" src="/img/game/minimap.png"><p>The pieces of the first recipe can be found in Brightwood Forest to the northwest of here.  Pictured to the right is the mini map display you can see in the top right corner of the game screen.  You can toggle this on/off by clicking the globe icon below.  The highlighted quadrant represents the Brightwood Forest, and I am the square in the center.</p><p>Level 1, <b>Looking Inward</b>, is about understanding one\'s own motivations, goals, social identities, ethics and values in the context of a larger society.  Before beginning work in the community, it is important to look within, and reflect on where you are coming from in order to move forward. The more you understand yourself, the better equipped you will be to becoming an aware and effective active citizen.</p><p>Click the help icon (<i class="icon-question-sign icon-large"></i>) for more details on how to play.')}}else if(l===0){F.addClass("hideButton"),j.slideDown(function(){$game.$player.inventoryShowing=!1,P.attr("draggable","true")}),R.text("OK. Take the pieces you have gathered and drop them into the outline to create your seeds.");var n=CivicSeed.CLOUD_PATH+"/img/game/tangram/puzzle"+$game.$player.currentLevel+".png",r=CivicSeed.CLOUD_PATH+"/img/game/trash.png",i='<img src="'+n+'" class="tangramOutline"><img src="'+r+'" class="trash">';q.html(i),$(".inventoryPuzzle").hide(),$(".inventoryHelp").show()}else if(l===1){_.animate({height:"450px"}),j.slideUp(function(){$game.$player.inventoryShowing=!1,F.removeClass("hideButton"),P.remove()});var s=$game.$botanist.dialog[$game.$player.currentLevel].riddle.response;R.text(s);var o="<p>You earned a promotion to "+$game.playerRanks[$game.$player.currentLevel+1]+"</p>",u=CivicSeed.CLOUD_PATH+"/img/game/seed_chips.png";o+='<p class="seedChips"><img src="'+u+'"></p>',q.html(o)}else{var a=S[$game.$player.currentLevel];R.text(a);var f='<textarea placeholder="type your answer here..."></textarea>';q.html(f)}},hideResource:function(){H.hide(),_.fadeOut(function(){$game.$botanist.isShowing=!1,$(".botanist button").addClass("hideButton"),$(this).removeClass("patternBg3").css("height","450px"),$game.$botanist.isChat=!1,$game.$botanist.isSolving=!1,$game.$botanist.clearBoard(),$(".inventoryItem").css("opacity",1),$game.$player.botanistState===0&&$game.$player.currentLevel<4&&($(".progressButton").toggleClass("currentButton"),$game.showProgress())}),$game.$player.inventoryShowing?j.slideDown(function(){$game.$player.inventoryShowing=!0}):j.slideUp(function(){$game.$player.inventoryShowing=!1,F.removeClass("hideButton"),$(".inventoryPuzzle").show(),$(".inventoryHelp").hide()})},submitAnswer:function(){if(l===0){var e=$(".puzzleSvg > path"),t=!0,n=0,r=$game.$botanist.tangram[$game.$player.currentLevel].answer.length,i="",s=!1,o=!1;e.each(function(e,i){var u=$(this).attr("class"),a=u.substring(2,u.length),f=$(this).attr("transform"),l=f.substring(10,f.length-1),c=l.split(","),h=parseInt(c[0],10),p=parseInt(c[1],10),d=r,v=!1,m=!1;while(--d>-1){var g=$game.$botanist.tangram[$game.$player.currentLevel].answer[d];g.id===a&&(v=!0,h===g.x&&p===g.y?(n+=1,m=!0):m=!1)}v?v&&!m&&(o=!0,t=!1,$(".br"+a).remove(),$(".r"+a).css("opacity",1).attr("draggable","true")):(s=!0,t=!1,$(".br"+a).remove(),$(".r"+a).css("opacity",1).attr("draggable","true"))}),e.length===0?(t=!1,E-=1,i="at least TRY to solve it..."):s?(t=!1,E-=1,i="Oh! That’s not quite right. Think more about how the pieces relate to one another, and try again."):e.length<r?(t=!1,E-=1,i="You are missing some pieces. Be sure to read the notebook clues carefully to help pick out the right pieces."):o&&(t=!1,E-=1,i="So close! You have the right pieces, just fix the placement.");if(t){if(n===r){l=1,$game.$botanist.addContent(),$game.$botanist.addButtons(),M.empty(),H.hide(),$game.$player.emptyInventory();var u=E<0?0:E,a=$game.$player.currentLevel+1;totalSeeds=20+a*4+a*2*u,$game.$player.updateSeeds("draw",totalSeeds),$game.$player.botanistState=4,z()}}else $game.$botanist.feedback(i)}else{E=5;var f=B.val();$game.$player.resumeAnswer(f),$game.statusUpdate({message:"talk to the botanist",input:"status",screen:!0,log:!1}),$game.$player.nextLevel(),$game.$botanist.hideResource()}},setupTangram:function(){p=d3.select(".tangramArea").append("svg").attr("class","puzzleSvg").attr("width","930px").attr("height","380px"),d=d3.behavior.drag().origin(Object).on("drag",$game.$botanist.dragMove).on("dragstart",$game.$botanist.dragMoveStart).on("dragend",$game.$botanist.dropMove)},dragStart:function(e){if($game.$botanist.isSolving){H.unbind("dragover").unbind("drop");var t=e.data,n=e.originalEvent.dataTransfer;n.setData("text/plain",t.npc),$(".tangramArea").bind("dragover",$game.$botanist.dragOver).bind("drop",$game.$botanist.drop)}},dragEnd:function(e){e.preventDefault()},dragOver:function(e){return e.preventDefault&&e.preventDefault(),!1},drop:function(e){e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=e.originalEvent.dataTransfer.getData("text/plain"),n=t.split(","),r=n[0],i=n[1],s="br"+i,o=e.originalEvent.layerX,u=e.originalEvent.layerY,a=$game.$resources.getShape(r),f=a.path,l=w[a.fill];return $(".r"+i).css("opacity",".4").attr("draggable","false"),v=p.append("path").attr("class",s).data([{x:o,y:u,id:i,color:l}]).attr("d",a.path).attr("fill",l).attr("stroke","rgb(255,255,255)").attr("stroke-width",0).attr("transform","translate("+o+","+u+")").call(d),H.unbind("dragover").unbind("drop"),e.originalEvent.dataTransfer.clearData(),!1},dragMoveStart:function(e){clearTimeout(b),D.fadeOut("fast"),g=d3.mouse(this)[0],y=d3.mouse(this)[1],d3.select(".br"+e.id).attr("stroke-width",3)},dragMove:function(e){var t=d3.event.sourceEvent.layerX,n=d3.event.sourceEvent.layerY,r=t-g,i=n-y,s=!1;t>825&&t<890&&n>170&&n<300?($(".trash").css("opacity",1),s=!0):($(".trash").css("opacity",.5),s=!1);var o="translate("+r+", "+i+")";d3.select(".br"+e.id).attr("transform",o).attr("opacity",function(){return s?.5:1})},dropMove:function(e){var t=d3.event.sourceEvent.layerX,n=d3.event.sourceEvent.layerY,r=$game.$botanist.snapTo(t-g),i=$game.$botanist.snapTo(n-y),s="translate("+r+", "+i+")";d3.select(".br"+e.id).attr("stroke-width",0).attr("transform",s),t>825&&t<890&&n>170&&n<300?($(".br"+e.id).remove(),$(".r"+e.id).css("opacity",1).attr("draggable","true"),$(".trash").css("opacity",.5)):d3.select(".br"+e.id).attr("stroke-width",0).attr("transform",s)},clearBoard:function(){$(".puzzleSvg").empty(),$(".inventoryItem").css("opacity",1).attr("draggable","true")},snapTo:function(e){var t=e,n=10,r=n/2,i=e%n-r;return i>-1?t+=r-i:t+=-r-i,t},feedback:function(e){D.text(e).fadeIn(),b=setTimeout(function(){D.fadeOut()},4500)},getLevelQuestion:function(e){return S[e]},disable:function(){u=!1}}});require.define("/chat.js",function(e,t,n,r,i){function f(e,t){var n=e/2,r=null,i=null;t?i=t.position:i=$game.$player.getRenderPosition();if(i.x>470){var s=940-i.x;n>s?r=i.x-n-(n-s):r=i.x-n+16}else n>i.x?r=i.x-n+(n-i.x)+10:r=i.x-n+16;t?$(t.chatIdSelector).css({top:i.y-72,left:r,width:e}):$(a).css({top:i.y-72,left:r,width:e})}var s=!1,o=null,u=null,a=null;$game.$chat={init:function(e){u="player"+$game.$player.id,a="#"+u,$gameboard=$(".gameboard"),e()},resetInit:function(){s=!1,o=null,u=null,a=null},message:function(e,t){},hideChat:function(e){clearTimeout(o),$(a).fadeOut("fast",function(){$(this).remove(),s=!1})}}});require.define("/events.js",function(e,t,n,r,i){var s,o,u=t.exports={registerVariables:function(){s=$(".activePlayers span"),o=$(".progressButton .hudCount")},init:function(){ss.event.on("ss-addPlayer",function(e,t){$game.numPlayers=e.num,$game.$others.add(e.info),s.text(e.num),e.info._id!==$game.$player.id&&$game.statusUpdate({message:e.info.firstName+" has joined!",input:"status",screen:!0,log:!0})}),ss.event.on("ss-removePlayer",function(e,t){$game.numPlayers=e.num,e.id!=$game.$player.id&&$game.$others.remove(e.id),$(".activePlayers span").text(e.num)}),ss.event.on("ss-playerMoved",function(e,t){e.id!=$game.$player.id&&$game.$others.sendMoveInfo(e.moves,e.id)}),ss.event.on("ss-seedDropped",function(e,t){$game.$map.newBomb(e.bombed,e.id),$game.$player.id!==e.id&&$game.$others.updateTilesColored(e.id,e.tilesColored)}),ss.event.on("ss-newMessage",function(e,t){e.input="chat",$game.$log.addMessage(e)}),ss.event.on("ss-statusUpdate",function(e,t){console.log("TODO lol")}),ss.event.on("ss-progressChange",function(e,t){$game.seedsDropped=e.dropped,$game.updatePercent()}),ss.event.on("ss-leaderChange",function(e,t){$game.updateLeaderboard(e)}),ss.event.on("ss-addAnswer",function(e,t){$game.$resources.addAnswer(e)}),ss.event.on("ss-removeAnswer",function(e,t){$game.$resources.removeAnswer(e)}),ss.event.on("ss-levelChange",function(e,t){$game.$others.levelChange(e.id,e.level)}),ss.event.on("ss-seedPledged",function(e,t){$game.$player.id===e.id&&($game.statusUpdate({message:e.pledger+" liked a response of yours. Here, have some seeds.",input:"status",screen:!0,log:!0}),$game.$player.updateSeeds("regular",1),$game.$player.updateResource(e))}),ss.event.on("ss-bossModeUnlocked",function(){$game.bossModeUnlocked=!0,$game.$player.currentLevel>3&&$game.toBossLevel()}),ss.event.on("ss-beam",function(e){e.id!==$game.$player.id&&$game.$others.beam(e)})}}});require.define("/game.js",function(e,t,n,r,i){function L(){k.$player.init(function(){A()})}function A(){ss.rpc("game.player.getGameInfo",function(e){k.bossModeUnlocked=e.bossModeUnlocked,k.resourceCount=e.resourceCount,u={seedsDropped:e.seedsDropped,seedsDroppedGoal:e.seedsDroppedGoal,leaderboard:e.leaderboard,percent:Math.floor(e.seedsDropped/e.seedsDroppedGoal*100),prevPercent:Math.floor(e.seedsDropped/e.seedsDroppedGoal*100)},k.$player.setPositionInfo(),k.$renderer.init(function(){O()})})}function O(){k.$map.init(function(){q(),M()})}function M(){k.$others.init(function(){_()})}function _(){k.$npc.init(function(){D()})}function D(){k.$resources.init(function(){P()})}function P(){k.$botanist.init(function(){H()})}function H(){k.$robot.init(function(){B()})}function B(){k.$audio.init(function(){j()})}function j(){k.$chat.init(function(){F()})}function F(){k.$log.init(function(){I()})}function I(){k.$player.fillInventory(),k.$player.createInventoryOutlines();var e=k.$player.getColorMap();e!==undefined&&k.$renderer.imageToCanvas(e),k.$map.createCollectiveImage(),ss.rpc("game.chat.init"),R()}function q(){var e=k.$player.getPosition(),t=e.x===0?0:e.x-1,n=e.y===0?0:e.y-1,r=Math.floor(t/(k.VIEWPORT_WIDTH-2)),i=Math.floor(n/(k.VIEWPORT_HEIGHT-2)),s=r*(k.VIEWPORT_WIDTH-2),o=i*(k.VIEWPORT_HEIGHT-2);k.masterX=s,k.masterY=o,k.$map.setBoundaries()}function R(e){k.bossModeUnlocked&&k.$player.currentLevel>3&&k.$boss.init(function(){}),k.$map.firstStart(function(){e||$(".loading").fadeOut(function(){$(this).remove(),k.ready=!0,k.running=!0,k.$renderer.renderAllTiles(),k.tick(),k.$player.displayNpcComments()})})}var s=0;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){var n=(new Date).getTime(),r=Math.max(0,16-(n-s)),i=window.setTimeout(function(){e(n+r)},r);return s=n+r,i}}();var o=0,u=null,a=["fuck","shit","bitch","cunt","damn","penis","vagina","crap","screw","suck","piss","whore","slut"],f=["Level 1: Looking Inward","Level 2: Expanding Outward","Level 3: Working Together","Level 4: Looking Forward","Game Over: Profile Unlocked"],l=null,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=t.exports={VIEWPORT_WIDTH:30,VIEWPORT_HEIGHT:15,TOTAL_WIDTH:142,TOTAL_HEIGHT:132,TILE_SIZE:32,STEP_PIXELS:4,currentTiles:[],inTransit:!1,running:!1,ready:!1,showingProgress:!1,resourceCount:[],graph:null,masterX:null,masterY:null,playerRanks:["novice gardener","apprentice gardener","expert gardener","master gardener","super master gardener"],bossModeUnlocked:null,startNewAction:!0,instantiated:!1,init:function(t){c=e("/map"),$render=e("/render"),p=e("/npc"),d=e("/resources"),v=e("/player"),m=e("/others"),g=e("/robot"),y=e("/botanist"),b=e("/mouse"),w=e("/audio"),E=e("/pathfinder"),S=e("/events"),x=e("/input"),T=e("/chat"),N=e("/log"),C=e("/boss"),S.init(),x.init(),$WINDOW.on("beforeunload",function(){if(sessionStorage.isPlaying==="true"){var e=k.exitGame();return e}}),k.instantiated=!0},reInit:function(){k.resetInit(),k.$map.resetInit(),k.$renderer.resetInit(),k.$npc.resetInit(),k.$resources.resetInit(),k.$player.resetInit(),k.$others.resetInit(),k.$robot.resetInit(),k.$botanist.resetInit(),k.$mouse.resetInit(),k.$audio.resetInit(),k.$input.resetInit(),k.$chat.resetInit(),k.$log.resetInit(),k.$boss.resetInit()},resetInit:function(){s=0,o=0,u=null,l=null,k.currentTiles=[],k.inTransit=!1,k.running=!1,k.ready=!1,k.showingProgress=!1,k.resourceCount=[],k.graph=null,k.masterX=null,k.masterY=null,k.bossModeUnlocked=null,k.startNewAction=!0},enterGame:function(e){ss.rpc("shared.account.checkGameSession",function(e){k.instantiated?k.reInit():k.init(),e.status?(sessionStorage.setItem("isPlaying",!0),k.kickOffGame()):(e.profileLink&&Davis.location.assign("/profiles/"+e.profileLink),apprise('There seems to have been an error accessing the game.<br><br><span style="display:block;font-size:11px;text-align:center;">(If you think there is a problem, please contact the website administrator.)</span>'))})},kickOffGame:function(){$CONTAINER.append(JT["game-gameboard"]()),$CONTAINER.append(JT["game-resourceStage"]()),$CONTAINER.append(JT["game-hud"]()),S.registerVariables(),x.registerVariables(),L()},pause:function(){$(".pauseMenu").fadeIn(),k.running=!1},resume:function(){$(".pauseMenu").slideUp(function(){k.running=!0,k.tick()})},beginTransition:function(){k.inTransit=!0,o=0,k.$chat.hideChat(),k.$others.hideAllChats(),$(".npcBubble").remove(),k.stepTransition()},stepTransition:function(){o!==k.$map.numberOfSteps?(o+=1,k.$map.transitionMap(o)):k.endTransition()},endTransition:function(){k.inTransit=!1,k.$player.isMoving=!1,k.$player.resetRenderValues(),k.$others.resetRenderValues(),k.$map.createPathGrid(function(){k.$map.stepDirection=null}),k.$player.displayNpcComments(),k.$player.saveTimeToDB()},tick:function(){if(k.running){if(k.$player.currentLevel<4||!k.bossModeUnlocked&&k.$player.currentLevel>3)k.$others.update(),k.$npc.update(),k.$botanist.update(),k.$robot.update();k.$player.update(),k.$renderer.renderFrame(),requestAnimationFrame(k.tick)}},showProgress:function(){var e=k.$map.saveImage();k.$map.createCollectiveImage();var t=k.$player.getTilesColored(),n=k.$player.getResourcesDiscovered();$(".levelImages img").removeClass("currentLevelImage"),$(".levelImages img:nth-child("+(k.$player.currentLevel+1)+")").addClass("currentLevelImage"),$(".personalInfo .currentLevel").text(k.playerRanks[k.$player.currentLevel]),$(".colorMapYou img").attr("src",e).attr("width","426px");var r=k.$player.getPlayingTime(),i=Math.floor(r/3600),s=r%3600,o=Math.floor(s/60),a=r%60,f=i+"h "+o+"m "+a+"s",l=k.$player.currentLevel+1,c="<p>top seeders:</p><ol>";for(var h=0;h<u.leaderboard.length;h++)c+="<li>"+u.leaderboard[h].name+" -- "+u.leaderboard[h].count+"</li>";c+="</ol>",c+='<p class="yourSeeds">You ('+t+")</p>";var p=k.$player.compileAnswers(),d=u.percent+"%",v=k.$player.getResourcesDiscovered();$(".displayPercent .progress .bar").css("width",d),$(".displayMyAnswers").empty().append(p),$(".displayTime").html('<i class="icon-time icon-large"></i> '+f),$(".topSeeders").empty().append(c),$(".numCollected").text(v+" / 42"),$(".progressArea").fadeIn(function(){k.showingProgress=!0})},statusUpdate:function(e){if(e.screen){$(".statusUpdate").text(e.message).show(),clearTimeout(l);var t=e.message.length,n=t*100+500;l=setTimeout(function(){$(".statusUpdate").fadeOut()},n)}e.log&&k.$log.addMessage(e)},checkPotty:function(e){var t=e.toLowerCase();for(var n=0;n<a.length;n++)if(t.indexOf(a[n])>-1)return"I have a potty mouth and I am sorry for cussing.";return e},updateLeaderboard:function(e){var t=!0;u.leaderboard.length>0&&(t=u.leaderboard[0].name===e.board[0].name?!1:!0),t&&k.statusUpdate({message:e.board[0].name+" is top seeder!",input:"status",screen:!0,log:!0}),u.leaderboard=e.board},updatePercent:function(e){u.prevPercent=u.percent,u.seedsDropped=e,u.percent=Math.floor(u.seedsDropped/u.seedsDroppedGoal*100),u.percent>99&&k.statusUpdate({message:"the meter is filled!",input:"status",screen:!0,log:!0}),u.prevPercent!=u.percent&&(u.prevPercent=u.percent,u.percent%5===0)},exitGame:function(e){sessionStorage.removeItem("isPlaying"),k.running=!1,k.$audio.stopAll(),k.bossModeUnlocked||k.$player.saveTimeToDB(),k.$map.removePlayer(k.$player.id),ss.rpc("game.player.exitPlayer",k.$player.id,k.$player.firstName,function(){typeof e=="function"&&e()})},toBossLevel:function(){k.$renderer.clearMap(),k.$player.setPositionInfo(),k.$botanist.disable(),k.$robot.disable(),k.$others.disable(),q(),R(!0)}}});require.define("/input.js",function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v=$game.$input=t.exports={registerVariables:function(){s=$("#chatText"),o=$(".chatBox"),u=$(".displayBox"),a=$(".inventory"),f=$(".displayBoxText"),l=$(".progressArea"),c=$(".gameLog"),h=!1,p=!1,d=null},init:function(){$BODY.on("click",".seedButton",function(){var t=e();t?$game.$player.seedMode?($BODY.off("mousedown touchend",".gameboard"),$BODY.off("mouseup touchend",".gameboard"),$(".graffiti").hide(),$game.$mouse.drawMode=!1,$game.$player.seedMode=!1,$game.$player.seedPlanting=!1,$game.$player.resetRenderColor(),$(this).removeClass("currentButton"),$game.$player.saveMapImage(),$game.$player.saveSeeds()):$game.$player.openSeedventory():($game.$player.seedventoryShowing?($BODY.off("mousedown touchend",".gameboard"),$BODY.off("mouseup touchend",".gameboard"),$game.$mouse.drawMode=!1,$(".seedventory").slideUp(function(){$game.$player.seedventoryShowing=!1})):($BODY.off("mousedown touchend",".gameboard"),$BODY.off("mouseup touchend",".gameboard"),$game.$mouse.drawMode=!1,$game.$player.seedPlanting=!1),$(".graffiti").hide(),$(this).removeClass("currentButton"),$game.$player.saveMapImage())}),$BODY.on("click",".regularButton",function(){$game.$player.startSeeding("regular")}),$BODY.on("click",".drawButton",function(){$game.$player.startSeeding("draw"),$BODY.on("mousedown touchstart",".gameboard",function(){$game.$player.drawFirstSeed(),$game.$mouse.drawMode=!0}),$BODY.on("mouseup touchend",".gameboard",function(){$game.$mouse.drawMode=!1,$BODY.off("mousedown touchstart",".gameboard")})}),$BODY.on("mousemove",".gameboard",function(e){if(!$game.inTransit&&!$game.$player.isMoving&&!$game.$resources.isShowing&&$game.running){var t={x:e.pageX,y:e.pageY,offX:this.offsetLeft,offY:this.offsetTop,debug:!1};$game.$mouse.updateMouse(t,!1)}}),$BODY.on("click",".gameboard",function(t){var n=e();if(n){var r={x:t.pageX,y:t.pageY,offX:this.offsetLeft,offY:this.offsetTop,debug:!1};$game.$mouse.updateMouse(r,!0)}}),$BODY.on("click","#chatButton",function(e){e.preventDefault();var t=s.val(),n={msg:$game.checkPotty(t),name:$game.$player.firstName,id:$game.$player.id,log:t,instanceName:$game.$player.instanceName};return $game.$audio.playTriggerFx("chatSend"),n.msg.indexOf("beam me up, Scotty!")>-1?$game.$player.beamMeUpScotty():ss.rpc("game.chat.sendMessage",n,function(e){}),s.val(""),!1}),$BODY.on("click",".logButton",function(){var t=e();if(t||p)p=!p,$(".logButton").toggleClass("currentButton"),c.fadeToggle(),c.scrollTop(c[0].scrollHeight),$game.$log.clearUnread();return!1}),$BODY.on("click",".inventoryButton, .inventory button",function(){var t=e();if(t||$game.$player.inventoryShowing)$game.$player.inventoryShowing?a.slideUp(function(){$game.$player.inventoryShowing=!1,$(".inventoryButton").removeClass("currentButton")}):a.slideDown(function(){$game.$player.inventoryShowing=!0,f.text("click items to view again"),$(".inventoryButton").addClass("currentButton")});return!1}),$BODY.on("click",".resourceArea a i, .resourceArea .closeButton",function(e){return e.preventDefault(),$game.$resources.waitingForTagline?$(".checkTagline").show().delay(2e3).fadeOut():($(".check").hide(),$game.$resources.hideResource()),!1}),$BODY.on("click",".resourceArea .nextButton",function(){$(".check").hide(),$game.$resources.nextSlide()}),$BODY.on("click",".resourceArea .backButton",function(){$(".check").hide(),$game.$resources.previousSlide()}),$BODY.on("click",".resourceArea .saveButton",function(){var e=$(".customTagline").val();$game.$resources.saveTagline(e)}),$BODY.on("click",".resourceArea .answerButton, .resourceArea .sureButton",function(e){return e.preventDefault(),$(".check").hide(),$game.$resources.submitAnswer(),!1}),$BODY.on("click",".resourceArea .sureButton",function(e){return e.preventDefault(),$(".check").hide(),$game.$resources.submitAnswer(!0),!1}),$BODY.on("click",".resourceArea .retryButton",function(e){return e.preventDefault(),$(".check").fadeOut(),!1}),$BODY.on("click",".botanistArea a i, .botanistArea .closeButton",function(e){return e.preventDefault(),$game.$botanist.hideResource(),!1}),$BODY.on("click",".botanistArea .nextButton",function(e){$game.$botanist.nextSlide()}),$BODY.on("click",".botanistArea .backButton",function(e){$game.$botanist.previousSlide()}),$BODY.on("click",".botanistArea .answerButton",function(e){return e.preventDefault(),$game.$botanist.submitAnswer(),!1}),$BODY.on("click",".botanistArea .clearBoardButton",function(e){return e.preventDefault(),$game.$botanist.clearBoard(),!1}),$BODY.on("click",".progressArea a i",function(e){return e.preventDefault(),$(".progressButton").removeClass("currentButton"),l.fadeOut(function(){$game.showingProgress=!1}),!1}),$BODY.on("click",".activePlayers",function(){$("#minimapPlayer").toggleClass("hide")}),$BODY.on("click",".progressButton",function(){if($game.showingProgress)$(this).toggleClass("currentButton"),l.fadeOut(function(){$game.showingProgress=!1});else{var t=e();t&&($(this).toggleClass("currentButton"),$game.showProgress())}}),$BODY.on("click",".muteButton",function(){var e=$game.$audio.toggleMute();e?$(".muteButton i").removeClass("icon-volume-up").addClass("icon-volume-off"):$(".muteButton i").removeClass("icon-volume-off").addClass("icon-volume-up")}),$BODY.on("click",".helpButton",function(){h=!h,$(".helpArea").fadeToggle(),$(".helpButton").toggleClass("currentButton")}),$BODY.on("click",".helpArea a i",function(e){return e.preventDefault(),$(".helpButton").toggleClass("currentButton"),$(".helpArea").fadeOut("fast",function(){h=!1}),!1}),$BODY.on("mouseenter",".globalHud > div > i, .playerHud > div > i, .seedventory > div > i",function(){var e=$(this).attr("title");$(this).tooltip("show")}),$BODY.on("click",".publicButton",function(){$game.$player.makePublic($(this).attr("data-npc"))}),$BODY.on("click",".privateButton",function(){$game.$player.makePrivate($(this).attr("data-npc"))}),$BODY.on("click",".pledgeButton",function(){var e={id:$(this).attr("data-player"),pledger:$game.$player.firstName,npc:$(this).attr("data-npc")},t=$game.$player.getPledges();t>0?ss.rpc("game.player.pledgeSeed",e,function(e){$game.$player.updatePledges(-1),clearTimeout(d),$(".resourceArea .feedback").text("Thanks! (they will say). You can seed "+(t-1)+" more answers this level.").show(),d=setTimeout(function(){$(".resourceArea .feedback").fadeOut()},3e3)}):(clearTimeout(d),$(".resourceArea .feedback").text("You cannot seed any more answers this level.").show(),d=setTimeout(function(){$(".resourceArea .feedback").fadeOut()},3e3))}),$BODY.on("click",".collectedButton",function(){$(".collectedResources").show()}),$BODY.on("click",".collectedResources .backToProgress",function(){$(".collectedResources").hide()}),$BODY.on("click",".bossArea .bossButton",function(){$game.$boss.nextSlide()}),$BODY.on("click",".tabbable li a",function(e){return e.preventDefault(),!1});var e=function(){return!$game.inTransit&&!$game.$player.isMoving&&!$game.$resources.isShowing&&!$game.$player.inventoryShowing&&!$game.showingProgress&&!$game.$player.seedventoryShowing&&$game.running&&!$game.$botanist.isChat&&!h&&!p&&!$game.$boss.isShowing?!0:!1}},resetInit:function(){h=null,p=null,d=null}}});require.define("/log.js",function(e,t,n,r,i){function l(){s=$(".gameLog"),o=$(".logButton .hudCount")}var s,o,u,a=50,f=0;$game.$log={ready:!1,init:function(e){l(),$game.$log.clearUnread(),$game.statusUpdate({message:"Welcome to Civic Seed",input:"status",log:!0,screen:!1}),$game.$log.ready=!0,e()},resetInit:function(){u=null,a=50,f=0,$game.$log.ready=!1},addMessage:function(e){if($game.$log.ready){u++,f++;var t=u;u>10&&(t="10+"),o.text(t).removeClass("hide");var n=Date(),r=n.substring(0,10)+n.substring(15,24),i;e.input==="chat"?(i='<p class="globalChat"><span class="date">'+r+"</span>",i+='<span class="playerName">'+e.name+": </span>"+e.message+"</p>"):(i='<p class="status"><span class="date">'+r+"</span>",i+=e.message+"</p>"),f>a&&$(".gameLog p").first().remove(),s.append(i),s.scrollTop(s[0].scrollHeight)}},clearUnread:function(){o.text(u).addClass("hide"),u=0,o.text(u)}}});require.define("/map.js",function(e,t,n,r,i){function h(e,t){$game.$map.dataLoaded=!1;var n=e.x,r=e.y,i=e.x+e.numX,o=e.y+e.numY;ss.rpc("game.map.getMapData",n,r,i,o,function(n,r){var i=null;s=new Array(e.numX);var o=e.numX;while(--o>=0){s[o]=new Array(e.numY);var u=e.numY;while(--u>=0)i=u*e.numX+o%e.numX,s[o][u]=n[i]}var a=r.length,f=0,l=0,c=0,h=s.length,p=s[0].length;while(c<a){var d=!1;while(!d)s[f][l].mapIndex===r[c].mapIndex&&(s[f][l].color=r[c].color,s[f][l].curColor=r[c].curColor,d=!0),f++,f>=h&&(f=0,l++,l>=p&&(console.log("errrr"),d=!0));c++}$game.$map.dataLoaded=!0,t()})}function p(e){$game.$map.currentTiles=[$game.VIEWPORT_WIDTH];var t=$game.VIEWPORT_WIDTH;while(--t>=0){$game.$map.currentTiles[t]=[$game.VIEWPORT_HEIGHT];var n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[t][n]=s[t][n]}s=[],e()}function d(){$game.$map.currentTiles=[$game.VIEWPORT_WIDTH];var e=$game.VIEWPORT_WIDTH;while(--e>=0){$game.$map.currentTiles[e]=[$game.VIEWPORT_HEIGHT];var t=$game.VIEWPORT_HEIGHT;while(--t>=0)$game.$map.currentTiles[e][t]={x:e,y:t,tileState:-1,isMapEdge:!0,background:0,background2:0,background3:0,foreground:0,foreground2:0,mapIndex:t*$game.VIEWPORT_WIDTH+e}}}var s=null,o=null,u=null,a=0,f=0,l=0,c=0;s=[],_shiftArray=0,_stepNumber=0,_leftEdge=0,_rightEdge=0,_topEdge=0,_bottomEdge=0,$game.$map={coloredTiles:[],growingSeed:!1,seedsInProgress:[],collectiveImage:null,ready:!1,miniMap:{},currentTiles:null,dataLoaded:!1,numberOfSteps:0,stepDirection:null,init:function(e){var t=$game.$player.id,n=$game.$player.getPosition(),r=$game.$player.getColor();$game.$map.addPlayer(t,n.x,n.y,r),ss.rpc("game.map.init",function(){$game.$map.ready=!0,e()})},resetInit:function(){s=null,o=null,u=null,a=0,f=0,l=0,c=0,s=[],_shiftArray=0,_stepNumber=0,_leftEdge=0,_rightEdge=0,_topEdge=0,_bottomEdge=0,$game.$map.coloredTiles=[],$game.$map.growingSeed=!1,$game.$map.seedsInProgress=[],$game.$map.collectiveImage=null,$game.$map.ready=!1,$game.$map.miniMap={},$game.$map.currentTiles=null,$game.$map.dataLoaded=!1,$game.$map.numberOfSteps=0,$game.$map.stepDirection=null},firstStart:function(e){if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$("#minimapPlayer").toggleClass("hide"),d(),$game.$map.createPathGrid(function(){e()},!0);else{var t={x:$game.masterX,y:$game.masterY,numX:$game.VIEWPORT_WIDTH,numY:$game.VIEWPORT_HEIGHT};h(t,function(){p(function(){$game.$map.createPathGrid(function(){e()})})})}},createPathGrid:function(e,t){o=null,u=null,o=new Array($game.VIEWPORT_HEIGHT);var n=$game.VIEWPORT_HEIGHT;while(--n>=0){o[n]=new Array($game.VIEWPORT_WIDTH);var r=$game.VIEWPORT_WIDTH;while(--r>=0)if(t)o[n][r]=1;else{var i=$game.$map.getTileState(r,n),s;i===-1?s=1:s=0,o[n][r]=s}}u=new Graph(o),e()},getTileState:function(e,t){var n=$game.$map.currentTiles[e][t].tileState;if(t<$game.VIEWPORT_HEIGHT-1){var r=$game.$map.currentTiles[e][t+1].tileState;r>=0&&(n=r)}return n},isMapEdge:function(e,t,n){var r=$game.$map.currentTiles[e][t].isMapEdge;n(r)},addPlayer:function(e,t,n,r){$game.$map.miniMap[e]={},$game.$map.miniMap[e].x=t,$game.$map.miniMap[e].y=n,$game.$map.miniMap[e].col=r,$game.$map.render()},updatePlayer:function(e,t,n){$game.$renderer.clearMiniMap(),$game.$map.miniMap[e].x=t,$game.$map.miniMap[e].y=n,$game.$map.render()},removePlayer:function(e){$game.$renderer.clearMiniMap(),delete $game.$map.miniMap[e],$game.$map.render()},render:function(){$game.$renderer.renderMiniMapConstants(),$.each($game.$map.miniMap,function(e,t){$game.$renderer.renderMiniPlayer(t)})},newBomb:function(e,t){for(var n=0;n<e.length;n+=1){var r=$game.$map.masterToLocal(e[n].x,e[n].y),i=null;r&&(i=$game.$map.currentTiles[r.x][r.y],i.color=e[n].color,i.curColor=e[n].curColor,$game.$renderer.clearMapTile(r.x*$game.TILE_SIZE,r.y*$game.TILE_SIZE),$game.$renderer.renderTile(r.x,r.y),t===$game.$player.id&&$game.$renderer.renderMiniTile(e[n].x,e[n].y,e[n].color))}},saveImage:function(){var e=document.getElementById("minimapTile"),t=e.toDataURL("img/png");return t},createCollectiveImage:function(){ss.rpc("game.player.getAllImages",function(e){var t=e.length;while(--t>-1)$(".colorMapEveryone").append('<img src="'+e[t]+'">')})},findPath:function(e,t,n){var r=u.nodes[e.y][e.x],i=u.nodes[t.y][t.x];$game.$astar.search(u.nodes,r,i,function(e){n(e)})},calculateNext:function(e,t){var n,r,i,s;e===0?(a=$game.masterX-($game.VIEWPORT_WIDTH-2),l=-1,_shiftArray=-1,$game.$map.numberOfSteps=$game.VIEWPORT_WIDTH-2,$game.$map.stepDirection="left",n=$game.VIEWPORT_WIDTH-2,r=$game.VIEWPORT_HEIGHT,i=a,s=$game.masterY):e===$game.VIEWPORT_WIDTH-1?(a=$game.masterX+$game.VIEWPORT_WIDTH-2,l=1,_shiftArray=1,$game.$map.numberOfSteps=$game.VIEWPORT_WIDTH-2,$game.$map.stepDirection="right",n=$game.VIEWPORT_WIDTH-2,r=$game.VIEWPORT_HEIGHT,i=a+2,s=$game.masterY):t===0?(f=$game.masterY-($game.VIEWPORT_HEIGHT-2),c=-1,_shiftArray=-$game.totalVIEWPORT_HEIGHT,$game.$map.numberOfSteps=$game.VIEWPORT_HEIGHT-2,$game.$map.stepDirection="up",n=$game.VIEWPORT_WIDTH,r=$game.VIEWPORT_HEIGHT-2,i=$game.masterX,s=f):t===$game.VIEWPORT_HEIGHT-1&&(f=$game.masterY+$game.VIEWPORT_HEIGHT-2,c=1,_shiftArray=$game.totalVIEWPORT_HEIGHT,$game.$map.numberOfSteps=$game.VIEWPORT_HEIGHT-2,$game.$map.stepDirection="down",n=$game.VIEWPORT_WIDTH,r=$game.VIEWPORT_HEIGHT-2,i=$game.masterX,s=f+2),h({x:i,y:s,numX:n,numY:r},function(){return})},transitionMap:function(e){var t,n;if($game.$map.stepDirection==="right"){t=0;while(t<$game.VIEWPORT_WIDTH-1){n=0;while(n<$game.VIEWPORT_HEIGHT)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t+1][n],n+=1;t+=1}n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[$game.VIEWPORT_WIDTH-1][n]=s[e-1][n];$game.masterX+=1,$game.$player.slide(1,0),$game.$others.slide(1,0)}if($game.$map.stepDirection==="left"){t=$game.VIEWPORT_WIDTH-1;while(t>0){n=0;while(n<$game.VIEWPORT_HEIGHT)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t-1][n],n+=1;t-=1}n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[0][n]=s[s.length-e][n];$game.masterX-=1,$game.$player.slide(-1,0),$game.$others.slide(-1,0)}if($game.$map.stepDirection==="up"){n=$game.VIEWPORT_HEIGHT-1;while(n>0){t=0;while(t<$game.VIEWPORT_WIDTH)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t][n-1],t+=1;n-=1}t=$game.VIEWPORT_WIDTH;while(--t>=0)$game.$map.currentTiles[t][0]=s[t][s[0].length-e];$game.masterY-=1,$game.$player.slide(0,-1),$game.$others.slide(0,-1)}if($game.$map.stepDirection==="down"){n=0;while(n<$game.VIEWPORT_HEIGHT-1){t=0;while(t<$game.VIEWPORT_WIDTH)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t][n+1],t+=1;n+=1}t=$game.VIEWPORT_WIDTH;while(--t>=0)$game.$map.currentTiles[t][$game.VIEWPORT_HEIGHT-1]=s[t][e-1];$game.masterY+=1,$game.$player.slide(0,1),$game.$others.slide(0,1)}_leftEdge=$game.masterX,_rightEdge=$game.masterX+$game.VIEWPORT_WIDTH,_topEdge=$game.masterY,_bottomEdge=$game.masterY+$game.VIEWPORT_HEIGHT+1,requestAnimationFrame($game.stepTransition)},masterToLocal:function(e,t,n){var r={x:e-_leftEdge,y:t-_topEdge};return r.y<=$game.VIEWPORT_HEIGHT-1&&r.y>=0&&r.x<=$game.VIEWPORT_WIDTH-1&&r.x>=0?r:n?r:!1},setBoundaries:function(){_leftEdge=$game.masterX,_rightEdge=$game.masterX+$game.VIEWPORT_WIDTH,_topEdge=$game.masterY,_bottomEdge=$game.masterY+$game.VIEWPORT_HEIGHT+1}}});require.define("/mouse.js",function(e,t,n,r,i){var s=0,o=0,u=0,a=0,f=!1,l=0;$game.$mouse={drawMode:!1,resetInit:function(){s=0,o=0,u=0,a=0,f=!1,l=0,$game.$mouse.drawMode=!1},updateMouse:function(e,t){var n=e.x-e.offX,r=e.y-e.offY;s=u,o=a;var i=Math.floor(n/32),f=Math.floor(r/32);i>$game.VIEWPORT_WIDTH-1?u=$game.VIEWPORT_WIDTH-1:i<0?u=0:u=i,f>$game.VIEWPORT_HEIGHT-1?a=$game.VIEWPORT_HEIGHT-1:f<0?a=0:a=f,e.debug&&console.log($game.$map.currentTiles[u][a]);if(u!==s||a!==o){var l={pX:s,pY:o,cX:u,cY:a};$game.$renderer.renderMouse(l),$game.$mouse.drawMode&&$game.$player.drawSeed({x:u,y:a})}if(t)if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$game.$player.seedMode?$game.$boss.dropSeed({x:u,y:a}):$game.$player.beginMove(u,a);else if($game.$player.seedMode){if(!$game.$player.awaitingBomb){var c={mouse:!0,x:u,y:a,mode:$game.$player.seedMode},h=$game.$player.dropSeed(c);h||$(".seedButton").removeClass("currentButton")}}else{var p=$game.$map.currentTiles[u][a].x,d=$game.$map.currentTiles[u][a].y,v=$game.$others.playerCard(p,d);if(!v){var m=$game.$map.getTileState(u,a);m===-1&&!$game.$player.pathfinding?($game.$player.beginMove(u,a),$game.$npc.isChat&&$game.$npc.hideChat(),$game.$botanist.isChat&&$game.$botanist.hideChat()):m>=0&&(m!==$game.$botanist.index&&!$game.$player.pathfinding?($game.$npc.isChat&&$game.$npc.hideChat(),$game.$npc.selectNpc(m),$game.$player.beginMove(u-2,a+1)):($(".speechBubble button").addClass("hideButton"),$game.$botanist.show()))}}},getCurrentPosition:function(){return{x:u,y:a}}}});require.define("/npc.js",function(e,t,n,r,i){var s=!1,o={},u=null,a=null,f=null,l=null;$game.$npc={ready:!1,hideTimer:null,isResource:!1,isChat:!1,init:function(e){ss.rpc("game.npc.getNpcs",function(t){console.log(t),o={},$.each(t,function(e,t){$game.$npc.addNpc(t)}),s=!0,$game.$npc.ready=!0,e()})},resetInit:function(){s=!1,o={},u=null,a=null,f=null,l=null,$game.$npc.ready=!1,$game.$npc.hideTimer=null,$game.$npc.isResource=!1,$game.$npc.isChat=!1},addNpc:function(e){var t=$game.$npc.createNpc(e);t.getMaster(),o[e.index]=t},update:function(){$.each(o,function(e,t){t.update()})},clear:function(){$.each(o,function(e,t){t.clear()})},getRenderInfo:function(){var e=[];return(!$game.bossModeUnlocked&&$game.$player.currentLevel>3||$game.$player.currentLevel<3)&&$.each(o,function(t,n){var r=n.getRenderInfo();r&&e.push(r)}),e},getName:function(e){var t=String(e);return o[t].name},createNpc:function(e){var t={name:e.name,id:e.id,index:e.index,dialog:e.dialog,dependsOn:e.dependsOn,level:e.level,isHolding:e.isHolding,resource:e.resource,onScreen:null,numSteps:64,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,info:{x:e.index%$game.TOTAL_WIDTH,y:Math.floor(e.index/$game.TOTAL_WIDTH),spriteY:e.sprite*64},renderInfo:{prevX:e.index%$game.TOTAL_WIDTH*$game.TILE_SIZE,prevY:Math.floor(e.index/$game.TOTAL_WIDTH)*$game.TILE_SIZE,curX:e.index%$game.TOTAL_WIDTH*$game.TILE_SIZE,curY:Math.floor(e.index/$game.TOTAL_WIDTH)*$game.TILE_SIZE,srcX:0,srcY:0,kind:"npc"},update:function(){$game.inTransit?$game.inTransit&&t.getMaster():t.idle()},getMaster:function(){var e=$game.$map.masterToLocal(t.info.x,t.info.y);if(e){var n=e.x*$game.TILE_SIZE,r=e.y*$game.TILE_SIZE,i=e.x*$game.TILE_SIZE,s=e.y*$game.TILE_SIZE;t.renderInfo.prevX=n,t.renderInfo.prevY=r,t.renderInfo.curX=i,t.renderInfo.curY=s,t.onScreen=!0}else t.onScreen=!1},idle:function(){t.counter+=1,t.counter>=56?(t.counter=0,t.renderInfo.srcX=0,t.renderInfo.srcY=t.info.spriteY):t.counter==24?(t.renderInfo.srcX=32,t.renderInfo.srcY=t.info.spriteY):t.counter==28?(t.renderInfo.srcX=64,t.renderInfo.srcY=t.info.spriteY):t.counter==32&&(t.renderInfo.srcX=96,t.renderInfo.srcY=t.info.spriteY)},clear:function(){$game.$renderer.clearCharacter(t.renderInfo)},getRenderInfo:function(){return t.onScreen?t.renderInfo:!1}};return t},hideChat:function(){clearTimeout($game.$npc.hideTimer),$(".speechBubble").fadeOut(function(){$game.$npc.isChat=!1,$game.$resources.isShowing=!1,$(".speechBubble button").addClass("hideButton"),$(".speechBubble .yesButton").unbind("click"),$(".speechBubble .noButton").unbind("click")})},show:function(){if($game.$player.firstTime)$game.$npc.isChat=!0,$game.$npc.showSmalltalk(!0);else if(!$game.$resources.isShowing&&!$game.$npc.isChat){$game.$audio.playTriggerFx("npcBubble");if(l){var e=$game.$npc.npcLocked();e?(a="Before I help you out, you need to go see "+e+". Come back when you have their resource.",$(".speechBubble p").addClass("fitBubble"),$(".speechBubble .speakerName").text(f+": "),$(".speechBubble .message").text(a),$(".speechBubble").fadeIn(function(){$game.$npc.hideTimer=setTimeout($game.$npc.hideChat,5e3)})):($game.$resources.isShowing=!0,$game.$npc.showPrompt())}else $game.$npc.isChat=!0,$game.$npc.showSmalltalk()}},npcLocked:function(){if(u.dependsOn.length>0&&u.dependsOn[0]){for(var e=0;e<u.dependsOn.length;e++){var t=u.dependsOn[e],n=$game.$player.checkForResource(t);if(!n){var r=$game.$npc.getName(t);return r}}return!1}return!1},showPrompt:function(){$(".speechBubble p").removeClass("fitBubble"),clearTimeout($game.$npc.hideTimer),$(".speechBubble button").addClass("hideButton");var e=$game.$player.getPrompt(u.index);a=u.dialog.prompts[e],e===2&&(a+=" Want to view again?"),$(".speechBubble .speakerName").text(f+": "),$(".speechBubble .message").text(a),$(".speechBubble .yesButton, .speechBubble .noButton").removeClass("hideButton"),$(".speechBubble").fadeIn(function(){$(".speechBubble .yesButton").bind("click",function(){var t=e<2?!1:!0;$game.$resources.loadResource(f,u.index,t)}),$(".speechBubble .noButton").bind("click",function(){$game.$npc.hideChat()})})},showSmalltalk:function(e){if(e||$game.$player.botanistState===0)a="You should really see the botanist before exploring the world.";else if(u.isHolding){var t="";$game.$player.currentLevel===0?t="northwest":$game.$player.currentLevel===1?t="northeast":$game.$player.currentLevel===2?t="southwest":t="southeast",a="You should go explore the "+t+"."}else $game.$player.currentLevel===u.level?a=u.dialog.smalltalk[1]:$game.$player.currentLevel<u.level?a=u.dialog.smalltalk[2]:a=u.dialog.smalltalk[0];$(".speechBubble p").addClass("fitBubble"),$(".speechBubble .speakerName").text(f+": "),$(".speechBubble .message").text(a),$(".speechBubble").fadeIn(function(){$game.$npc.hideTimer=setTimeout($game.$npc.hideChat,8e3)})},selectNpc:function(e){_index=e;var t=String(_index);u=o[t],u||(_index+=$game.TOTAL_WIDTH,t=String(_index),u=o[t]),f=o[t].name,u.isHolding?$game.$player.currentLevel>=u.level?l=!0:l=!1:l=!1,$game.$player.npcOnDeck=!0},getNpcLevel:function(e){if(e){var t=String(e),n=o[t].level;return n}return u.level},getNpcData:function(){return o},getOnScreenNpcs:function(){var e=[];return $.each(o,function(t,n){n.onScreen&&e.push(n.index)}),e},getNpcCoords:function(e){var t=String(e),n=o[t];return{x:n.renderInfo.curX,y:n.renderInfo.curY}}}});require.define("/others.js",function(e,t,n,r,i){_onScreenPlayers={},$game.$others={ready:!1,init:function(e){ss.rpc("game.player.getOthers",function(t){_onScreenPlayers={};for(var n=0;n<t.length;n++)$game.$others.add(t[n]);$game.$others.ready=!0,e()})},resetInit:function(){_onScreenPlayers={},$game.$others.ready=!1},add:function(e){if(e._id!=$game.$player.id){var t=$game.$others.createOther(e);_onScreenPlayers[e._id]=t,t.updateRenderInfo(),$game.$map.addPlayer(e._id,e.game.position.x,e.game.position.y,"rgb(200,200,200)")}},update:function(){$.each(_onScreenPlayers,function(e,t){t.update()})},clear:function(){$.each(_onScreenPlayers,function(e,t){t.clear()})},slide:function(e,t){$.each(_onScreenPlayers,function(n,r){r.slide(e,t)})},resetRenderValues:function(){$.each(_onScreenPlayers,function(e,t){t.resetRenderValues()})},hideAllChats:function(){$.each(_onScreenPlayers,function(e,t){t.hideChat()})},message:function(e,t){$.each(_onScreenPlayers,function(n,r){r.id===t&&r.message(e)})},remove:function(e){_onScreenPlayers[e].clear(),$game.$map.removePlayer(e),delete _onScreenPlayers[e]},playerCard:function(e,t){var n=!1;return $.each(_onScreenPlayers,function(r,i){i.info.x===e&&i.info.y===t&&(i.showPlayerCard(),n=!0)}),n},updateTilesColored:function(e,t){$.each(_onScreenPlayers,function(n,r){r.id===e&&r.setTilesColored(t)})},levelChange:function(e,t){$.each(_onScreenPlayers,function(n,r){r.id===e&&r.changeLevel(t)})},createOther:function(e){var t={name:e.firstName,id:e._id,isMoving:!1,currentStep:0,currentMove:0,currentStepIncX:0,currentStepIncY:0,curFrame:0,numFrames:4,numSteps:8,direction:0,idleCounter:0,getMaster:!0,chatId:"player"+e.id,chatIdSelector:"#player"+e.id,hideTimer:null,isChatting:!1,offScreen:!0,tilesColored:e.game.tilesColored,rank:e.game.rank,level:e.game.currentLevel,info:{x:e.game.position.x,y:e.game.position.y,srcX:0,srcY:0,offX:0,offY:0,prevOffX:0,prevOffY:0},renderInfo:{colorNum:e.game.colorInfo.tilesheet,srcX:0,srcY:0,curX:e.x,curY:e.y,prevX:e.x,prevY:e.y,kind:"player"},update:function(){t.isMoving?(t.move(),t.getMaster=!0):$game.inTransit?$game.inTransit&&(t.getMaster=!0):t.idle(),t.getMaster&&t.updateRenderInfo()},updateRenderInfo:function(){var e=$game.$map.masterToLocal(t.info.x,t.info.y);if(e){var n=e.x*$game.TILE_SIZE+t.info.prevOffX*$game.STEP_PIXELS,r=e.y*$game.TILE_SIZE+t.info.prevOffY*$game.STEP_PIXELS,i=e.x*$game.TILE_SIZE+t.info.offX*$game.STEP_PIXELS,s=e.y*$game.TILE_SIZE+t.info.offY*$game.STEP_PIXELS;t.renderInfo.prevX=n,t.renderInfo.prevY=r,t.renderInfo.srcX=t.info.srcX,t.renderInfo.srcY=t.info.srcY,t.renderInfo.curX=i,t.renderInfo.curY=s,t.offScreen=!1}else t.offScreen=!0;$game.$renderer.playerToCanvas(t.level,t.renderInfo.colorNum)},idle:function(){t.idleCounter+=1,t.idleCounter>=64?(t.idleCounter=0,t.info.srcX=0,t.info.srcY=0,t.getMaster=!0):t.idleCounter==48?(t.info.srcX=32,t.info.srcY=0,t.getMaster=!0):t.getMaster=!1},clear:function(){$game.$renderer.clearCharacter(t.renderInfo)},slide:function(e,n){t.info.prevOffX=e*t.numSteps,t.info.prevOffY=n*t.numSteps},resetRenderValues:function(){t.info.prevOffX=0,t.info.prevOffY=0},getRenderInfo:function(){return t.offScreen?!1:t.renderInfo},getPlayerInfo:function(){},beginMove:function(e){t.seriesOfMoves=new Array(e.length),t.seriesOfMoves=e,t.currentMove=1,t.currentStep=0,t.isMoving=!0,t.hideChat()},endMove:function(){t.isMoving=!1,t.info.srcX=0,t.info.srcY=0,t.info.offX=0,t.info.offY=0,t.info.prevOffX=0,t.info.prevOffY=0,$game.$map.updatePlayer(t.id,t.info.x,t.info.y)},move:function(){t.currentStep>=t.numSteps&&(t.currentStep=0,t.info.x=t.seriesOfMoves[t.currentMove].masterX,t.info.y=t.seriesOfMoves[t.currentMove].masterY,t.currentMove+=1,$game.$map.updatePlayer(t.id,t.info.x,t.info.y)),t.currentMove>=t.seriesOfMoves.length?t.endMove():(t.currentStep+=1,t.currentStep===1?(t.currentStepIncX=t.seriesOfMoves[t.currentMove].masterX-t.info.x,t.currentStepIncY=t.seriesOfMoves[t.currentMove].masterY-t.info.y,t.info.prevOffX=0,t.info.prevOffY=0,t.currentStepIncX===1?t.direction=2:t.currentStepIncX===-1?t.direction=1:t.currentStepIncY===-1?t.direction=4:t.direction=3):(t.info.prevOffX=t.info.offX,t.info.prevOffY=t.info.offY),t.info.offX=t.currentStep*t.currentStepIncX,t.info.offY=t.currentStep*t.currentStepIncY,(t.currentStep-1)%8===0&&(t.curFrame+=1,t.curFrame>=t.numFrames&&(t.curFrame=0)),t.info.srcX=t.curFrame*$game.TILE_SIZE,t.info.srcY=t.direction*$game.TILE_SIZE*2)},message:function(e){if(!t.offScreen){var n={x:t.renderInfo.curX,y:t.renderInfo.curY},r={name:t.name,isChatting:t.isChatting,chatId:t.chatId,chatIdSelector:t.chatIdSelector,position:n};clearTimeout(t.hideTimer),t.isChatting=!0;var i=$game.$chat.message(e,r);t.hideTimer=setTimeout(t.hideChat,i)}},hideChat:function(){clearTimeout(t.hideTimer),$(t.chatIdSelector).fadeOut("fast",function(){$(this).remove(),t.isChatting=!1})},setTilesColored:function(e){t.tilesColored=e},showPlayerCard:function(){var e="A "+$game.playerRanks[t.level]+" who has colored "+t.tilesColored+" tiles. Jealous?";t.message(e)},changeLevel:function(e){t.level=e,$game.$renderer.playerToCanvas(t.level,t.renderInfo.colorNum)},beam:function(e){t.info.x=e.x,t.info.y=e.y,t.updateRenderInfo(),$game.$map.updatePlayer(t.id,t.info.x,t.info.y)}};return t},getRenderInfo:function(){var e=[];return $.each(_onScreenPlayers,function(t,n){var r=n.getRenderInfo();r&&e.push(r)}),e},sendMoveInfo:function(e,t){_onScreenPlayers[t]&&_onScreenPlayers[t].beginMove(e)},beam:function(e){$.each(_onScreenPlayers,function(t,n){n.id===e.id&&n.beam(e)})},disable:function(){$.each(_onScreenPlayers,function(e,t){t.offScreen=!0})}}});require.define("/pathfinder.js",function(e,t,n,r,i){function o(e){var t=[];for(var n=0;n<e.length;n++){t[n]=[];for(var r=0,i=e[n];r<i.length;r++)t[n][r]=new u(n,r,i[r])}this.input=e,this.nodes=t}function u(e,t,n){this.data={},this.x=e,this.y=t,this.pos={x:e,y:t},this.type=n}function a(e){this.content=[],this.scoreFunction=e}var s={OPEN:1,WALL:0};window.Graph=o,o.prototype.toString=function(){var e="\n",t=this.nodes,n,r,i,s;for(var o=0,u=t.length;o<u;o++){n="",r=t[o];for(i=0,s=r.length;i<s;i++)n+=r[i].type+" ";e=e+n+"\n"}return e},u.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},u.prototype.isWall=function(){return this.type==s.WALL},a.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){var t=this.content[e];while(e>0){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},bubbleUp:function(e){var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);for(;;){var i=e+1<<1,s=i-1,o=null;if(s<t){var u=this.content[s],a=this.scoreFunction(u);a<r&&(o=s)}if(i<t){var f=this.content[i],l=this.scoreFunction(f);l<(o===null?r:a)&&(o=i)}if(o===null)break;this.content[e]=this.content[o],this.content[o]=n,e=o}}},$game.$astar={init:function(e){for(var t=0,n=e.length;t<n;t++)for(var r=0,i=e[t].length;r<i;r++){var s=e[t][r];s.f=0,s.g=0,s.h=0,s.cost=s.type,s.visited=!1,s.closed=!1,s.parent=null,s.masterX=$game.$map.currentTiles[r][t].x,s.masterY=$game.$map.currentTiles[r][t].y}},heap:function(){return new a(function(e){return e.f})},search:function(e,t,n,r,i,s){$game.$astar.init(e),s=s||$game.$astar.manhattan,i=!!i;var o=$game.$astar.heap();o.push(t);while(o.size()>0){var u=o.pop();if(u===n){var a=u,f=[];while(a.parent)f.push(a),a=a.parent;f.push(t);var l=f.reverse();return r(l),!0}u.closed=!0;var c=$game.$astar.neighbors(e,u,i);for(var h=0,p=c.length;h<p;h++){var d=c[h];if(d.closed||d.isWall())continue;var v=u.g+d.cost,m=d.visited;if(!m||v<d.g)d.visited=!0,d.parent=u,d.h=d.h||s(d.pos,n.pos),d.g=v,d.f=d.g+d.h,m?o.rescoreElement(d):o.push(d)}}return r([]),!1},manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},neighbors:function(e,t,n){var r=[],i=t.x,s=t.y;return e[i-1]&&e[i-1][s]&&r.push(e[i-1][s]),e[i+1]&&e[i+1][s]&&r.push(e[i+1][s]),e[i]&&e[i][s-1]&&r.push(e[i][s-1]),e[i]&&e[i][s+1]&&r.push(e[i][s+1]),n&&(e[i-1]&&e[i-1][s-1]&&r.push(e[i-1][s-1]),e[i+1]&&e[i+1][s-1]&&r.push(e[i+1][s-1]),e[i-1]&&e[i-1][s+1]&&r.push(e[i-1][s+1]),e[i+1]&&e[i+1][s+1]&&r.push(e[i+1][s+1])),r}}});require.define("/player.js",function(e,t,n,r,i){function W(e){var t={id:$game.$player.id,resource:e,inventory:B,resourcesDiscovered:U,index:e.index};ss.rpc("game.player.saveResource",t)}function X(){g=$(".seedButton .hudCount"),y=$(".regularButton .hudCount"),b=$(".drawButton .hudCount"),S=$(".waitingForSeed"),x=$(".gameboard"),T=$(".inventoryButton > .hudCount"),N=$(".inventory > .pieces"),C=$(".graffiti"),k=$(".graffiti p span")}function V(e){A=e.game.seeds,E=A.dropped,M=st(e.game.resources),_=e.game.position,_colorInfo=e.game.colorInfo.rgb,D="rgb("+e.game.colorInfo.rgb.r+","+e.game.colorInfo.rgb.g+","+e.game.colorInfo.rgb.b+")",P="rgba("+(e.game.colorInfo.rgb.r+10)+","+(e.game.colorInfo.rgb.g+10)+","+(e.game.colorInfo.rgb.b+10)+",",H=e.game.colorInfo.tilesheet,B=e.game.inventory,j=e.game.colorMap,F=e.game.resume,I=e.game.playingTime,q=e.game.tilesColored,R=e.game.pledges,U=e.game.resourcesDiscovered,M||(M={}),$game.$player.id=e.id,$game.$player.firstName=e.firstName,$game.$player.currentLevel=e.game.currentLevel,$game.$player.botanistState=e.game.botanistState,$game.$player.firstTime=e.game.firstTime,$game.$player.instanceName=e.game.instanceName,$game.$player.seenRobot=e.game.seenRobot}function J(e){var t=Math.floor(e.sz/2),n=e.mX-t,r=e.mY-t,i=e.x-t,s=e.y-t,o=[],u=e.mode,a=null,f=null,l=null,c=0;while(c<e.sz){var h=0;while(h<e.sz){if(n+h>-1&&n+h<$game.TOTAL_WIDTH&&r+c>-1&&r+c<$game.TOTAL_HEIGHT){var p=Math.round((.5-(Math.abs(h-t)+Math.abs(c-t))/e.sz*.3)*100)/100;f=P+p+")",l=(r+c)*$game.TOTAL_WIDTH+(n+h),a={x:n+h,y:r+c,mapIndex:l,color:{r:_colorInfo.r+10,g:_colorInfo.g+10,b:_colorInfo.b+10,a:p},curColor:f,instanceName:$game.$player.instanceName},o.push(a)}h+=1}c+=1}if(o.length>0){var d={bombed:o,options:e,x1:n,y1:r,x2:n+e.sz,y2:r+e.sz,kind:"regular"};K(d)}}function K(e){$game.$player.awaitingBomb=!0;var t={id:$game.$player.id,name:$game.$player.firstName,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,tilesColored:q,instanceName:$game.$player.instanceName,kind:e.kind},n=$game.$map.masterToLocal(e.options.mX,e.options.mY);S.css({top:n.y*32,left:n.x*32}).show(),ss.rpc("game.player.dropSeed",e.bombed,t,function(t,n){A.dropped+=1,$game.$player.awaitingBomb=!1,S.fadeOut(),t>0?(n&&$game.statusUpdate({message:"collaborative blending bonus!",input:"status",screen:!0,log:!1}),$game.$audio.playTriggerFx("seedDrop"),q+=t,e.options.mode==="regular"?($game.$player.updateSeeds("regular",-1),A.regular===0&&($game.$player.seedMode=!1,v.colorNum=H,$game.$player.seedPlanting=!1,$game.statusUpdate({message:"you are out of seeds!",input:"status",screen:!0,log:!1}),$(".seedButton").removeClass("currentButton"),$game.$player.saveMapImage(),it())):A.draw===0&&($game.$mouse.drawMode=!1,$game.$player.seedMode=!1,v.colorNum=H,$game.$player.seedPlanting=!1,C.hide(),$game.statusUpdate({message:"you are out of seeds!",input:"status",screen:!0,log:!1}),$(".seedButton").removeClass("currentButton"),$game.$player.saveMapImage(),it())):$game.statusUpdate({message:"sorry, someone beat you to that tile",input:"status",screen:!0,log:!1})})}function Q(){O=A.regular+A.draw,g.text(O),y.text(A.regular),b.text(A.draw)}function G(){var e=$game.$map.masterToLocal(d.x,d.y);if(e){var t=e.x*$game.TILE_SIZE+d.prevOffX*$game.STEP_PIXELS;prevY=e.y*$game.TILE_SIZE+d.prevOffY*$game.STEP_PIXELS,curX=e.x*$game.TILE_SIZE+d.offX*$game.STEP_PIXELS,curY=e.y*$game.TILE_SIZE+d.offY*$game.STEP_PIXELS,v.prevX=t,v.prevY=prevY,v.srcX=d.srcX,v.srcY=d.srcY,v.curX=curX,v.curY=curY}}function Y(){$game.$player.isMoving=!0,$game.$player.currentStep>=u&&($game.$player.currentStep=0,d.x=$game.$player.seriesOfMoves[$game.$player.currentMove].masterX,d.y=$game.$player.seriesOfMoves[$game.$player.currentMove].masterY,$game.$player.currentMove+=1,$game.$map.updatePlayer($game.$player.id,d.x,d.y)),$game.$player.currentMove>=$game.$player.seriesOfMoves.length?$game.bossModeUnlocked&&$game.$player.currentLevel>3?(d.offX=0,d.offY=0,d.srcX=0,d.srcY=0,d.prevOffX=0,d.prevOffY=0,$game.$player.isMoving=!1,$game.$boss.endMove(d.x,d.y)):et():($game.$player.currentStep+=1,$game.$player.currentStep===1?(a=$game.$player.seriesOfMoves[$game.$player.currentMove].masterX-d.x,f=$game.$player.seriesOfMoves[$game.$player.currentMove].masterY-d.y,d.prevOffX=0,d.prevOffY=0,a===1?l=2:a===-1?l=1:f===-1?l=4:l=3):(d.prevOffX=d.offX,d.prevOffY=d.offY),d.offX=$game.$player.currentStep*a,d.offY=$game.$player.currentStep*f,($game.$player.currentStep-1)%8===0&&(s+=1,s>=o&&(s=0)),d.srcX=s*$game.TILE_SIZE,d.srcY=l*$game.TILE_SIZE*2)}function Z(e){$game.$player.seriesOfMoves=new Array(e.length),$game.$player.seriesOfMoves=e,$game.$player.currentMove=1,$game.$player.currentStep=0,$game.$player.isMoving=!0,$game.$chat.hideChat()}function et(){var e={id:$game.$player.id,position:{x:d.x,y:d.y}};ss.rpc("game.player.savePosition",e),$game.$map.updatePlayer($game.$player.id,d.x,d.y),d.offX=0,d.offY=0,d.srcX=0,d.srcY=0,d.prevOffX=0,d.prevOffY=0,$game.$player.isMoving=!1;if(c){var t=function(){$game.$map.dataLoaded?$game.beginTransition():setTimeout(t,50)};t()}else $game.$player.npcOnDeck&&($game.$player.npcOnDeck=!1,$game.$npc.show())}function tt(){h+=1,$game.$player.seedMode&&(h%32<16?v.colorNum=0:v.colorNum=H),h>=64?(h=0,d.srcX=0,d.srcY=0,p=!0,v.squat=!1):h===48?(d.srcX=32,d.srcY=0,p=!0,v.squat=!0):p=!1}function nt(e){var t="r"+e.name,n="level"+($game.$player.currentLevel+1),r=CivicSeed.CLOUD_PATH+"/img/game/resources/"+n+"/small/"+e.name+".png";N.prepend('<img class="inventoryItem '+t+'"src="'+r+'" data-placement="top" data-original-title="'+e.tagline+'">'),$("."+t).bind("mouseenter",function(){$(this).tooltip("show")}),T.text(B.length),$("img.inventoryItem."+t).bind("click",function(){$game.$resources.beginResource(e.npc,!1)}).bind("dragstart",{npc:e.npc+","+e.name},$game.$botanist.dragStart)}function rt(){$game.$player.firstName==="Demo"?$game.$boss.init(function(){}):ss.rpc("game.player.gameOver",$game.$player.id,function(e){if(e)if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$game.$boss.init(function(){});else{var t='<div class="hooray"><h2>You beat the game, hooray!</h2><p>But the color has not yet returned to the world... If you have more seeds go and color the world. I will contact you when it has returned.</div>';$(".gameboard").append(t)}})}function it(){var e={id:$game.$player.id,seeds:A,tilesColored:q};ss.rpc("game.player.updateGameInfo",e)}function st(e){var t={};for(var n=0;n<e.length;n++)t[e[n].index]=e[n],t[e[n].index].arrayLookup=n;return t}var s=0,o=4,u=8,a=0,f=0,l=0,c=null,h=0,p=!0,d=null,v=null,m=[4,5,6,5],g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R=null,U=null,z=null;$game.$player={name:null,id:null,game:null,instanceName:null,currentLevel:null,botanistState:null,firstTime:null,seenRobot:null,seriesOfMoves:null,currentMove:0,currentStep:0,isMoving:!1,inventoryShowing:!1,seedventoryShowing:!1,seedPlanting:!1,npcOnDeck:!1,ready:!1,seedMode:!1,awaitingBomb:!1,pathfinding:!1,init:function(e){ss.rpc("game.player.init",function(t){L=(new Date).getTime()/1e3,d={srcX:0,srcY:0,x:t.game.position.x,y:t.game.position.y,offX:0,offY:0,prevOffX:0,prevOffY:0},$game.$player.game=t.game,V(t);var n={_id:t.id,firstName:t.firstName,game:{tilesColored:t.game.tilesColored,rank:t.game.rank,currentLevel:t.game.currentLevel,position:t.game.position,colorInfo:t.game.colorInfo}};ss.rpc("game.player.tellOthers",n),v={colorNum:H,srcX:0,srcY:0,curX:d.x*$game.TILE_SIZE,curY:d.y*$game.TILE_SIZE,prevX:d.x*$game.TILE_SIZE,prevY:d.y*$game.TILE_SIZE,kind:"player",level:$game.$player.currentLevel},X();var r="rgba("+t.game.colorInfo.rgb.r+","+t.game.colorInfo.rgb.g+","+t.game.colorInfo.rgb.b+", .6)";$(".hudCount").css("background",r),Q(),G(),$game.$player.ready=!0,e()})},resetInit:function(){s=0,a=0,f=0,l=0,c=null,h=0,p=!0,d=null,v=null,g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R=null,U=null,_test=!1,z=null,$game.$player.name=null,$game.$player.id=null,$game.$player.game=null,$game.$player.instanceName=null,$game.$player.currentLevel=null,$game.$player.botanistState=null,$game.$player.firstTime=null,$game.$player.seenRobot=null,$game.$player.seriesOfMoves=null,$game.$player.currentMove=0,$game.$player.currentStep=0,$game.$player.isMoving=!1,$game.$player.inventoryShowing=!1,$game.$player.seedventoryShowing=!1,$game.$player.seedPlanting=!1,$game.$player.npcOnDeck=!1,$game.$player.ready=!1,$game.$player.seedMode=!1,$game.$player.awaitingBomb=!1,$game.$player.pathfinding=!1},update:function(){$game.$player.isMoving?(Y(),p=!0):$game.inTransit?$game.inTransit&&(p=!0):tt(),p&&G()},clear:function(){$game.$renderer.clearCharacter(v)},beginMove:function(e,t){_test=!0;var n=$game.$map.masterToLocal(d.x,d.y);if(n.x===e&&n.y===t)return;$game.$player.pathfinding=!0,d.offX=0,d.offY=0,$game.bossModeUnlocked&&$game.$player.currentLevel>3?$game.$map.findPath({x:d.x,y:d.y},{x:e,y:t},function(e){$game.$player.pathfinding=!1,e.length>0&&Z(e)}):$game.$map.isMapEdge(e,t,function(n){c=!1,!n&&(e===0||e===$game.VIEWPORT_WIDTH-1||t===0||t===$game.VIEWPORT_HEIGHT-1)&&(c=!0,$game.$map.calculateNext(e,t));var r=$game.$map.masterToLocal(d.x,d.y),i={x:e,y:t};$game.$map.findPath(r,i,function(e){$game.$player.pathfinding=!1,e.length>0?(Z(e),ss.rpc("game.player.movePlayer",e,$game.$player.id,function(){var e=$game.$map.currentTiles[i.x][i.y].x,t=$game.$map.currentTiles[i.x][i.y].y;$game.$audio.update(e,t)})):$game.$player.npcOnDeck=!1})})},slide:function(e,t){d.prevOffX=e*u,d.prevOffY=t*u},resetRenderValues:function(){d.prevOffX=0,d.prevOffY=0},dropSeed:function(e){e.x&&(e.mX=$game.$map.currentTiles[e.x][e.y].x,e.mY=$game.$map.currentTiles[e.x][e.y].y);var t=e.mode;if(t==="regular")return A.regular<1?!1:(e.sz=3,J(e),!0);var n=$.map(z,function(e,t){return[e]});if(n.length>0){var r=_drawSeedArea.maxX-_drawSeedArea.minX,i=_drawSeedArea.maxY-_drawSeedArea.minY,s=r>i?r:i,o=$game.$map.currentTiles[_drawSeedArea.minX][_drawSeedArea.minY],u=$game.$map.currentTiles[_drawSeedArea.maxX][_drawSeedArea.maxY],a=$game.$map.currentTiles[15][7].x,f=$game.$map.currentTiles[15][7].y,l={bombed:n,options:{mX:a,mY:f},x1:o.x,y1:o.y,x2:u.x,y2:u.y,kind:"draw"};return K(l),!0}},getPrompt:function(e){return M[e]?M[e].result?2:1:0},answerResource:function(e){var t={answers:[e.answer],attempts:1,result:e.correct,seeded:[],questionType:e.questionType,index:e.index},n=null;M[e.index]&&(n=M[e.index]),n?(n.answers.push(t.answers[0]),n.attempts+=1,n.result=t.result):(M[e.index]=t,n=M[e.index]);if(e.correct){U+=1;var r=6-n.attempts,i=r<0?0:r;return $game.$player.updateSeeds("regular",i),i}},saveMapImage:function(){if(A.dropped-E>4){j=$game.$map.saveImage();var e={id:$game.$player.id,colorMap:j};ss.rpc("game.player.updateGameInfo",e),E=A.dropped}},checkBotanistState:function(){if($game.$player.botanistState>1){var e=$game.$botanist.tangram[$game.$player.currentLevel].answer,t=e.length;while(--t>-1){var n=e[t].id,r=!1;$.each(M,function(e,t){if(t){var i=$game.$resources.getShapeName(e);i===n&&(r=!0)}});if(!r)return!1}$game.$player.botanistState=3,$game.$botanist.setBotanistState(3);var i={id:$game.$player.id,botanistState:$game.$player.botanistState};ss.rpc("game.player.updateGameInfo",i);if(B.length===$game.resourceCount[$game.$player.currentLevel]){var s="You collected all the pieces, to the botanist!";$game.statusUpdate({message:s,input:"status",screen:!0,log:!1}),$game.inTransit=!0,setTimeout(function(){$game.$player.beamMeUpScotty()},3e3)}}},getAnswer:function(e){if(M[e])return M[e]},fillInventory:function(){if($game.$player.currentLevel<4){var e=B.length,t=0;T.text(e);while(t<e)nt(B[t]),t++;$game.$player.botanistState>1&&$game.$player.tangramToInventory()}},clearInventory:function(){$(".inventoryItem").remove()},tangramToInventory:function(){var e="puzzle"+$game.$player.currentLevel,t=CivicSeed.CLOUD_PATH+"/img/game/tangram/"+e+"small.png";N.append('<div class="inventoryItem inventoryPuzzle '+e+'"><img src="'+t+'" draggable = "false"></div>'),$("."+e).bind("click",$game.$botanist.inventoryShowRiddle)},emptyInventory:function(){B=[],$(".inventoryItem").remove(),T.text("0")},createInventoryOutlines:function(){if($game.$player.currentLevel<4){var e=$(".inventory > .outlines");e.empty();for(var t=0;t<$game.resourceCount[$game.$player.currentLevel];t+=1)e.append('<div class="inventoryOutline"></div>')}},nextLevel:function(){$game.$player.currentLevel+=1,$game.$player.botanistState=0,$game.$player.seenRobot=!1,R=5,$game.$renderer.loadTilesheet($game.$player.currentLevel,!0);var e={id:$game.$player.id,botanistState:$game.$player.botanistState,seenRobot:$game.$player.seenRobot,pledges:R,inventory:[],currentLevel:$game.$player.currentLevel};ss.rpc("game.player.updateGameInfo",e);var t="Congrats! You have completed level "+$game.$player.currentLevel+"!";if($game.$player.currentLevel<4){$game.statusUpdate({message:t,input:"status",screen:!1,log:!0}),$game.$robot.setPosition(),v.level=$game.$player.currentLevel,$game.$player.createInventoryOutlines();var n=$game.$player.currentLevel+1;ss.rpc("game.player.levelChange",$game.$player.id,$game.$player.currentLevel),$game.$renderer.playerToCanvas($game.$player.currentLevel,v.colorNum,!0)}else $game.statusUpdate({message:t,input:"status",screen:!1,log:!0}),$game.bossModeUnlocked&&$game.toBossLevel()},getPlayingTime:function(){var e=(new Date).getTime()/1e3,t=Math.round(e-L+I);return t},openSeedventory:function(){A.draw>0?$(".seedventory").slideDown(function(){var e=A.regular>0?"#eee":"#333",t=A.draw>0?"#eee":"#333";$(".regularButton").css("color",e),$(".drawButton").css("color",t),$game.$player.seedventoryShowing=!0,$game.statusUpdate({message:"choose a seed to plant",input:"status",screen:!0,log:!1}),$(".seedButton").addClass("currentButton")}):($(".seedButton").addClass("currentButton"),A.regular>0?($game.$player.seedPlanting=!0,$game.$player.seedMode="regular",$game.statusUpdate({message:"click any tile to drop some color",input:"status",screen:!0,log:!1})):($(".seedButton").removeClass("currentButton"),$game.statusUpdate({message:"you have no seeds",input:"status",screen:!0,log:!1})))},startSeeding:function(e){$game.$player.seedMode=e,$(".seedventory").slideUp(function(){$game.$player.seedventoryShowing=!1,$game.$player.seedPlanting=!0});var t;e==="regular"?t="click a tile to drop some color":(t="paintbrush mode activated - click and drag to draw",C.show(),k.text(A.draw)),$game.statusUpdate({message:t,input:"status",screen:!0,log:!1})},makePublic:function(e){if(M[e]){M[e].madePublic=!0;var t={playerId:$game.$player.id,npcId:e,instanceName:$game.$player.instanceName};ss.rpc("game.npc.makeResponsePublic",t,function(t){$(".publicButton").remove(),$(".yourAnswer").append('<i class="icon-unlock privateButton icon-large" data-npc="'+e+'"></i>'),setTimeout(function(){$game.$player.displayNpcComments()},250)})}},makePrivate:function(e){if(M[e]){M[e].madePublic=!1;var t={playerId:$game.$player.id,npcId:e,instanceName:$game.$player.instanceName};ss.rpc("game.npc.makeResponsePrivate",t,function(t){$(".yourAnswer").append('<button class="btn btn-info publicButton" data-npc="'+e+'">Make Public</button>'),$(".privateButton").remove(),setTimeout(function(){$game.$player.displayNpcComments()},250)})}},compileAnswers:function(){var e="";return $.each(M,function(t,n){if(n.questionType==="open"){var r=n.answers[n.answers.length-1],i=$game.$resources.getQuestion(t),s=n.seeded.length;e+='<p class="theQuestion">Q: '+i+'</p><div class="theAnswer"><p class="answerText">'+r+"</p>",s>0&&(e+='<p class="seededCount">'+s+" likes</p>"),e+="</div>"}}),e},checkForResource:function(e){return M[e]?!0:!1},updateSeeds:function(e,t){A[e]+=t;var n={id:$game.$player.id,seeds:A};ss.rpc("game.player.updateGameInfo",n),Q()},resumeAnswer:function(e){F.push(e);var t={id:$game.$player.id,resume:F};ss.rpc("game.player.updateGameInfo",t)},updatePledges:function(e){R+=e;var t={id:$game.$player.id,pledges:R};ss.rpc("game.player.updateGameInfo",t)},resetRenderColor:function(){v.colorNum=H},getPosition:function(){return d},getColor:function(){return D},getColorNum:function(){return v.colorNum},getRenderInfo:function(){return v},getColorMap:function(){return j},getTilesColored:function(){return q},getResourcesDiscovered:function(){return U},getSeedsDropped:function(){return A.dropped},getInventoryLength:function(){return B.length},getPledges:function(){return R},getRGBA:function(){return"rgba("+_colorInfo.r+","+_colorInfo.g+","+_colorInfo.b+","+.5+")"},getColorString:function(){return P},getRenderPosition:function(){return{x:v.curX,y:v.curY}},beamMeUpScotty:function(e){$(".beamMeUp").show(),d.x=70,d.y=74,v.curX=d.x*$game.TILE_SIZE,v.curY=d.y*$game.TILE_SIZE,v.prevX=d.x*$game.TILE_SIZE,v.prevY=d.y*$game.TILE_SIZE;var t=d.x===0?0:d.x-1,n=d.y===0?0:d.y-1,r=Math.floor(t/($game.VIEWPORT_WIDTH-2)),i=Math.floor(n/($game.VIEWPORT_HEIGHT-2)),s=r*($game.VIEWPORT_WIDTH-2),o=i*($game.VIEWPORT_HEIGHT-2);$game.masterX=s,$game.masterY=o,$game.$map.setBoundaries(),$game.$map.firstStart(function(){$game.$renderer.renderAllTiles(),setTimeout(function(){$game.inTransit=!1,$(".beamMeUp").fadeOut(),$game.$player.displayNpcComments()},1e3);var e={id:$game.$player.id,x:d.x,y:d.y};ss.rpc("game.player.beam",e),$game.$map.updatePlayer($game.$player.id,d.x,d.y)})},updateResource:function(e){resources[e.npc]&&resources[e.npc].seeded.push(e.pledger)},setTagline:function(e){var t=$game.$resources.getCurResource(),n=null,r=$game.$npc.getNpcLevel(),i=t.shape;M[t.index]&&(n=M[t.index],n.tagline=e),$game.$player.currentLevel===r&&(B.push({name:i,npc:t.index,tagline:e}),nt({name:i,npc:t.index,tagline:e}));var s={npc:t.index,id:$game.$player.id,name:$game.$player.firstName,answer:n.answers[n.answers.length-1],madePublic:!1,instanceName:$game.$player.instanceName,questionType:n.questionType};$game.$player.firstName!=="Demo"&&ss.rpc("game.npc.saveResponse",s),W(n),$game.$player.displayNpcComments()},displayNpcComments:function(){$(".npcBubble").remove();var e=$game.$npc.getOnScreenNpcs();for(var t=0;t<e.length;t++)if(M[e[t]]){var n=$game.$npc.getNpcCoords(e[t]),r="npcBubble"+e[t],i;M[e[t]].questionType==="open"?i=$game.$resources.getNumResponses(e[t]):i="*",bubble=$('<p class="npcBubble" data-npc="'+e[t]+'" id="'+r+'">'+i+"</p>"),x.append(bubble),$("#"+r).css({top:n.y-68,left:n.x}),M[e[t]].questionType==="open"&&$("#"+r).bind("click",function(){var e=$(this).attr("data-npc");$game.$resources.beginResource(e,!0)}),$("#"+r).bind("mouseenter",function(){var e=$(this).text(),t;isNaN(e)?t="You answered this question correctly":(t="There are no public answers, click to make yours public",e>0&&(t="Click to view "+e+" public answers")),$game.statusUpdate({message:t,input:"status",screen:!0,log:!1})})}},saveTimeToDB:function(){var e=(new Date).getTime()/1e3,t=e-L;I+=t;var n={id:$game.$player.id,playingTime:I};ss.rpc("game.player.updateGameInfo",n)},saveSeeds:function(){it()},drawSeed:function(e){if(A.draw>0){$game.$player.updateSeeds("draw",-1),k.text(A.draw);var t=!1;if($game.$player.seedMode==="draw"){var n=$game.$map.currentTiles[e.x][e.y],r=n.mapIndex,i=String(r),s=P+"0.3)";z[r]?z[r].color.a<.5&&(t=!0,z[r].color.a+=.1,z[r].curColor=s=P+z[r].color.a+")"):(t=!0,z[r]={x:n.x,y:n.y,mapIndex:r,color:{r:_colorInfo.r+10,g:_colorInfo.g+10,b:_colorInfo.b+10,a:.3},instanceName:$game.$player.instanceName,curColor:s},e.x<_drawSeedArea.minX&&(_drawSeedArea.minX=e.x),e.y<_drawSeedArea.minY&&(_drawSeedArea.minY=e.y),e.x>_drawSeedArea.maxX&&(_drawSeedArea.maxX=e.x),e.y>_drawSeedArea.maxY&&(_drawSeedArea.maxY=e.y));if(t){var o=!1;if(n.color){if(n.color.a<.5){o=!0;var u=.2,a=.8,f=Math.floor(u*n.color.r+a*z[r].color.r),l=Math.floor(u*n.color.g+a*z[r].color.g),c=Math.floor(u*n.color.b+a*z[r].color.b),h=Math.round((n.color.a+.1)*100)/100,p="rgba("+f+","+l+","+c+","+h+")";$game.$map.currentTiles[e.x][e.y].color=z[r].color,$game.$map.currentTiles[e.x][e.y].color.a=h,$game.$map.currentTiles[e.x][e.y].curColor=p}}else $game.$map.currentTiles[e.x][e.y].color=z[r].color,$game.$map.currentTiles[e.x][e.y].curColor=s,o=!0;o&&($game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE),$game.$renderer.renderTile(e.x,e.y))}}}else $game.$player.dropSeed({mode:"draw"}),$game.$mouse.drawMode=!1,$game.$player.seedMode=!1,$game.$player.seedPlanting=!1,$game.statusUpdate({message:"you are out of seeds!",input:"status",screen:!0,log:!1}),it()},drawFirstSeed:function(){var e=$game.$mouse.getCurrentPosition();z={},_drawSeedArea={minX:29,maxX:0,minY:14,maxY:0},$game.$player.drawSeed(e)},setPositionInfo:function(){$game.bossModeUnlocked&&$game.$player.currentLevel>3&&(d.x=15,d.y=8)},debug:function(){console.log(M)}}});require.define("/render.js",function(e,t,n,r,i){var s=[],o=null,u=[],a=[],f=0,l=0,c=null,h=null,p=null,d=null,v=[],m=[],g=null,y=null,b=null,w=null,E=null,S=0,x=0,T=!1,N=!1,C=0,k=0,L=$game.$renderer={ready:!1,init:function(e){p=document.createElement("canvas"),p.setAttribute("width",$game.VIEWPORT_WIDTH*$game.TILE_SIZE),p.setAttribute("height",$game.VIEWPORT_WIDTH*$game.TILE_SIZE),d=p.getContext("2d"),g=document.getElementById("background").getContext("2d"),y=document.getElementById("foreground").getContext("2d"),b=document.getElementById("characters").getContext("2d"),w=document.getElementById("minimapPlayer").getContext("2d"),E=document.getElementById("minimapTile").getContext("2d"),y.strokeStyle="rgba(0,255,0,.4)",y.lineWidth=4,y.save(),u=["tilesheet1.png","tilesheet2.png","tilesheet3.png","tilesheet4.png","tilesheet5.png","npcs.png","botanist.png","1.png","2.png","3.png","robot.png","bossItems.png"],C=$game.$player.getColorNum(),k=$game.$player.currentLevel,L.loadTilesheet(k,!1);var t=function(){L.ready?e():setTimeout(t,30)};t()},resetInit:function(){s=[],o=null,u=[],a=[],f=0,l=0,c=null,h=null,p=null,d=null,v=[],m=[],g=null,y=null,b=null,w=null,E=null,S=0,x=0,T=!1,N=!1,C=0,k=0,$game.$renderer.ready=!1},loadTilesheet:function(e,t){o=new Image,o.src=CivicSeed.CLOUD_PATH+"/img/game/"+u[e],o.onload=function(){t?h.clearRect(0,0,f,l):(c=document.createElement("canvas"),c.setAttribute("width",o.width),c.setAttribute("height",o.height),h=c.getContext("2d"),f=o.width/$game.TILE_SIZE,l=o.height/$game.TILE_SIZE,L.loadImages(0)),h.drawImage(o,0,0),t&&L.renderAllTiles()}},loadImages:function(e){s[e]=new Image,s[e].src=CivicSeed.CLOUD_PATH+"/img/game/"+u[e],s[e].onload=function(){var t=e+1;e===u.length-1?L.loadPlayerImages(0):L.loadImages(t)}},loadPlayerImages:function(e){var t=e+1,n=CivicSeed.CLOUD_PATH+"/img/game/players/"+e+".png";a[e]=new Image,a[e].src=n,a[e].onload=function(){v[e]=document.createElement("canvas"),v[e].setAttribute("width",a[e].width),v[e].setAttribute("height",a[e].height),m[e]=v[e].getContext("2d"),m[e].drawImage(a[e],0,0);if(t===21){L.ready=!0,L.playerToCanvas(k,C,!0);return}L.loadPlayerImages(t)}},renderFrame:function(){L.clearAll(),$game.inTransit&&L.renderAllTiles(),L.makeQueue(function(e){var t=e.length;while(--t>-1)e[t].kind==="npc"?L.renderNpc(e[t]):e[t].kind==="botanist"?L.renderBotanist(e[t]):e[t].kind==="robot"?L.renderRobot(e[t]):L.renderPlayer(e[t])})},makeQueue:function(e){var t=$game.$player.getRenderInfo(),n=[t],r=$game.$others.getRenderInfo(),i=$game.$npc.getRenderInfo(),s=$game.$botanist.getRenderInfo(),o=$game.$robot.getRenderInfo(),u=n.concat(r,i);s&&u.push(s),o&&u.push(o),u.sort(function(e,t){return t.curY-e.curY}),e(u)},renderTile:function(e,t){var n=$game.$map.currentTiles[e][t],r=n.background-1,i=n.background2-1,s=n.background3-1,o=n.foreground-1,u=n.foreground2-1,a=n.tileState,f=n.curColor,l={b1:r,b2:i,b3:s,destX:e,destY:t};f&&(l.color=f),L.drawMapTile(l);var c={f1:o,f2:u,destX:e,destY:t};(o>-1||u>-1)&&L.drawForegroundTile(c)},clearMapTile:function(e,t){g.clearRect(e,t,$game.TILE_SIZE,$game.TILE_SIZE)},drawMapTile:function(e){var t,n;e.color&&(g.fillStyle=e.color,g.fillRect(e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.b1>-1&&(t=e.b1%f,n=Math.floor(e.b1/f),g.drawImage(c,t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.b2>-1&&(t=e.b2%f,n=Math.floor(e.b2/f),g.drawImage(c,t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.b3>-1&&(t=e.b3%f,n=Math.floor(e.b3/f),g.drawImage(c,t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE))},drawForegroundTile:function(e){var t,n;e.f1>-1&&(t=e.f1%f,n=Math.floor(e.f1/f),y.drawImage(c,t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.f2>-1&&(t=e.f2%f,n=Math.floor(e.f2/f),y.drawImage(c,t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE))},drawAccessories:function(e,t,n,r,i,o){o&&m[0].drawImage(s[r],e,0,32,64,t,n,32,64),m[i].drawImage(s[r],e,0,32,64,t,n,32,64)},playerToCanvas:function(e,t,n){e=e<4?e:3;var r=64,i=32,s=e+7;m[t].clearRect(0,0,a[t].width,a[t].height),m[t].drawImage(a[t],0,0);if(e>0)for(var o=7;o<s;o+=1){var u=0;for(var f=0;f<5;f+=1){var l=i*f;if(f===0){L.drawAccessories(l,0,0,o,t,n);for(u=0;u<4;u+=1)L.drawAccessories(l,i*u,r*3,o,t,n)}else if(f===1)L.drawAccessories(l,i,0,o,t,n);else if(f===2)for(u=0;u<4;u+=1)L.drawAccessories(l,i*u,r*1,o,t,n);else if(f===3)for(u=0;u<4;u+=1)L.drawAccessories(l,i*u,r*2,o,t,n);else for(u=0;u<4;u+=1)L.drawAccessories(l,i*u,r*4,o,t,n)}}},renderPlayer:function(e){b.drawImage(v[e.colorNum],e.srcX,e.srcY,$game.TILE_SIZE,$game.TILE_SIZE*2,e.curX,e.curY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},renderCharacter:function(e){b.drawImage(v[e.colorNum],e.srcX,e.srcY,$game.TILE_SIZE,$game.TILE_SIZE*2,e.curX,e.curY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},clearAll:function(){b.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE)},clearCharacter:function(e){b.clearRect(e.prevX,e.prevY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},renderAllTiles:function(){y.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE),d.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE),g.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE);var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0)L.renderTile(e,t)}b.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE)},renderNpc:function(e){b.drawImage(s[5],e.srcX,e.srcY,$game.TILE_SIZE,$game.TILE_SIZE*2,e.curX,e.curY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},renderMouse:function(e){var t=e.cX*$game.TILE_SIZE,n=e.cY*$game.TILE_SIZE,r=$game.$map.getTileState(e.cX,e.cY);y.clearRect(S*$game.TILE_SIZE,x*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE);var i=$game.$map.currentTiles[S][x].foreground-1,s=$game.$map.currentTiles[S][x].foreground2-1,o={f1:i,f2:s,destX:S,destY:x};L.drawForegroundTile(o);var u=$game.$player.getRGBA();$game.$player.seedMode?(y.fillStyle=u,y.fillRect(t,n,$game.TILE_SIZE,$game.TILE_SIZE)):(r==-1?(u="rgba(50,255,50,.5)",y.strokeStyle=u):r===-2?(u="rgba(255,50,50,.5)",y.strokeStyle=u):(u="rgba(50,50,235,.5)",y.strokeStyle=u),y.strokeRect(t+2,n+2,$game.TILE_SIZE-4,$game.TILE_SIZE-4)),S=e.cX,x=e.cY},clearMiniMap:function(){w.clearRect(0,0,$game.TOTAL_WIDTH,$game.TOTAL_HEIGHT)},renderMiniPlayer:function(e){w.fillStyle=e.col,w.fillRect(e.x,e.y,4,4)},renderMiniMapConstants:function(){w.fillStyle="rgb(150,150,150)",w.fillRect(0,72,142,1),w.fillRect(71,0,1,132),w.fillStyle="rgb(255,255,255)",w.fillRect(67,68,8,8)},renderMiniTile:function(e,t,n){var r="rgba("+n.r+","+n.g+","+n.b+","+n.a+")";E.fillStyle=r,E.fillRect(e,t,1,1)},clearBotanist:function(e){b.clearRect(e.prevX,e.prevY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},clearRobot:function(e){b.clearRect(e.prevX,e.prevY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},renderBotanist:function(e){b.drawImage(s[6],e.srcX,e.srcY,$game.TILE_SIZE*6,$game.TILE_SIZE*5,e.curX,e.curY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},renderRobot:function(e){b.drawImage(s[10],e.srcX,e.srcY,64,64,e.curX,e.curY-$game.TILE_SIZE*1,64,64)},imageToCanvas:function(e){var t=new Image;t.onload=function(){E.drawImage(t,0,0)},t.src=e},renderBossTiles:function(e){for(var t=0;t<e.length;t++)L.clearMapTile(e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE),g.fillStyle=e[t].color,g.fillRect(e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE),e[t].item>-1&&g.drawImage(s[11],e[t].item*$game.TILE_SIZE,0,$game.TILE_SIZE,$game.TILE_SIZE,e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE),e[t].charger>-1&&g.drawImage(s[11],128,0,$game.TILE_SIZE,$game.TILE_SIZE,e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)},clearBossLevel:function(){g.clearRect(0,0,$game.TILE_SIZE*$game.VIEWPORT_WIDTH,$game.TILE_SIZE*$game.VIEWPORT_HEIGHT)},clearMap:function(){g.clearRect(0,0,$game.TILE_SIZE*$game.VIEWPORT_WIDTH,$game.TILE_SIZE*$game.VIEWPORT_HEIGHT),y.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT)}}});require.define("/resources.js",function(e,t,n,r,i){function H(){v=$(".resourceStage"),m=$(".speechBubble"),g=$(".inventory"),y=$(".resourceArea"),b=$(".speechBubble button"),w=$(".resourceArea button"),E=$(".resourceArea .speakerName"),S=$(".resourceArea .message"),x=$(".resourceContent"),T=$(".resourceContentBody"),N=$(".resourceArea .nextButton"),C=$(".resourceArea .closeButton"),k=$(".resourceArea  .backButton"),L=$(".resourceArea  .answerButton"),$saveButton=$(".resourceArea  .saveButton")}function B(){if(c)if(o===u+1){$game.$resources.waitingForTagline=!0;var e='<p class="centerText taglineInput"><input class="customTagline" name="tagline" type ="text" value="" maxLength = "60"></input></p><p class="privacyMessage taglineInput">Name this resource to remember it.</p>',t=$game.$npc.getNpcLevel(),n;t<$game.$player.currentLevel?(a=M+" Here, take "+A+" seeds!",n=e,x.empty().html(n).css("overflow","auto")):(a=M+" Here, take this puzzle piece, and "+A+" seeds!",$game.$audio.playTriggerFx("resourceRight"),n=P+e,x.empty().html(n).css("overflow","hidden")),E.text(l+": "),S.text(a)}else x.empty().css("overflow","auto"),$game.$resources.showRecentAnswers()}function j(){x.css("overflow","auto");if(o===u){var e='<p class="finalQuestion">Q: '+h.question+"</p>";if(p)$game.$resources.showRecentAnswers();else{var t=null;if(O==="multiple"){var n=h.possibleAnswers.length;t="<form>";for(var r=0;r<n;r++)t+='<input name="resourceMultipleChoice" type ="radio" value="'+h.possibleAnswers[r]+'"> '+h.possibleAnswers[r]+"</input><br>";t+="</form>"}else O==="open"?t='<form><textarea placeholder="type your answer here..."></textarea></form><p class="privacyMessage">Your answer will be private by default. You  can later choose to make it public to earn special seeds.</p>':O==="truefalse"?t='<form><input name="resourceMultipleChoice" type ="radio" value="true">true</input><br><input name="resourceMultipleChoice" type ="radio" value="false">false</input>':O==="yesno"&&(t='<form><input name="resourceMultipleChoice" type ="radio" value="yes">yes</input><br><input name="resourceMultipleChoice" type ="radio" value="no">no</input>');x.html(e+t)}}else{var i=$(".resourceStage .pages > section").get(o).innerHTML;x.empty(),T.html(i).show()}}var s=[],o=0,u=0,a=null,f=!1,l=null,c=!1,h=null,p=!1,d=!1,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=0,O=null,M=null,_=["Very interesting. I've never looked at it like that before.","That says a lot about you!","Thanks for sharing. Now get out there and spread some color!"],D=null,P=null;$game.$resources={isShowing:!1,ready:!1,waitingForTagline:!1,init:function(e){var t=$game.$npc.getNpcData();ss.rpc("game.npc.getResponses",$game.$player.instanceName,function(n){$.each(t,function(e,t){if(t.isHolding){var n=String(t.index);s[n]=t.resource,s[n].index=t.index,s[n].playerAnswers=[]}});var r=n[0].resourceResponses;$.each(r,function(e,t){if(t.madePublic){var n=String(t.npc);s[n].playerAnswers.push(t)}}),H(),$game.$resources.ready=!0,e()})},resetInit:function(){s=[],o=0,u=0,a=null,f=!1,l=null,c=!1,h=null,p=!1,d=!1,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=0,O=null,M=null,D=null,P=null,$game.$resources.isShowing=!1,$game.$resources.ready=!1,$game.$resources.waitingForTagline=!1},beginResource:function(e,t){var n=$game.$npc.getName(e);$game.$resources.loadResource(n,e,!0,t),t||(d=!0),$game.$resources.isShowing=!0},loadResource:function(e,t,n,r){l=e,f=r,c=r,o=0,v.empty();var i=String(t);h=s[i],O=h.questionType,M=h.feedbackRight;var a=$game.$npc.getNpcLevel(t);if(a<=$game.$player.currentLevel){var p="/articles/"+h.url+".html";v.empty().load(p,function(){u=$(".resourceStage .pages > section").length,$game.$resources.showResource(n)})}},showResource:function(e){p=e;if(f)c=!0,o=u+2;else if(p)c=!1;else{var t=$game.$npc.getNpcLevel(h.index),n="level"+(t+1),r=CivicSeed.CLOUD_PATH+"/img/game/resources/"+n+"/"+h.shape+".png";P='<p class="tangramPieceP"><img src="'+r+'" class="centerImage"></p>'}m.fadeOut(function(){b.addClass("hideButton"),$(".speechBubble .yesButton").unbind("click"),$(".speechBubble .noButton").unbind("click"),$(".resourceArea .dialog > span, .resourceArea .resourceContent").empty(),$game.$resources.addContent(),$game.$resources.addButtons(),g.fadeOut(function(){$game.$player.inventoryShowing=!1,y.addClass("patternBg1"),y.fadeIn(),$game.$audio.playTriggerFx("windowShow")})}),$game.$audio.fadeLow()},addButtons:function(){w.addClass("hideButton"),f?o===u+1?c?$saveButton.removeClass("hideButton"):C.removeClass("hideButton"):C.removeClass("hideButton"):p?o===u-1?O!=="open"?C.removeClass("hideButton"):(o>0&&k.removeClass("hideButton"),N.removeClass("hideButton")):o===u?(C.removeClass("hideButton"),k.removeClass("hideButton")):(N.removeClass("hideButton"),o>0&&k.removeClass("hideButton")):o===0?N.removeClass("hideButton"):o>0&&o<u?(N.removeClass("hideButton"),k.removeClass("hideButton")):o===u&&(L.removeClass("hideButton"),k.removeClass("hideButton"))},addContent:function(){E.empty(),S.empty(),T.empty().hide(),x.empty(),f?B():j()},showRecentAnswers:function(){var e='<div class="publicAnswers"><p class="finalQuestion">Q: '+h.question+"</p>";otherAnswers="",yourAnswer=$game.$player.getAnswer(h.index),rightOne=yourAnswer.answers.length-1;if(h.playerAnswers){var t=h.playerAnswers,n=t.length,r;while(--n>-1)t[n].madePublic&&t[n].id!=$game.$player.id?otherAnswers+='<li class="playerAnswers"><p><span>'+t[n].name+": </span>"+t[n].answer+'</p><button class="btn btn-success pledgeButton" data-npc="'+h.index+'" data-player="'+t[n].id+'">Seed It!</button></li>':t[n].madePublic&&t[n].id===$game.$player.id&&(r=!0);var i="<ul>";i+='<li class="playerAnswers yourAnswer"><p><span>You said: </span>'+yourAnswer.answers[rightOne]+"</p>",r?i+='<i class="icon-unlock privateButton icon-large" data-npc="'+h.index+'"></i>':i+='<button class="btn btn-info publicButton" data-npc="'+h.index+'">Make Public</button>',i+="</li>"+otherAnswers+"</ul></div>",a="Here are some recent answers by your peers: "}else a="Congrats! You were the first to answer.",displayAnswers+="<p>** More answers from your peers will appear shortly.  Be sure to check back. **</p>";E.text(l+": "),S.text(a),x.html(e+i)},hideResource:function(){y.fadeOut(function(){$game.$resources.isShowing=!1,w.addClass("hideButton"),y.removeClass("patternBg1")}),d?g.fadeIn(function(){d=!1,$game.$botanist.isSolving?$game.$player.inventoryShowing=!1:$game.$player.inventoryShowing=!0}):$game.$player.checkBotanistState(),$game.$audio.fadeHi()},previousSlide:function(){o-=2,$game.$resources.nextSlide()},nextSlide:function(){o+=1,f?c?($game.$resources.addContent(),$game.$resources.addButtons()):(a=h.feedbackWrong,$game.$audio.playTriggerFx("resourceWrong"),$game.$resources.hideResource(),$(".speechBubble .speakerName").text(l+": "),$(".speechBubble .message").text(a),$(".speechBubble").fadeIn(),$game.$npc.isChat=!0,$game.$npc.hideTimer=setTimeout($game.$npc.hideChat,4e3)):($game.$resources.addContent(),$game.$resources.addButtons())},submitAnswer:function(e){var t=null;c=!1;if(O==="open"){t=$(".resourceContent textarea").val();if(t.length<1&&!e)return $game.$resources.popupCheck(!0),!1;if(h.requiredLength&&t.length<h.requiredLength&&!e)return $game.$resources.popupCheck(),!1;c=!0;var n=Math.floor(Math.random()*3);M=_[n]}else t=$("input[name=resourceMultipleChoice]:checked").val(),t===h.answer&&(c=!0);var r=$game.$npc.getNpcLevel(h.index);if(c){var i={correct:!0,index:h.index,answer:t,npcLevel:r,questionType:h.questionType};A=$game.$player.answerResource(i),(O==="truefalse"||O==="yesno")&&A<5&&(A=2);var s={npc:h.index,id:$game.$player.id,name:$game.$player.firstName,answer:t,madePublic:!1,instanceName:$game.$player.instanceName,questionType:h.questionType}}else{var o={correct:!1,index:h.index,answer:t,npcLevel:r,questionType:h.questionType};A=$game.$player.answerResource(o)}f=!0,$game.$resources.nextSlide()},getShape:function(e){var t=String(e),n=s[t].shape;return F[$game.$player.currentLevel][n]},getShapeName:function(e){var t=String(e),n=s[t].shape;return n},getTagline:function(e){var t=String(e);return s[t].tagline},addAnswer:function(e){var t=String(e.npc);s[t].playerAnswers.push(e);var n=$game.$npc.getOnScreenNpcs();for(var r=0;r<n.length;r++)if(t==n[r]){$game.$player.displayNpcComments();break}},removeAnswer:function(e){var t=String(e.npc),n=!1,r=0;while(!n)s[t].playerAnswers[r].id===e.id&&(s[t].playerAnswers.splice(r,1),n=!0),r++,r>=s[t].playerAnswers.length&&(n=!0)},popupCheck:function(){$(".check button").removeClass("hideButton"),$(".check").show()},getQuestion:function(e){var t=String(e);return s[t].question},getCurResource:function(){return h},saveTagline:function(e){e.length>0?($game.$player.setTagline(e),$game.$resources.waitingForTagline=!1,h.questionType==="open"?$game.$resources.nextSlide():$game.$resources.hideResource()):$(".checkTagline").show().delay(2e3).fadeOut()},getNumResponses:function(e){var t=String(e);return s[t].playerAnswers.length}};var F=[{correct1:{path:"m0,0l0,70l80,0l0,-70l-80,0z",fill:"lightGreen"},wrong1:{path:"m0,0l50,-50l50,50l-50,50l-50,-50z",fill:"blue"},wrong2:{path:"m0,0l0,-90l60,0l0,-50l-140,0l0,140l80,0z",fill:"lightBlue"},correct2:{path:"m0,0l-50,50l50,50l0,-100z",fill:"orange"},wrong3:{path:"m0,0c0,0 60,0 60,0c0,0 0,-50 0,-50c0,0 -60,0 -60,0c0,0 0,50 0,50z",fill:"orange"},correct3:{path:"m0,0l-100,0l0,50l60,0l0,20l80,0l0,-20l60,0l0,-50l-100,0z",fill:"green"},wrong4:{path:"m0,0l0,100l-50,-50l50,-50z",fill:"lightOrange"},wrong5:{path:"m0,0l0,-50l200,0l0,50l-200,0z",fill:"green"},wrong6:{path:"m0,0l80,0l0,90l-80,0l0,-90z",fill:"lightGreen"},correct4:{path:"m0,0l0,100l50,-50l-50,-50z",fill:"lightOrange"}},{correct1:{path:"m0,0l0,-80l-170,0l-10,0l0,200l120,0l0,-120l60,0z",fill:"orange"},wrong1:{path:"m0,0c0,0 0,-200 0,-200c0,0 -120,0 -120,0c0,0 0,200 0,200c0,0 120,0 120,0z",fill:"lightOrange"},wrong2:{path:"m0,0l100,-40l100,0l100,40l-300,0z",fill:"green"},wrong3:{path:"m0,0l100,0l0,-40l-50,-40l-50,40l0,40z",fill:"lightGreen"},wrong4:{path:"m0,0l-60,0l0,120l-40,0l0,-160l140,0l0,160l-40,0l0,-120z",fill:"green"},wrong5:{path:"m0,0l150,0l0,-120l-50,40l0,30l0,10l-100,40z",fill:"blue"},wrong6:{path:"m0,0c0,0 0,110 0,110c0,0 0,10 0,10c0,0 150,0 150,0c0,0 -100,-40 -100,-40c0,0 0,-40 0,-40c0,0 -50,-40 -50,-40z",fill:"lightBlue"},correct2:{path:"m0,0l300,0l-100,-40l-100,0l-100,40z",fill:"lightOrange"},correct3:{path:"m0,0c0,0 0,-200 0,-200c0,0 150,0 150,0c0,0 0,40 0,40c0,0 -70,0 -70,0c0,0 0,160 0,160c0,0 -80,0 -80,0z",fill:"lightGreen"},wrong7:{path:"m0,0l0,-200l150,0l0,40l-70,0l0,160l-80,0z",fill:"orange"},correct4:{path:"m0,0l0,-200l-150,0l0,40l70,0l0,160l80,0z",fill:"blue"},wrong8:{path:"m0,0l0,-200l-150,0l0,40l70,0l0,160l80,0z",fill:"lightOrange"},correct5:{path:"m0,0l100,0c0,0 0,-40 0,-40c0,0 -50,-40 -50,-40c0,0 -50,40 -50,40c0,0 0,40 0,40z",fill:"orange"},wrong9:{path:"m0,0l0,-160l-140,0l0,160l40,0l0,-120l60,0l0,120l40,0z",fill:"blue"}},{correct1:{path:"m0,0c0,0 0,-30 0,-30c0,0 70,0 70,0c0,0 0,30 0,30c0,0 -20,0 -20,0c0,0 0,-10 0,-10c0,0 -30,0 -30,0c0,0 0,10 0,10c0,0 -20,0 -20,0z",fill:"orange"},correct2:{path:"m0,0l-20,20l-20,40l0,110l100,0l0,-70l-60,0l0,-100z",fill:"lightOrange"},correct3:{path:"m0,0l0,-60l300,0l10,20l0,40l-310,0z",fill:"green"},correct4:{path:"m0,0l0,70c0,0 100,0 100,0c0,0 0,-70 0,-70c0,0 -100,0 -100,0z",fill:"lightGreen"},correct5:{path:"m0,0l0,-70l150,0l0,70l-150,0z",fill:"lightBlue"},wrong1:{path:"m0,0l20,0l0,-10l30,0l0,10l20,0l0,-30l-70,0l0,30z",fill:"blue"},wrong2:{path:"m0,0l0,60l260,0l-20,-40l-20,-20l-220,0z",fill:"lightOrange"},correct6:{path:"m0,0l0,40l300,0l-10,-20l-20,-20l-270,0z",fill:"blue"},wrong3:{path:"m0,0l90,0l0,-60l-50,0l-20,20l-20,40z",fill:"green"}},{correct1:{path:"m0,0l-120,0l0,40l240,0c0,0 0,-40 0,-40c0,0 -120,0 -120,0z",fill:"orange"},wrong1:{path:"m0,0l0,-40l240,0l0,40l-240,0z",fill:"blue"},wrong2:{path:"m0,0l80,0l0,-90l-100,0l20,90z",fill:"lightOrange"},correct2:{path:"m0,0l-60,0l-40,-180l100,0l-60,60l40,0l20,50l0,70z",fill:"lightGreen"},wrong3:{path:"m0,0l-100,0l0,90l80,0l20,-90z",fill:"green"},wrong4:{path:"m0,0l-20,-90l160,0l-20,90l-120,0z",fill:"lightGreen"},correct3:{path:"m0,0l100,0l-40,180l-60,0l0,-70l20,-50l40,0l-60,-60z",fill:"blue"},correct4:{path:"m0,0l60,60l-40,0l-20,-20l-20,20l-40,0l60,-60z",fill:"lightOrange"},wrong5:{path:"m0,0l120,0l0,220l-60,0l-40,-180l-20,0l0,-40z",fill:"orange"},correct5:{path:"m0,0l20,20l-20,50l-20,-50l20,-20z",fill:"green"}}]});require.define("/robot.js",function(e,t,n,r,i){var s=[{x:0,y:14},{x:113,y:27},{x:113,y:79},{x:0,y:79},{x:0,y:0},{x:0,y:0}],o=[{x:7,y:20,d:-1,target:-3},{x:137,y:33,d:1,target:145},{x:137,y:124,d:1,target:145},{x:7,y:84,d:-1,target:-3},{x:0,y:0,d:0,target:0},{x:0,y:0,d:0,target:0}],u=null,a=null,f=!1,l=!1;$game.$robot={ready:!1,active:!1,currentStep:0,numSteps:16,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,isMoving:!1,init:function(e){$game.bossModeUnlocked?e():(u={x:0,y:0},a={kind:"robot",prevX:0,prevY:0,curX:0,curY:0,srcX:0,srcY:0},$game.$player.seenRobot||$game.$robot.setPosition(),e())},resetInit:function(){u=null,a=null,f=!1,l=!1,$game.$robot.ready=!1,$game.$robot.active=!1,$game.$robot.currentStep=0,$game.$robot.counter=Math.floor(Math.random()*64),$game.$robot.curFrame=0,$game.$robot.isMoving=!1},setPosition:function(){u=o[$game.$player.currentLevel],u.offX=0,u.offY=0,u.prevOffX=0,u.prevOffY=0,a.dir=o[$game.$player.currentLevel].d,$game.$robot.isMoving=!1,$game.$robot.active=!0,$game.$robot.counter=Math.floor(Math.random()*64),$game.$robot.curFrame=0,$game.$robot.currentStep=0,a.dir===-1?a.srcY=0:a.srcY=64},update:function(){if($game.$robot.active)if(f)l?$game.$robot.move():$game.$robot.idleCheckTrigger();else{var e=$game.$map.masterToLocal(u.x,u.y);e&&(f=!0)}},updateRenderInfo:function(){var e=$game.$map.masterToLocal(u.x,u.y,!0);if(e){var t=e.x*$game.TILE_SIZE+u.prevOffX*$game.STEP_PIXELS/2,n=e.y*$game.TILE_SIZE+u.prevOffY*$game.STEP_PIXELS/2,r=e.x*$game.TILE_SIZE+u.offX*$game.STEP_PIXELS/2,i=e.y*$game.TILE_SIZE+u.offY*$game.STEP_PIXELS/2;a.prevX=t,a.prevY=n,a.curX=r,a.curY=i,$game.$robot.isMoving?a.dir===-1?a.srcY=0:a.srcY=64:a.dir===-1?a.srcY=128:a.srcY=192}},idleCheckTrigger:function(){$game.$robot.currentStep++,$game.$robot.currentStep%8===0&&($game.$robot.currentStep>$game.$robot.numSteps&&($game.$robot.currentStep=0),$game.$robot.curFrame++,$game.$robot.curFrame===$game.$robot.numFrames&&($game.$robot.curFrame=0),a.srcX=$game.TILE_SIZE*$game.$robot.curFrame*2),$game.$robot.updateRenderInfo();var e=$game.$player.getPosition(),t=Math.abs(e.x-(u.x+1)),n=Math.abs(e.y-u.y);if(t+n<6){l=!0,$game.$player.seenRobot=!0,$game.$robot.isMoving=!0,$game.$robot.currentStep=0,$game.$robot.counter=0,$game.$robot.curFrame=0;var r={id:$game.$player.id,seenRobot:$game.$player.seenRobot};ss.rpc("game.player.updateGameInfo",r)}},move:function(){f&&($game.$robot.currentStep>=$game.$robot.numSteps&&($game.$robot.currentStep=0,u.x+=u.d),u.x===u.target?(f=!1,$game.$robot.active=!1):($game.$robot.currentStep+=1,$game.$robot.currentStep===1?($game.$robot.currentStepIncX=u.d,$game.$robot.currentStepIncY=0,u.prevOffX=0,u.prevOffY=0):(u.prevOffX=u.offX,u.prevOffY=u.offY,$game.$robot.currentStep%4===0&&(a.srcX=$game.TILE_SIZE*($game.$robot.currentStep/4)*2-64)),u.offX=$game.$robot.currentStep*$game.$robot.currentStepIncX,u.offY=$game.$robot.currentStep*$game.$robot.currentStepIncY,$game.$robot.updateRenderInfo()))},clear:function(){$game.$renderer.clearRobot(a)},getRenderInfo:function(){return f?a:!1},getLoc:function(){return s[$game.$player.currentLevel]},disable:function(){f=!1}}});require.define("/civicseed-engine.js",function(e,t,n,r,i){var s=t.exports={init:function(){CivicSeed.initialized||(window.$WINDOW=$(window),window.$HTML=$("html"),window.$BODY=$(document.body),window.$CONTAINER=$("#container"),window.$game=e("/game"),s.setupRouter(),e("/account").accountHandlers(),CivicSeed.initialized=!0)},setupRouter:function(){var t;Davis(function(){t=this,e("/routes-middleware.js").loadMiddleware(t),e("/routes-main").loadRoutes(t),e("/routes-account").loadRoutes(t),e("/routes-admin").loadRoutes(t),e("/routes-profile").loadRoutes(t),e("/routes-errors").loadRoutes(t),t.configure(function(e){e.generateRequestOnPageLoad=!0}),t.start()})}}});require.define("/entry.js",function(e,t,n,r,i){window.ss=e("socketstream"),ss.server.on("ready",function(){$(function(){e("/civicseed-engine").init()})}),ss.server.on("disconnect",function(){CivicSeed.ENVIRONMENT==="production"?CivicSeed.CONNECTED&&sessionStorage.getItem("userId")&&(CivicSeed.CONNECTED=!1,$game.running=!1,$game.$audio&&$game.$audio.stopAll(),sessionStorage.clear(),Davis.location.assign("/"),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("The server is experiencing connection problems, 				which means this session needs to be restarted. 				We are very sorry for the inconvenience. 				Please try reauthenticating the game in a few minutes. 				If you continue to experience problems, 				please contact the site administrator and report the problem.")):console.log("Lost connection to server...")}),ss.server.on("reconnect",function(){CivicSeed.ENVIRONMENT==="production"?(CivicSeed.CONNECTED=!0,sessionStorage.clear(),Davis.location.assign("/"),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("The Server has been restarted. 			We are very sorry for the inconvenience. 			Please try reauthenticating. 			If you continue to experience problems, 			please contact the site administrator and report the problem.")):console.log("Connection to server...")})});require('events-responder')(0, {}, require('socketstream').send(0)); require('socketstream-rpc')(1, {}, require('socketstream').send(1)); require('socketstream').assignTransport({}); require('/entry');